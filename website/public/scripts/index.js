/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(730),o=n(582),a=n(19),c=n(313),u=n(424),l=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")},e}(),h="@firebase/app",d="0.9.20",f=new a.Logger("@firebase/app"),p="[DEFAULT]",g=((r={})[h]="fire-core",r["@firebase/app-compat"]="fire-core-compat",r["@firebase/analytics"]="fire-analytics",r["@firebase/analytics-compat"]="fire-analytics-compat",r["@firebase/app-check"]="fire-app-check",r["@firebase/app-check-compat"]="fire-app-check-compat",r["@firebase/auth"]="fire-auth",r["@firebase/auth-compat"]="fire-auth-compat",r["@firebase/database"]="fire-rtdb",r["@firebase/database-compat"]="fire-rtdb-compat",r["@firebase/functions"]="fire-fn",r["@firebase/functions-compat"]="fire-fn-compat",r["@firebase/installations"]="fire-iid",r["@firebase/installations-compat"]="fire-iid-compat",r["@firebase/messaging"]="fire-fcm",r["@firebase/messaging-compat"]="fire-fcm-compat",r["@firebase/performance"]="fire-perf",r["@firebase/performance-compat"]="fire-perf-compat",r["@firebase/remote-config"]="fire-rc",r["@firebase/remote-config-compat"]="fire-rc-compat",r["@firebase/storage"]="fire-gcs",r["@firebase/storage-compat"]="fire-gcs-compat",r["@firebase/firestore"]="fire-fst",r["@firebase/firestore-compat"]="fire-fst-compat",r["fire-js"]="fire-js",r.firebase="fire-js-all",r),m=new Map,y=new Map;function v(e,t){try{e.container.addComponent(t)}catch(n){f.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function w(e){var t,n,r=e.name;if(y.has(r))return f.debug("There were multiple attempts to register component ".concat(r,".")),!1;y.set(r,e);try{for(var i=o.__values(m.values()),s=i.next();!s.done;s=i.next())v(s.value,e)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!0}function b(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var _=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call initializeApp() first",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists with different options or config",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["no-options"]="Need to provide options, when not being deployed to hosting via source.",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i["idb-open"]="Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",i["idb-get"]="Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",i["idb-set"]="Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",i["idb-delete"]="Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",i),x=new c.ErrorFactory("app","Firebase",_),E=function(){function e(e,t,n){var r=this;this._isDeleted=!1,this._options=o.__assign({},e),this._config=o.__assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.Component("app",(function(){return r}),"PUBLIC"))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed(),this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed(),this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.checkDestroyed(),this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){this._isDeleted=e},enumerable:!1,configurable:!0}),e.prototype.checkDestroyed=function(){if(this.isDeleted)throw x.create("app-deleted",{appName:this._name})},e}();function I(e,t){var n,r;void 0===t&&(t={});var i=e;"object"!=typeof t&&(t={name:t});var a=o.__assign({name:p,automaticDataCollectionEnabled:!1},t),u=a.name;if("string"!=typeof u||!u)throw x.create("bad-app-name",{appName:String(u)});if(i||(i=c.getDefaultAppConfig()),!i)throw x.create("no-options");var l=m.get(u);if(l){if(c.deepEqual(i,l.options)&&c.deepEqual(a,l.config))return l;throw x.create("duplicate-app",{appName:u})}var h=new s.ComponentContainer(u);try{for(var d=o.__values(y.values()),f=d.next();!f.done;f=d.next()){var g=f.value;h.addComponent(g)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var v=new E(i,a,h);return m.set(u,v),v}function T(e,t,n){var r,i=null!==(r=g[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var c=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&c.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&c.push("and"),a&&c.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void f.warn(c.join(" "))}w(new s.Component("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}var S="firebase-heartbeat-database",C=1,A="firebase-heartbeat-store",D=null;function k(){return D||(D=u.openDB(S,C,{upgrade:function(e,t){0===t&&e.createObjectStore(A)}}).catch((function(e){throw x.create("idb-open",{originalErrorMessage:e.message})}))),D}function N(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,k()];case 1:return[4,r.sent().transaction(A).objectStore(A).get(O(e))];case 2:return[2,r.sent()];case 3:return(t=r.sent())instanceof c.FirebaseError?f.warn(t.message):(n=x.create("idb-get",{originalErrorMessage:null==t?void 0:t.message}),f.warn(n.message)),[3,4];case 4:return[2]}}))}))}function L(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,k()];case 1:return n=o.sent(),[4,(r=n.transaction(A,"readwrite")).objectStore(A).put(t,O(e))];case 2:return o.sent(),[4,r.done];case 3:return o.sent(),[3,5];case 4:return(i=o.sent())instanceof c.FirebaseError?f.warn(i.message):(s=x.create("idb-set",{originalErrorMessage:null==i?void 0:i.message}),f.warn(s.message)),[3,5];case 5:return[2]}}))}))}function O(e){return"".concat(e.name,"!").concat(e.options.appId)}var M=function(){function e(e){var t=this;this.container=e,this._heartbeatsCache=null;var n=this.container.getProvider("app").getImmediate();this._storage=new R(n),this._heartbeatsCachePromise=this._storage.read().then((function(e){return t._heartbeatsCache=e,e}))}return e.prototype.triggerHeartbeat=function(){return o.__awaiter(this,void 0,void 0,(function(){var e,t,n,r;return o.__generator(this,(function(i){switch(i.label){case 0:return e=this.container.getProvider("platform-logger").getImmediate(),t=e.getPlatformInfoString(),n=P(),null!==this._heartbeatsCache?[3,2]:(r=this,[4,this._heartbeatsCachePromise]);case 1:r._heartbeatsCache=i.sent(),i.label=2;case 2:return this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some((function(e){return e.date===n}))?[2]:(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),[2,this._storage.overwrite(this._heartbeatsCache)])}}))}))},e.prototype.getHeartbeatsHeader=function(){return o.__awaiter(this,void 0,void 0,(function(){var e,t,n,r,i;return o.__generator(this,(function(s){switch(s.label){case 0:return null!==this._heartbeatsCache?[3,2]:[4,this._heartbeatsCachePromise];case 1:s.sent(),s.label=2;case 2:return null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length?[2,""]:(e=P(),t=function(e,t){var n,r;void 0===t&&(t=1024);var i=[],s=e.slice(),a=function(e){var n=i.find((function(t){return t.agent===e.agent}));if(n){if(n.dates.push(e.date),F(i)>t)return n.dates.pop(),"break"}else if(i.push({agent:e.agent,dates:[e.date]}),F(i)>t)return i.pop(),"break";s=s.slice(1)};try{for(var c=o.__values(e),u=c.next();!u.done&&"break"!==a(u.value);u=c.next());}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return{heartbeatsToSend:i,unsentEntries:s}}(this._heartbeatsCache.heartbeats),n=t.heartbeatsToSend,r=t.unsentEntries,i=c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n})),this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,[4,this._storage.overwrite(this._heartbeatsCache)]):[3,4]);case 3:return s.sent(),[3,5];case 4:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache),s.label=5;case 5:return[2,i]}}))}))},e}();function P(){return(new Date).toISOString().substring(0,10)}var R=function(){function e(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e.prototype.runIndexedDBEnvironmentCheck=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return c.isIndexedDBAvailable()?[2,c.validateIndexedDBOpenable().then((function(){return!0})).catch((function(){return!1}))]:[2,!1]}))}))},e.prototype.read=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return e.sent()?[3,2]:[2,{heartbeats:[]}];case 2:return[4,N(this.app)];case 3:return[2,e.sent()||{heartbeats:[]}]}}))}))},e.prototype.overwrite=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,L(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})]}}))}))},e.prototype.add=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,L(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:o.__spreadArray(o.__spreadArray([],o.__read(n.heartbeats),!1),o.__read(e.heartbeats),!1)})]}}))}))},e}();function F(e){return c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}w(new s.Component("platform-logger",(function(e){return new l(e)}),"PRIVATE")),w(new s.Component("heartbeat",(function(e){return new M(e)}),"PRIVATE")),T(h,d,"node"),T(h,d,"cjs5"),T("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return c.FirebaseError}}),t.SDK_VERSION="10.5.0",t._DEFAULT_ENTRY_NAME=p,t._addComponent=v,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=m,t._clearComponents=function(){y.clear()},t._components=y,t._getProvider=b,t._registerComponent=w,t._removeServiceInstance=function(e,t,n){void 0===n&&(n=p),b(e,t).clearInstance(n)},t.deleteApp=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return t=e.name,m.has(t)?(m.delete(t),[4,Promise.all(e.container.getProviders().map((function(e){return e.delete()})))]):[3,2];case 1:n.sent(),e.isDeleted=!0,n.label=2;case 2:return[2]}}))}))},t.getApp=function(e){void 0===e&&(e=p);var t=m.get(e);if(!t&&e===p&&c.getDefaultAppConfig())return I();if(!t)throw x.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(m.values())},t.initializeApp=I,t.onLog=function(e,t){if(null!==e&&"function"!=typeof e)throw x.create("invalid-log-argument");a.setUserLogHandler(e,t)},t.registerVersion=T,t.setLogLevel=function(e){a.setLogLevel(e)}},730:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(582),i=n(313),s=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),o="[DEFAULT]",a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var a=r.__read(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=o),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spreadArray(r.__spreadArray([],r.__read(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),!1),r.__read(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()}))),!1))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=o),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=o),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,s=void 0===i?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error("".concat(this.name,"(").concat(o,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=r.__values(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=r.__read(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,s=this.onInitCallbacks.get(t);if(s)try{for(var o=r.__values(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===o?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=o),this.component?this.component.multipleInstances?e:o:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),c=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=s,t.ComponentContainer=c,t.Provider=a},23:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(752),i=n(730),s=n(19),o=n(313),a=n(816);const c="@firebase/firestore";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let l="10.5.0";const h=new s.Logger("@firebase/firestore");function d(){return h.logLevel}function f(e,...t){if(h.logLevel<=s.LogLevel.DEBUG){const n=t.map(m);h.debug(`Firestore (${l}): ${e}`,...n)}}function p(e,...t){if(h.logLevel<=s.LogLevel.ERROR){const n=t.map(m);h.error(`Firestore (${l}): ${e}`,...n)}}function g(e,...t){if(h.logLevel<=s.LogLevel.WARN){const n=t.map(m);h.warn(`Firestore (${l}): ${e}`,...n)}}function m(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function y(e="Unexpected state"){const t=`FIRESTORE (${l}) INTERNAL ASSERTION FAILED: `+e;throw p(t),new Error(t)}function v(e,t){e||y()}function w(e,t){return e}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _ extends o.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class x{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class E{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(u.UNAUTHENTICATED)))}shutdown(){}}class T{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class S{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new x;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new x,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{f("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(f("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new x)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(f("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(v("string"==typeof t.accessToken),new E(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return v(null===e||"string"==typeof e),new u(e)}}class C{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class A{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new C(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(u.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class D{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&f("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,f("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{f("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):f("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(v("string"==typeof e.token),this.R=e.token,new D(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function N(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class L{static V(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=N(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function O(e,t){return e<t?-1:e>t?1:0}function M(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function P(e){return e+"\0"}class R{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return R.fromMillis(Date.now())}static fromDate(e){return R.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new R(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?O(this.nanoseconds,e.nanoseconds):O(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class F{constructor(e){this.timestamp=e}static fromTimestamp(e){return new F(e)}static min(){return new F(new R(0,0))}static max(){return new F(new R(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class j{constructor(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===j.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof j?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class V extends j{construct(e,t,n){return new V(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new V(t)}static emptyPath(){return new V([])}}const B=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class q extends j{construct(e,t,n){return new q(e,t,n)}static isValidIdentifier(e){return B.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),q.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new q(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new _(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new _(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new q(t)}static emptyPath(){return new q([])}}class U{constructor(e){this.path=e}static fromPath(e){return new U(V.fromString(e))}static fromName(e){return new U(V.fromString(e).popFirst(5))}static empty(){return new U(V.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===V.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return V.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new V(e.slice()))}}class z{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function G(e){return e.fields.find((e=>2===e.kind))}function $(e){return e.fields.filter((e=>2!==e.kind))}function K(e,t){let n=O(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=Q(e.fields[r],t.fields[r]),0!==n)return n;return O(e.fields.length,t.fields.length)}z.UNKNOWN_ID=-1;class H{constructor(e,t){this.fieldPath=e,this.kind=t}}function Q(e,t){const n=q.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:O(e.kind,t.kind)}class W{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new W(0,J.min())}}function X(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=F.fromTimestamp(1e9===r?new R(n+1,0):new R(n,r));return new J(i,U.empty(),t)}function Y(e){return new J(e.readTime,e.key,-1)}class J{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new J(F.min(),U.empty(),-1)}static max(){return new J(F.max(),U.empty(),-1)}}function Z(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=U.comparator(e.documentKey,t.documentKey),0!==n?n:O(e.largestBatchId,t.largestBatchId))}const ee="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ne(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==ee)throw e;f("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(e){return re.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,n)=>{t(e)}))}static reject(e){return new re(((t,n)=>{n(e)}))}static waitFor(e){return new re(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=re.resolve(!1);for(const n of e)t=t.next((e=>e?re.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new re(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new re(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class ie{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new x,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new ae(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=de(t.target.error);this.m.reject(new ae(e,n))}}static open(e,t,n,r){try{return new ie(t,e.transaction(r,n))}catch(e){throw new ae(t,e)}}get g(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(f("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}p(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ue(t)}}class se{constructor(e,t,n){this.name=e,this.version=t,this.S=n,12.2===se.D(o.getUA())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return f("SimpleDb","Removing database:",e),le(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!o.isIndexedDBAvailable())return!1;if(se.v())return!0;const e=o.getUA(),t=se.D(e),n=0<t&&t<10,r=se.F(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.M)}static O(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static F(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async N(e){return this.db||(f("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ae(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new _(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new _(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ae(e,r))},r.onupgradeneeded=e=>{f("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.S.B(t,r.transaction,e.oldVersion,this.version).next((()=>{f("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.N(e);const t=ie.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.p(),e))).catch((e=>(t.abort(e),re.reject(e)))).toPromise();return s.catch((()=>{})),await t.g,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(f("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class oe{constructor(e){this.q=e,this.K=!1,this.$=null}get isDone(){return this.K}get U(){return this.$}set cursor(e){this.q=e}done(){this.K=!0}W(e){this.$=e}delete(){return le(this.q.delete())}}class ae extends _{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ce(e){return"IndexedDbTransactionError"===e.name}class ue{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(f("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(f("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),le(n)}add(e){return f("SimpleDb","ADD",this.store.name,e,e),le(this.store.add(e))}get(e){return le(this.store.get(e)).next((t=>(void 0===t&&(t=null),f("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return f("SimpleDb","DELETE",this.store.name,e),le(this.store.delete(e))}count(){return f("SimpleDb","COUNT",this.store.name),le(this.store.count())}G(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}{const e=this.store.getAll(n.range);return new re(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new re(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){f("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new re(((n,r)=>{t.onerror=e=>{const t=de(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new re(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new oe(i),o=t(i.primaryKey,i.value,s);if(o instanceof re){const e=o.catch((e=>(s.done(),re.reject(e))));n.push(e)}s.isDone?r():null===s.U?i.continue():i.continue(s.U)}})).next((()=>re.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function le(e){return new re(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=de(e.target.error);n(t)}}))}let he=!1;function de(e){const t=se.D(o.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new _("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return he||(he=!0,setTimeout((()=>{throw e}),0)),e}}return e}class fe{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){f("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{f("IndexBackiller",`Documents written: ${await this.ee.ne()}`)}catch(e){ce(e)?f("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await ne(e)}await this.te(6e4)}))}}class pe{constructor(e,t){this.localStore=e,this.persistence=t}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,i=!0;return re.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return f("IndexBackiller",`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.se(r,n))).next((n=>(f("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Y(t);Z(r,n)>0&&(n=r)})),new J(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ge{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}function me(e){return null==e}function ye(e){return 0===e&&1/e==-1/0}function ve(e){return"number"==typeof e&&Number.isInteger(e)&&!ye(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function we(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=_e(t)),t=be(e.get(n),t);return _e(t)}function be(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function _e(e){return e+""}function xe(e){const t=e.length;if(v(t>=2),2===t)return v(""===e.charAt(0)&&""===e.charAt(1)),V.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&y(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:y()}s=t+2}return new V(r)}ge.ae=-1;const Ee=["userId","batchId"];function Ie(e,t){return[e,we(t)]}function Te(e,t,n){return[e,we(t),n]}const Se={},Ce=["prefixPath","collectionGroup","readTime","documentId"],Ae=["prefixPath","collectionGroup","documentId"],De=["collectionGroup","readTime","prefixPath","documentId"],ke=["canonicalId","targetId"],Ne=["targetId","path"],Le=["path","targetId"],Oe=["collectionId","parent"],Me=["indexId","uid"],Pe=["uid","sequenceNumber"],Re=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fe=["indexId","uid","orderedDocumentKey"],je=["userId","collectionPath","documentId"],Ve=["userId","collectionPath","largestBatchId"],Be=["userId","collectionGroup","largestBatchId"],qe=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ue=[...qe,"documentOverlays"],ze=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ge=ze,$e=[...Ge,"indexConfiguration","indexState","indexEntries"];class Ke extends te{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function He(e,t){const n=w(e);return se.O(n.ue,t)}function Qe(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function We(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Xe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ye{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new Ye(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new Ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Je(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Je(this.root,e,this.comparator,!1)}getReverseIterator(){return new Je(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Je(this.root,e,this.comparator,!0)}}class Je{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ze.RED,this.left=null!=r?r:Ze.EMPTY,this.right=null!=i?i:Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Ze(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ze.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw y();if(this.right.isRed())throw y();const e=this.left.check();if(e!==this.right.check())throw y();return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1,Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw y()}get value(){throw y()}get color(){throw y()}get left(){throw y()}get right(){throw y()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class et{constructor(e){this.comparator=e,this.data=new Ye(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tt(this.data.getIterator())}getIteratorFrom(e){return new tt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof et))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new et(this.comparator);return t.data=e,t}}class tt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nt(e){return e.hasNext()?e.getNext():void 0}class rt{constructor(e){this.fields=e,e.sort(q.comparator)}static empty(){return new rt([])}unionWith(e){let t=new et(q.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new rt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return M(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class it extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class st{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new it("Invalid base64 string: "+e):e}}(e);return new st(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new st(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return O(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const ot=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function at(e){if(v(!!e),"string"==typeof e){let t=0;const n=ot.exec(e);if(v(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ct(e.seconds),nanos:ct(e.nanos)}}function ct(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ut(e){return"string"==typeof e?st.fromBase64String(e):st.fromUint8Array(e)}function lt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ht(e){const t=e.mapValue.fields.__previous_value__;return lt(t)?ht(t):t}function dt(e){const t=at(e.mapValue.fields.__local_write_time__.timestampValue);return new R(t.seconds,t.nanos)}class ft{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class pt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof pt&&e.projectId===this.projectId&&e.database===this.database}}const gt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},mt={nullValue:"NULL_VALUE"};function yt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lt(e)?4:Lt(e)?9007199254740991:10:y()}function vt(e,t){if(e===t)return!0;const n=yt(e);if(n!==yt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dt(e).isEqual(dt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=at(e.timestampValue),r=at(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ut(e.bytesValue).isEqual(ut(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ct(e.geoPointValue.latitude)===ct(t.geoPointValue.latitude)&&ct(e.geoPointValue.longitude)===ct(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ct(e.integerValue)===ct(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ct(e.doubleValue),r=ct(t.doubleValue);return n===r?ye(n)===ye(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return M(e.arrayValue.values||[],t.arrayValue.values||[],vt);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Qe(n)!==Qe(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!vt(n[e],r[e])))return!1;return!0}(e,t);default:return y()}}function wt(e,t){return void 0!==(e.values||[]).find((e=>vt(e,t)))}function bt(e,t){if(e===t)return 0;const n=yt(e),r=yt(t);if(n!==r)return O(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return O(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ct(e.integerValue||e.doubleValue),r=ct(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return _t(e.timestampValue,t.timestampValue);case 4:return _t(dt(e),dt(t));case 5:return O(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ut(e),r=ut(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=O(n[e],r[e]);if(0!==t)return t}return O(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=O(ct(e.latitude),ct(t.latitude));return 0!==n?n:O(ct(e.longitude),ct(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=bt(n[e],r[e]);if(t)return t}return O(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===gt.mapValue&&t===gt.mapValue)return 0;if(e===gt.mapValue)return 1;if(t===gt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=O(r[e],s[e]);if(0!==t)return t;const o=bt(n[r[e]],i[s[e]]);if(0!==o)return o}return O(r.length,s.length)}(e.mapValue,t.mapValue);default:throw y()}}function _t(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return O(e,t);const n=at(e),r=at(t),i=O(n.seconds,r.seconds);return 0!==i?i:O(n.nanos,r.nanos)}function xt(e){return Et(e)}function Et(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=at(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ut(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return U.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Et(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Et(e.fields[i])}`;return n+"}"}(e.mapValue):y()}function It(e){switch(yt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ht(e);return t?16+It(t):16;case 5:return 2*e.stringValue.length;case 6:return ut(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+It(t)),0)}(e.arrayValue);case 10:return function(e){let t=0;return We(e.fields,((e,n)=>{t+=e.length+It(n)})),t}(e.mapValue);default:throw y()}}function Tt(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function St(e){return!!e&&"integerValue"in e}function Ct(e){return!!e&&"arrayValue"in e}function At(e){return!!e&&"nullValue"in e}function Dt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function kt(e){return!!e&&"mapValue"in e}function Nt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return We(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Nt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Nt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Lt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Ot(e){return"nullValue"in e?mt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Tt(pt.empty(),U.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:y()}function Mt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Tt(pt.empty(),U.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?gt:y()}function Pt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Rt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ft{constructor(e){this.value=e}static empty(){return new Ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!kt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nt(t)}setAll(e){let t=q.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Nt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());kt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];kt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){We(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ft(Nt(this.value))}}function jt(e){const t=[];return We(e.fields,((e,n)=>{const r=new q([e]);if(kt(n)){const e=jt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new rt(t)}class Vt{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Vt(e,0,F.min(),F.min(),F.min(),Ft.empty(),0)}static newFoundDocument(e,t,n,r){return new Vt(e,1,t,F.min(),n,r,0)}static newNoDocument(e,t){return new Vt(e,2,t,F.min(),F.min(),Ft.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,F.min(),F.min(),Ft.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(F.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=F.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bt{constructor(e,t){this.position=e,this.inclusive=t}}function qt(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?U.comparator(U.fromName(o.referenceValue),n.key):bt(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ut(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!vt(e.position[n],t.position[n]))return!1;return!0}class zt{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class $t{}class Kt extends $t{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new nn(e,t,n):"array-contains"===t?new an(e,n):"in"===t?new cn(e,n):"not-in"===t?new un(e,n):"array-contains-any"===t?new ln(e,n):new Kt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new rn(e,n):new sn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(bt(t,this.value)):null!==t&&yt(this.value)===yt(t)&&this.matchesComparison(bt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends $t{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new Ht(e,t)}matches(e){return Qt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Qt(e){return"and"===e.op}function Wt(e){return"or"===e.op}function Xt(e){return Yt(e)&&Qt(e)}function Yt(e){for(const t of e.filters)if(t instanceof Ht)return!1;return!0}function Jt(e){if(e instanceof Kt)return e.field.canonicalString()+e.op.toString()+xt(e.value);if(Xt(e))return e.filters.map((e=>Jt(e))).join(",");{const t=e.filters.map((e=>Jt(e))).join(",");return`${e.op}(${t})`}}function Zt(e,t){return e instanceof Kt?function(e,t){return t instanceof Kt&&e.op===t.op&&e.field.isEqual(t.field)&&vt(e.value,t.value)}(e,t):e instanceof Ht?function(e,t){return t instanceof Ht&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Zt(n,t.filters[r])),!0)}(e,t):void y()}function en(e,t){const n=e.filters.concat(t);return Ht.create(n,e.op)}function tn(e){return e instanceof Kt?function(e){return`${e.field.canonicalString()} ${e.op} ${xt(e.value)}`}(e):e instanceof Ht?function(e){return e.op.toString()+" {"+e.getFilters().map(tn).join(" ,")+"}"}(e):"Filter"}class nn extends Kt{constructor(e,t,n){super(e,t,n),this.key=U.fromName(n.referenceValue)}matches(e){const t=U.comparator(e.key,this.key);return this.matchesComparison(t)}}class rn extends Kt{constructor(e,t){super(e,"in",t),this.keys=on(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sn extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=on(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function on(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>U.fromName(e.referenceValue)))}class an extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ct(t)&&wt(t.arrayValue,this.value)}}class cn extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&wt(this.value.arrayValue,t)}}class un extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(wt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!wt(this.value.arrayValue,t)}}class ln extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ct(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>wt(this.value.arrayValue,e)))}}class hn{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.le=null}}function dn(e,t=null,n=[],r=[],i=null,s=null,o=null){return new hn(e,t,n,r,i,s,o)}function fn(e){const t=w(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Jt(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),me(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>xt(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>xt(e))).join(",")),t.le=e}return t.le}function pn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Gt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Zt(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ut(e.startAt,t.startAt)&&Ut(e.endAt,t.endAt)}function gn(e){return U.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function mn(e,t){return e.filters.filter((e=>e instanceof Kt&&e.field.isEqual(t)))}function yn(e,t,n){let r=mt,i=!0;for(const n of mn(e,t)){let e=mt,t=!0;switch(n.op){case"<":case"<=":e=Ot(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=mt}Pt({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Pt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function vn(e,t,n){let r=gt,i=!0;for(const n of mn(e,t)){let e=gt,t=!0;switch(n.op){case">=":case">":e=Mt(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=gt}Rt({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Rt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class wn{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.he=null,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function bn(e,t,n,r,i,s,o,a){return new wn(e,t,n,r,i,s,o,a)}function _n(e){return new wn(e)}function xn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function En(e){return null!==e.collectionGroup}function In(e){const t=w(e);if(null===t.he){t.he=[];const e=new Set;for(const n of t.explicitOrderBy)t.he.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new et(q.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.he.push(new zt(r,n))})),e.has(q.keyField().canonicalString())||t.he.push(new zt(q.keyField(),n))}return t.he}function Tn(e){const t=w(e);return t.Pe||(t.Pe=Sn(t,In(e))),t.Pe}function Sn(e,t){if("F"===e.limitType)return dn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new zt(e.field,t)}));const n=e.endAt?new Bt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Bt(e.startAt.position,e.startAt.inclusive):null;return dn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Cn(e,t){const n=e.filters.concat([t]);return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function An(e,t,n){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Dn(e,t){return pn(Tn(e),Tn(t))&&e.limitType===t.limitType}function kn(e){return`${fn(Tn(e))}|lt:${e.limitType}`}function Nn(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>tn(e))).join(", ")}]`),me(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>xt(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>xt(e))).join(",")),`Target(${t})`}(Tn(e))}; limitType=${e.limitType})`}function Ln(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):U.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of In(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=qt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,In(e),t)||e.endAt&&!function(e,t,n){const r=qt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,In(e),t))}(e,t)}function On(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Mn(e){return(t,n)=>{let r=!1;for(const i of In(e)){const e=Pn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Pn(e,t,n){const r=e.field.isKeyField()?U.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?bt(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}class Rn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){We(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Xe(this.inner)}size(){return this.innerSize}}const Fn=new Ye(U.comparator);function jn(){return Fn}const Vn=new Ye(U.comparator);function Bn(...e){let t=Vn;for(const n of e)t=t.insert(n.key,n);return t}function qn(e){let t=Vn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Un(){return Gn()}function zn(){return Gn()}function Gn(){return new Rn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const $n=new Ye(U.comparator),Kn=new et(U.comparator);function Hn(...e){let t=Kn;for(const n of e)t=t.add(n);return t}const Qn=new et(O);function Wn(){return Qn}function Xn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ye(t)?"-0":t}}function Yn(e){return{integerValue:""+e}}function Jn(e,t){return ve(t)?Yn(t):Xn(e,t)}class Zn{constructor(){this._=void 0}}function er(e,t,n){return e instanceof rr?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&lt(t)&&(t=ht(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ir?sr(e,t):e instanceof or?ar(e,t):function(e,t){const n=nr(e,t),r=ur(n)+ur(e.Te);return St(n)&&St(e.Te)?Yn(r):Xn(e.serializer,r)}(e,t)}function tr(e,t,n){return e instanceof ir?sr(e,t):e instanceof or?ar(e,t):n}function nr(e,t){return e instanceof cr?function(e){return St(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class rr extends Zn{}class ir extends Zn{constructor(e){super(),this.elements=e}}function sr(e,t){const n=lr(t);for(const t of e.elements)n.some((e=>vt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class or extends Zn{constructor(e){super(),this.elements=e}}function ar(e,t){let n=lr(t);for(const t of e.elements)n=n.filter((e=>!vt(e,t)));return{arrayValue:{values:n}}}class cr extends Zn{constructor(e,t){super(),this.serializer=e,this.Te=t}}function ur(e){return ct(e.integerValue||e.doubleValue)}function lr(e){return Ct(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class hr{constructor(e,t){this.field=e,this.transform=t}}class dr{constructor(e,t){this.version=e,this.transformResults=t}}class fr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fr}static exists(e){return new fr(void 0,e)}static updateTime(e){return new fr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class gr{}function mr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Sr(e.key,fr.none()):new _r(e.key,e.data,fr.none());{const n=e.data,r=Ft.empty();let i=new et(q.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new xr(e.key,r,new rt(i.toArray()),fr.none())}}function yr(e,t,n){e instanceof _r?function(e,t,n){const r=e.value.clone(),i=Ir(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof xr?function(e,t,n){if(!pr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Ir(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Er(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function vr(e,t,n,r){return e instanceof _r?function(e,t,n,r){if(!pr(e.precondition,t))return n;const i=e.value.clone(),s=Tr(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof xr?function(e,t,n,r){if(!pr(e.precondition,t))return n;const i=Tr(e.fieldTransforms,r,t),s=t.data;return s.setAll(Er(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return pr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function wr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=nr(r.transform,e||null);null!=i&&(null===n&&(n=Ft.empty()),n.set(r.field,i))}return n||null}function br(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&M(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ir&&t instanceof ir||e instanceof or&&t instanceof or?M(e.elements,t.elements,vt):e instanceof cr&&t instanceof cr?vt(e.Te,t.Te):e instanceof rr&&t instanceof rr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class _r extends gr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class xr extends gr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Er(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Ir(e,t,n){const r=new Map;v(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,tr(o,a,n[i]))}return r}function Tr(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,er(e,s,t))}return r}class Sr extends gr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Cr extends gr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ar{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&yr(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=zn();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=mr(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(F.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Hn())}isEqual(e){return this.batchId===e.batchId&&M(this.mutations,e.mutations,((e,t)=>br(e,t)))&&M(this.baseMutations,e.baseMutations,((e,t)=>br(e,t)))}}class Dr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){v(e.mutations.length===n.length);let r=$n;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new Dr(e,t,n,r)}}class kr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Nr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Lr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Or,Mr;function Pr(e){switch(e){default:return y();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function Rr(e){if(void 0===e)return p("GRPC error has no .code"),b.UNKNOWN;switch(e){case Or.OK:return b.OK;case Or.CANCELLED:return b.CANCELLED;case Or.UNKNOWN:return b.UNKNOWN;case Or.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Or.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Or.INTERNAL:return b.INTERNAL;case Or.UNAVAILABLE:return b.UNAVAILABLE;case Or.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Or.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Or.NOT_FOUND:return b.NOT_FOUND;case Or.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Or.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Or.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Or.ABORTED:return b.ABORTED;case Or.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Or.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Or.DATA_LOSS:return b.DATA_LOSS;default:return y()}}(Mr=Or||(Or={}))[Mr.OK=0]="OK",Mr[Mr.CANCELLED=1]="CANCELLED",Mr[Mr.UNKNOWN=2]="UNKNOWN",Mr[Mr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mr[Mr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mr[Mr.NOT_FOUND=5]="NOT_FOUND",Mr[Mr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mr[Mr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mr[Mr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mr[Mr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mr[Mr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mr[Mr.ABORTED=10]="ABORTED",Mr[Mr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mr[Mr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mr[Mr.INTERNAL=13]="INTERNAL",Mr[Mr.UNAVAILABLE=14]="UNAVAILABLE",Mr[Mr.DATA_LOSS=15]="DATA_LOSS";let Fr=null;function jr(){return new TextEncoder}const Vr=new a.Integer([4294967295,4294967295],0);function Br(e){const t=jr().encode(e),n=new a.Md5;return n.update(t),new Uint8Array(n.digest())}function qr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new a.Integer([n,r],0),new a.Integer([i,s],0)]}class Ur{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new zr(`Invalid padding: ${t}`);if(n<0)throw new zr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new zr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new zr(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=a.Integer.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(a.Integer.fromNumber(n)));return 1===r.compare(Vr)&&(r=new a.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=Br(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ae(n,r,e);if(!this.Re(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Ur(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ee)return;const t=Br(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.Ae(n,r,e);this.Ve(t)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class zr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,$r.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Gr(F.min(),r,new Ye(O),jn(),Hn())}}class $r{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new $r(n,t,Hn(),Hn(),Hn())}}class Kr{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class Hr{constructor(e,t){this.targetId=e,this.ge=t}}class Qr{constructor(e,t,n=st.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Wr{constructor(){this.pe=0,this.ye=Jr(),this.we=st.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get Ce(){return this.be}ve(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Hn(),t=Hn(),n=Hn();return this.ye.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}})),new $r(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Jr()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1}Le(){this.be=!0,this.Se=!0}}class Xr{constructor(e){this.ke=e,this.qe=new Map,this.Qe=jn(),this.Ke=Yr(),this.$e=new Ye(O)}Ue(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.We(t,e.fe):this.Ge(t,e.key,e.fe);for(const t of e.removedTargetIds)this.Ge(t,e.key,e.fe)}ze(e){this.forEachTarget(e,(t=>{const n=this.je(t);switch(e.state){case 0:this.He(t)&&n.ve(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.ve(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.He(t)&&(n.Le(),n.ve(e.resumeToken));break;case 4:this.He(t)&&(this.Je(t),n.ve(e.resumeToken));break;default:y()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,n)=>{this.He(n)&&t(n)}))}Ye(e){const t=e.targetId,n=e.ge.count,r=this.Ze(t);if(r){const i=r.target;if(gn(i))if(0===n){const e=new U(i.path);this.Ge(t,e,Vt.newNoDocument(e,F.min()))}else v(1===n);else{const r=this.Xe(t);if(r!==n){const n=this.et(e),i=n?this.tt(n,e,r):1;if(0!==i){this.Je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.$e=this.$e.insert(t,e)}null==Fr||Fr.nt(function(e,t,n,r,i){var s,o,a,c,u,l;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(l=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.ge,this.ke.rt(),n,i))}}}}et(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=ut(n).toUint8Array()}catch(e){if(e instanceof it)return g("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Ur(s,r,i)}catch(e){return g(e instanceof zr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ee?null:o}tt(e,t,n){return t.ge.count===n-this.it(e,t.targetId)?0:2}it(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.ke.rt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ge(t,n,null),r++)})),r}st(e){const t=new Map;this.qe.forEach(((n,r)=>{const i=this.Ze(r);if(i){if(n.current&&gn(i.target)){const t=new U(i.target.path);null!==this.Qe.get(t)||this.ot(r,t)||this.Ge(r,t,Vt.newNoDocument(t,e))}n.Ce&&(t.set(r,n.Fe()),n.Me())}}));let n=Hn();this.Ke.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ze(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Gr(e,t,this.$e,this.Qe,n);return this.Qe=jn(),this.Ke=Yr(),this.$e=new Ye(O),r}We(e,t){if(!this.He(e))return;const n=this.ot(e,t.key)?2:0;this.je(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.Ke=this.Ke.insert(t.key,this._t(t.key).add(e))}Ge(e,t,n){if(!this.He(e))return;const r=this.je(e);this.ot(e,t)?r.xe(t,1):r.Oe(t),this.Ke=this.Ke.insert(t,this._t(t).delete(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}Xe(e){const t=this.je(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.je(e).Ne()}je(e){let t=this.qe.get(e);return t||(t=new Wr,this.qe.set(e,t)),t}_t(e){let t=this.Ke.get(e);return t||(t=new et(O),this.Ke=this.Ke.insert(e,t)),t}He(e){const t=null!==this.Ze(e);return t||f("WatchChangeAggregator","Detected inactive target",e),t}Ze(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.ut(e)}Je(e){this.qe.set(e,new Wr),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.Ge(e,t,null)}))}ot(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function Yr(){return new Ye(U.comparator)}function Jr(){return new Ye(U.comparator)}const Zr={asc:"ASCENDING",desc:"DESCENDING"},ei={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ti={and:"AND",or:"OR"};class ni{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ri(e,t){return e.useProto3Json||me(t)?t:{value:t}}function ii(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function si(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function oi(e,t){return ii(e,t.toTimestamp())}function ai(e){return v(!!e),F.fromTimestamp(function(e){const t=at(e);return new R(t.seconds,t.nanos)}(e))}function ci(e,t){return function(e){return new V(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function ui(e){const t=V.fromString(e);return v(Ni(t)),t}function li(e,t){return ci(e.databaseId,t.path)}function hi(e,t){const n=ui(t);if(n.get(1)!==e.databaseId.projectId)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new U(gi(n))}function di(e,t){return ci(e.databaseId,t)}function fi(e){const t=ui(e);return 4===t.length?V.emptyPath():gi(t)}function pi(e){return new V(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function gi(e){return v(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function mi(e,t,n){return{name:li(e,t),fields:n.value.mapValue.fields}}function yi(e,t,n){const r=hi(e,t.name),i=ai(t.updateTime),s=t.createTime?ai(t.createTime):F.min(),o=new Ft({mapValue:{fields:t.fields}}),a=Vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function vi(e,t){let n;if(t instanceof _r)n={update:mi(e,t.key,t.value)};else if(t instanceof Sr)n={delete:li(e,t.key)};else if(t instanceof xr)n={update:mi(e,t.key,t.data),updateMask:ki(t.fieldMask)};else{if(!(t instanceof Cr))return y();n={verify:li(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof rr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ir)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof or)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),increment:n.Te};throw y()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:oi(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.precondition)),n}function wi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?fr.updateTime(ai(e.updateTime)):void 0!==e.exists?fr.exists(e.exists):fr.none()}(t.currentDocument):fr.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue),n=new rr;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ir(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new or(e)}else"increment"in t?n=new cr(e,t.increment):y();const r=q.fromServerFormat(t.fieldPath);return new hr(r,n)}(e,t))):[];if(t.update){t.update.name;const i=hi(e,t.update.name),s=new Ft({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new rt(t.map((e=>q.fromServerFormat(e))))}(t.updateMask);return new xr(i,s,e,n,r)}return new _r(i,s,n,r)}if(t.delete){const r=hi(e,t.delete);return new Sr(r,n)}if(t.verify){const r=hi(e,t.verify);return new Cr(r,n)}return y()}function bi(e,t){return{documents:[di(e,t.path)]}}function _i(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=di(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=di(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return Di(Ht.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ci(e.field),direction:Ii(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ri(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function xi(e){let t=fi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){v(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ei(e);return t instanceof Ht&&Xt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new zt(Ai(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,me(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Bt(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Bt(n,t)}(n.endAt)),bn(t,i,o,s,a,"F",c,u)}function Ei(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ai(e.unaryFilter.field);return Kt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ai(e.unaryFilter.field);return Kt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ai(e.unaryFilter.field);return Kt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ai(e.unaryFilter.field);return Kt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return y()}}(e):void 0!==e.fieldFilter?function(e){return Kt.create(Ai(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ht.create(e.compositeFilter.filters.map((e=>Ei(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return y()}}(e.compositeFilter.op))}(e):y()}function Ii(e){return Zr[e]}function Ti(e){return ei[e]}function Si(e){return ti[e]}function Ci(e){return{fieldPath:e.canonicalString()}}function Ai(e){return q.fromServerFormat(e.fieldPath)}function Di(e){return e instanceof Kt?function(e){if("=="===e.op){if(Dt(e.value))return{unaryFilter:{field:Ci(e.field),op:"IS_NAN"}};if(At(e.value))return{unaryFilter:{field:Ci(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Dt(e.value))return{unaryFilter:{field:Ci(e.field),op:"IS_NOT_NAN"}};if(At(e.value))return{unaryFilter:{field:Ci(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ci(e.field),op:Ti(e.op),value:e.value}}}(e):e instanceof Ht?function(e){const t=e.getFilters().map((e=>Di(e)));return 1===t.length?t[0]:{compositeFilter:{op:Si(e.op),filters:t}}}(e):y()}function ki(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Ni(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Li{constructor(e,t,n,r,i=F.min(),s=F.min(),o=st.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Oi{constructor(e){this.ct=e}}function Mi(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Pi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:li(e,t.key),fields:t.data.value.mapValue.fields,updateTime:ii(e,t.version.toTimestamp()),createTime:ii(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ri(t.version)};else{if(!t.isUnknownDocument())return y();r.unknownDocument={path:n.path.toArray(),version:Ri(t.version)}}return r}function Pi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Ri(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Fi(e){const t=new R(e.seconds,e.nanoseconds);return F.fromTimestamp(t)}function ji(e,t){const n=(t.baseMutations||[]).map((t=>wi(e.ct,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>wi(e.ct,t))),i=R.fromMillis(t.localWriteTimeMs);return new Ar(t.batchId,i,n,r)}function Vi(e){const t=Fi(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Fi(e.lastLimboFreeSnapshotVersion):F.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return v(1===e.documents.length),Tn(_n(fi(e.documents[0])))}(e.query):function(e){return Tn(xi(e))}(e.query),new Li(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,st.fromBase64String(e.resumeToken))}function Bi(e,t){const n=Ri(t.snapshotVersion),r=Ri(t.lastLimboFreeSnapshotVersion);let i;i=gn(t.target)?bi(e.ct,t.target):_i(e.ct,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:fn(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function qi(e){const t=xi({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?An(t,t.limit,"L"):t}function Ui(e,t){return new kr(t.largestBatchId,wi(e.ct,t.overlayMutation))}function zi(e,t){const n=t.path.lastSegment();return[e,we(t.path.popLast()),n]}function Gi(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:Ri(r.readTime),documentKey:we(r.documentKey.path),largestBatchId:r.largestBatchId}}class $i{getBundleMetadata(e,t){return Ki(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Fi(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Ki(e).put(function(e){return{bundleId:e.id,createTime:Ri(ai(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Hi(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:qi(e.bundledQuery),readTime:Fi(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Hi(e).put(function(e){return{name:e.name,readTime:Ri(ai(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Ki(e){return He(e,"bundles")}function Hi(e){return He(e,"namedQueries")}class Qi{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Qi(e,n)}getOverlay(e,t){return Wi(e).get(zi(this.userId,t)).next((e=>e?Ui(this.serializer,e):null))}getOverlays(e,t){const n=Un();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new kr(t,i);r.push(this.ht(e,s))})),re.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(we(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Wi(e).J("collectionPathOverlayIndex",r))})),re.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Un(),i=we(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Wi(e).G("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=Ui(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Un();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wi(e).Z({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=Ui(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return Wi(e).put(function(e,t,n){const[r,i,s]=zi(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:vi(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function Wi(e){return He(e,"documentOverlays")}class Xi{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(ct(e.integerValue));else if("doubleValue"in e){const n=ct(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),ye(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ut(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Lt(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):y()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),U.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function Yi(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ji(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Yi(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Xi.bt=new Xi;class Zi{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ct(e);else if(e<2048)this.Ct(960|e>>>6),this.Ct(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e);else{const e=t.codePointAt(0);this.Ct(240|e>>>18),this.Ct(128|63&e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e)}}this.vt()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Bt(e){const t=this.Lt(e),n=Ji(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}qt(e){const t=this.Lt(e),n=Ji(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class es{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}}class ts{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class ns{constructor(){this.Gt=new Zi,this.zt=new es(this.Gt),this.jt=new ts(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class rs{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new rs(this.indexId,this.documentKey,this.arrayValue,n)}}function is(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=ss(e.arrayValue,t.arrayValue),0!==n?n:(n=ss(e.directionalValue,t.directionalValue),0!==n?n:U.comparator(e.documentKey,t.documentKey)))}function ss(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class os{constructor(e){this.Yt=new et(((e,t)=>q.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Yt=this.Yt.add(e):this.Xt.push(e)}}get en(){return this.Yt.size>1}tn(e){if(v(e.collectionGroup===this.collectionId),this.en)return!1;const t=G(e);if(void 0!==t&&!this.nn(t))return!1;const n=$(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.nn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Yt.size>0){const e=this.Yt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.rn(e,t)||!this.sn(this.Zt[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Zt.length||!this.sn(this.Zt[s++],e))return!1}return!0}on(){if(this.en)return null;let e=new et(q.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new H(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new H(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new H(n.field,"asc"===n.dir?0:1)));return new z(z.UNKNOWN_ID,this.collectionId,t,W.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function as(e){var t,n;if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt){if(e instanceof cn){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Kt.create(e.field,"==",t))))||[];return Ht.create(r,"or")}return e}const r=e.filters.map((e=>as(e)));return Ht.create(r,e.op)}function cs(e){if(0===e.getFilters().length)return[];const t=ds(as(e));return v(hs(t)),us(t)||ls(t)?[t]:t.getFilters()}function us(e){return e instanceof Kt}function ls(e){return e instanceof Ht&&Xt(e)}function hs(e){return us(e)||ls(e)||function(e){if(e instanceof Ht&&Wt(e)){for(const t of e.getFilters())if(!us(t)&&!ls(t))return!1;return!0}return!1}(e)}function ds(e){if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt)return e;if(1===e.filters.length)return ds(e.filters[0]);const t=e.filters.map((e=>ds(e)));let n=Ht.create(t,e.op);return n=gs(n),hs(n)?n:(v(n instanceof Ht),v(Qt(n)),v(n.filters.length>1),n.filters.reduce(((e,t)=>fs(e,t))))}function fs(e,t){let n;return v(e instanceof Kt||e instanceof Ht),v(t instanceof Kt||t instanceof Ht),n=e instanceof Kt?t instanceof Kt?function(e,t){return Ht.create([e,t],"and")}(e,t):ps(e,t):t instanceof Kt?ps(t,e):function(e,t){if(v(e.filters.length>0&&t.filters.length>0),Qt(e)&&Qt(t))return en(e,t.getFilters());const n=Wt(e)?e:t,r=Wt(e)?t:e,i=n.filters.map((e=>fs(e,r)));return Ht.create(i,"or")}(e,t),gs(n)}function ps(e,t){if(Qt(t))return en(t,e.getFilters());{const n=t.filters.map((t=>fs(e,t)));return Ht.create(n,"or")}}function gs(e){if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt)return e;const t=e.getFilters();if(1===t.length)return gs(t[0]);if(Yt(e))return e;const n=t.map((e=>gs(e))),r=[];return n.forEach((t=>{t instanceof Kt?r.push(t):t instanceof Ht&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Ht.create(r,e.op)}class ms{constructor(){this._n=new ys}addToCollectionParentIndex(e,t){return this._n.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(J.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(J.min())}updateCollectionGroup(e,t,n){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class ys{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new et(V.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new et(V.comparator)).toArray()}}const vs=new Uint8Array(0);class ws{constructor(e,t){this.user=e,this.databaseId=t,this.an=new ys,this.un=new Rn((e=>fn(e)),((e,t)=>pn(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.an.add(t)}));const i={collectionId:n,parent:we(r)};return bs(e).put(i)}return re.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[P(t),""],!1,!0);return bs(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(xe(r.parent))}return n}))}addFieldIndex(e,t){const n=xs(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Es(e);return i.next((e=>{n.put(Gi(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=xs(e),r=Es(e),i=_s(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=xs(e),n=_s(e),r=Es(e);return t.J().next((()=>n.J())).next((()=>r.J()))}createTargetIndexes(e,t){return re.forEach(this.cn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new os(t).on();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=_s(e);let r=!0;const i=new Map;return re.forEach(this.cn(t),(t=>this.ln(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Hn();const r=[];return re.forEach(i,((i,s)=>{f("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${fn(t)}`);const o=function(e,t){const n=G(t);if(void 0===n)return null;for(const t of mn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of $(t))for(const t of mn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of $(t)){const t=0===i.kind?yn(e,i.fieldPath,e.startAt):vn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Bt(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of $(t)){const t=0===i.kind?vn(e,i.fieldPath,e.endAt):yn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Bt(n,r)}(s,i),l=this.hn(i,s,c),h=this.hn(i,s,u),d=this.Pn(i,s,a),p=this.In(i.indexId,o,l,c.inclusive,h,u.inclusive,d);return re.forEach(p,(i=>n.H(i,t.limit).next((t=>{t.forEach((t=>{const n=U.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return re.resolve(null)}))}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:cs(Ht.create(e.filters,"and")).map((t=>dn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.un.set(e,t),t)}In(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.Tn(t[l/c]):vs,h=this.En(e,a,n[l%c],r),d=this.dn(e,a,i[l%c],s),f=o.map((t=>this.En(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}En(e,t,n,r){const i=new rs(e,U.empty(),t,n);return r?i:i.Jt()}dn(e,t,n,r){const i=new rs(e,U.empty(),t,n);return r?i.Jt():i}ln(e,t){const n=new os(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.cn(t);return re.forEach(r,(t=>this.ln(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new et(q.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}An(e,t){const n=new ns;for(const r of $(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Ht(r.kind);Xi.bt.Pt(e,i)}return n.Wt()}Tn(e){const t=new ns;return Xi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new ns;return Xi.bt.Pt(Tt(this.databaseId,t),n.Ht(function(e){const t=$(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let r=[];r.push(new ns);let i=0;for(const s of $(e)){const e=n[i++];for(const n of r)if(this.Vn(t,s.fieldPath)&&Ct(e))r=this.mn(r,s,e);else{const t=n.Ht(s.kind);Xi.bt.Pt(e,t)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new ns;r.seed(n.Wt()),Xi.bt.Pt(e,r.Ht(t.kind)),i.push(r)}return i}Vn(e,t){return!!e.filters.find((e=>e instanceof Kt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=xs(e),r=Es(e);return(t?n.G("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return re.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new W(t.sequenceNumber,new J(Fi(t.readTime),new U(xe(t.documentKey)),t.largestBatchId)):W.empty(),r=e.fields.map((([e,t])=>new H(q.fromServerFormat(e),t)));return new z(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:O(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=xs(e),i=Es(e);return this.gn(e).next((e=>r.G("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>re.forEach(t,(t=>i.put(Gi(t.indexId,this.user,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return re.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?re.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),re.forEach(i,(n=>this.pn(e,t,n).next((t=>{const i=this.yn(r,n);return t.isEqual(i)?re.resolve():this.wn(e,r,n,t,i)})))))))}))}Sn(e,t,n,r){return _s(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return _s(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const r=_s(e);let i=new et(is);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},((e,r)=>{i=i.add(new rs(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}yn(e,t){let n=new et(is);const r=this.An(t,e);if(null==r)return n;const i=G(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Ct(s))for(const i of s.arrayValue.values||[])n=n.add(new rs(t.indexId,e.key,this.Tn(i),r))}else n=n.add(new rs(t.indexId,e.key,vs,r));return n}wn(e,t,n,r,i){f("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=nt(s),c=nt(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=nt(o)):t?(i(a),a=nt(s)):(a=nt(s),c=nt(o))}}(r,i,is,(r=>{s.push(this.Sn(e,t,n,r))}),(r=>{s.push(this.bn(e,t,n,r))})),re.waitFor(s)}gn(e){let t=1;return Es(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>is(e,t))).filter(((e,t,n)=>!t||0!==is(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=is(i,e),s=is(i,t);if(0===n)r[0]=e.Jt();else if(n>0&&s<0)r.push(i),r.push(i.Jt());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.Dn(r[e],r[e+1]))return[];const t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,vs,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,vs,[]];i.push(IDBKeyRange.bound(t,n))}return i}Dn(e,t){return is(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Is)}getMinOffset(e,t){return re.mapArray(this.cn(t),(t=>this.ln(e,t).next((e=>e||y())))).next(Is)}}function bs(e){return He(e,"collectionParents")}function _s(e){return He(e,"indexEntries")}function xs(e){return He(e,"indexConfiguration")}function Es(e){return He(e,"indexState")}function Is(e){v(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Z(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new J(t.readTime,t.documentKey,n)}const Ts={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ss{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ss(e,Ss.DEFAULT_COLLECTION_PERCENTILE,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Cs(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Z({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{v(1===a)})));const u=[];for(const e of n.mutations){const r=Te(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return re.waitFor(s).next((()=>u))}function As(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}Ss.DEFAULT_COLLECTION_PERCENTILE=10,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ss.DEFAULT=new Ss(41943040,Ss.DEFAULT_COLLECTION_PERCENTILE,Ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ss.DISABLED=new Ss(-1,0,0);class Ds{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){v(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Ds(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).Z({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Ls(e),s=Ns(e);return s.add({}).next((o=>{v("number"==typeof o);const a=new Ar(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>vi(e.ct,t))),i=n.mutations.map((t=>vi(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let l=new et(((e,t)=>O(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Te(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,Se))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Cn[o]=a.keys()})),re.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Ns(e).get(t).next((e=>e?(v(e.userId===this.userId),ji(this.serializer,e)):null))}vn(e,t){return this.Cn[t]?re.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Cn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Ns(e).Z({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(v(t.batchId>=n),i=ji(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ns(e).Z({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ns(e).G("userMutationsIndex",t).next((e=>e.map((e=>ji(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Ie(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Ls(e).Z({range:r},((n,r,s)=>{const[o,a,c]=n,u=xe(a);if(o===this.userId&&t.path.isEqual(u))return Ns(e).get(c).next((e=>{if(!e)throw y();v(e.userId===this.userId),i.push(ji(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(O);const r=[];return t.forEach((t=>{const i=Ie(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Ls(e).Z({range:s},((e,r,i)=>{const[s,o,a]=e,c=xe(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),re.waitFor(r).next((()=>this.Fn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Ie(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new et(O);return Ls(e).Z({range:s},((e,t,i)=>{const[s,a,c]=e,u=xe(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Fn(e,o)))}Fn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Ns(e).get(t).next((e=>{if(null===e)throw y();v(e.userId===this.userId),n.push(ji(this.serializer,e))})))})),re.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return Cs(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Mn(t.batchId)})),re.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Ls(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=xe(e[1]);r.push(t)}else n.done()})).next((()=>{v(0===r.length)}))}))}containsKey(e,t){return ks(e,this.userId,t)}xn(e){return Os(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function ks(e,t,n){const r=Ie(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ls(e).Z({range:s,Y:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Ns(e){return He(e,"mutations")}function Ls(e){return He(e,"documentMutations")}function Os(e){return He(e,"mutationQueues")}class Ms{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ms(0)}static Bn(){return new Ms(-1)}}class Ps{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Ln(e).next((t=>{const n=new Ms(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Ln(e).next((e=>F.fromTimestamp(new R(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Ln(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Ln(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r))))}addTargetData(e,t){return this.qn(e,t).next((()=>this.Ln(e).next((n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Rs(e).delete(t.targetId))).next((()=>this.Ln(e))).next((t=>(v(t.targetCount>0),t.targetCount-=1,this.kn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Rs(e).Z(((s,o)=>{const a=Vi(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>re.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Rs(e).Z(((e,n)=>{const r=Vi(n);t(r)}))}Ln(e){return Fs(e).get("targetGlobalKey").next((e=>(v(null!==e),e)))}kn(e,t){return Fs(e).put("targetGlobalKey",t)}qn(e,t){return Rs(e).put(Bi(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Ln(e).next((e=>e.targetCount))}getTargetData(e,t){const n=fn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Rs(e).Z({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=Vi(n);pn(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=js(e);return t.forEach((t=>{const s=we(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),re.waitFor(r)}removeMatchingKeys(e,t,n){const r=js(e);return re.forEach(t,(t=>{const i=we(t.path);return re.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=js(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=js(e);let i=Hn();return r.Z({range:n,Y:!0},((e,t,n)=>{const r=xe(e[1]),s=new U(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=we(t.path),r=IDBKeyRange.bound([n],[P(n)],!1,!0);let i=0;return js(e).Z({index:"documentTargetsIndex",Y:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}ut(e,t){return Rs(e).get(t).next((e=>e?Vi(e):null))}}function Rs(e){return He(e,"targets")}function Fs(e){return He(e,"targetGlobal")}function js(e){return He(e,"targetDocuments")}function Vs([e,t],[n,r]){const i=O(e,n);return 0===i?O(t,r):i}class Bs{constructor(e){this.Kn=e,this.buffer=new et(Vs),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Vs(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qs{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){f("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ce(e)?f("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await ne(e)}await this.zn(3e5)}))}}class Us{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return re.resolve(ge.ae);const n=new Bs(t);return this.jn.forEachTarget(e,(e=>n.Wn(e.sequenceNumber))).next((()=>this.jn.Jn(e,(e=>n.Wn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(Ts)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ts):this.Yn(e,t)))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,r,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(f("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),d()<=s.LogLevel.DEBUG&&f("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function zs(e,t){return new Us(e,t)}class Gs{constructor(e,t){this.db=e,this.garbageCollector=zs(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,((e,n)=>t(n)))}addReference(e,t,n){return $s(e,n)}removeReference(e,t,n){return $s(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $s(e,t)}er(e,t){return function(e,t){let n=!1;return Os(e).X((r=>ks(e,r,t).next((e=>(e&&(n=!0),re.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Xn(e,((s,o)=>{if(o<=t){const t=this.er(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,F.min()),js(e).delete(function(e){return[0,we(e.path)]}(s)))))}));r.push(t)}})).next((()=>re.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $s(e,t)}Xn(e,t){const n=js(e);let r,i=ge.ae;return n.Z({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==ge.ae&&t(new U(xe(r)),i),i=o,r=s):i=ge.ae})).next((()=>{i!==ge.ae&&t(new U(xe(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $s(e,t){return js(e).put(function(e,t){return{targetId:0,path:we(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Ks{constructor(){this.changes=new Rn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?re.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Hs{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Ys(e).put(n)}removeEntry(e,t,n){return Ys(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Pi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.tr(e,n))))}getEntry(e,t){let n=Vt.newInvalidDocument(t);return Ys(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Js(t))},((e,r)=>{n=this.nr(t,r)})).next((()=>n))}rr(e,t){let n={size:0,document:Vt.newInvalidDocument(t)};return Ys(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Js(t))},((e,r)=>{n={document:this.nr(t,r),size:As(r)}})).next((()=>n))}getEntries(e,t){let n=jn();return this.ir(e,t,((e,t)=>{const r=this.nr(e,t);n=n.insert(e,r)})).next((()=>n))}sr(e,t){let n=jn(),r=new Ye(U.comparator);return this.ir(e,t,((e,t)=>{const i=this.nr(e,t);n=n.insert(e,i),r=r.insert(e,As(t))})).next((()=>({documents:n,_r:r})))}ir(e,t,n){if(t.isEmpty())return re.resolve();let r=new et(eo);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Js(r.first()),Js(r.last())),s=r.getIterator();let o=s.getNext();return Ys(e).Z({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=U.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&eo(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.W(Js(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Pi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ys(e).G(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=jn();for(const i of e){const e=this.nr(U.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Ln(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=jn();const s=Zs(t,n),o=Zs(t,J.max());return Ys(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.nr(U.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Ws(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Xs(e).get("remoteDocumentGlobalKey").next((e=>(v(!!e),e)))}tr(e,t){return Xs(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=yi(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=U.fromSegments(t.noDocument.path),r=Fi(t.noDocument.readTime);n=Vt.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return y();{const e=U.fromSegments(t.unknownDocument.path),r=Fi(t.unknownDocument.version);n=Vt.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new R(e[0],e[1]);return F.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(F.min()))return e}return Vt.newInvalidDocument(e)}}function Qs(e){return new Hs(e)}class Ws extends Ks{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Rn((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new et(((e,t)=>O(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.ur.get(i);if(t.push(this.ar.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Mi(this.ar.serializer,s);r=r.add(i.path.popLast());const c=As(a);n+=c-o.size,t.push(this.ar.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Mi(this.ar.serializer,s.convertToNoDocument(F.min()));t.push(this.ar.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.ar.updateMetadata(e,n)),re.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next((e=>(this.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.ar.sr(e,t).next((({documents:e,_r:t})=>(t.forEach(((t,n)=>{this.ur.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Xs(e){return He(e,"remoteDocumentGlobal")}function Ys(e){return He(e,"remoteDocumentsV14")}function Js(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Zs(e,t){const n=t.documentKey.path.toArray();return[e,Pi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function eo(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=O(n[e],r[e]),i)return i;return i=O(n.length,r.length),i||(i=O(n[n.length-2],r[r.length-2]),i||O(n[n.length-1],r[r.length-1]))}class to{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class no{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&vr(n.mutation,e,rt.empty(),R.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Hn()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Hn()){const r=Un();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Bn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Un();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Hn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=jn();const s=Gn(),o=Gn();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof xr)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),vr(o.mutation,t,o.mutation.getFieldMask(),R.now())):s.set(t.key,rt.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new to(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Gn();let r=new Ye(((e,t)=>e-t)),i=Hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||rt.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Hn()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=zn();c.forEach((e=>{if(!i.has(e)){const r=mr(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return re.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return U.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):En(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):re.resolve(Un());let o=-1,a=i;return s.next((t=>re.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?re.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Hn()))).next((e=>({batchId:o,changes:qn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next((e=>{let t=Bn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Bn();return this.indexManager.getCollectionParents(e,i).next((o=>re.forEach(o,(o=>{const a=function(e,t){return new wn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Vt.newInvalidDocument(r)))}));let n=Bn();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&vr(s.mutation,r,rt.empty(),R.now()),Ln(t,r)&&(n=n.insert(e,r))})),n}))}}class ro{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return re.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ai(e.createTime)}}(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:qi(e.bundledQuery),readTime:ai(e.readTime)}}(t)),re.resolve()}}class io{constructor(){this.overlays=new Ye(U.comparator),this.hr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Un();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),re.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),re.resolve()}getOverlaysForCollection(e,t,n){const r=Un(),i=t.length+1,s=new U(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ye(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Un(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Un(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return re.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new kr(t,n));let i=this.hr.get(t);void 0===i&&(i=Hn(),this.hr.set(t,i)),this.hr.set(t,i.add(n.key))}}class so{constructor(){this.Pr=new et(oo.Ir),this.Tr=new et(oo.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new oo(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new oo(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new U(new V([])),n=new oo(t,e),r=new oo(t,e+1),i=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),i.push(e.key)})),i}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new U(new V([])),n=new oo(t,e),r=new oo(t,e+1);let i=Hn();return this.Tr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new oo(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class oo{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return U.comparator(e.key,t.key)||O(e.pr,t.pr)}static Er(e,t){return O(e.pr,t.pr)||U.comparator(e.key,t.key)}}class ao{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new et(oo.Ir)}checkEmpty(e){return re.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ar(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.wr=this.wr.add(new oo(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),i=r<0?0:r;return re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new oo(t,0),r=new oo(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);i.push(t)})),re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(O);return t.forEach((e=>{const t=new oo(e,0),r=new oo(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),re.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;U.isDocumentKey(i)||(i=i.child(""));const s=new oo(new U(i),0);let o=new et(O);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)}),s),re.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){v(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return re.forEach(t.mutations,(r=>{const i=new oo(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new oo(t,0),r=this.wr.firstAfterOrEqual(n);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class co{constructor(e){this.vr=e,this.docs=new Ye(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return re.resolve(n?n.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let n=jn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Vt.newInvalidDocument(e))})),re.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=jn();const s=t.path,o=new U(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Z(Y(o),n)<=0||(r.has(o.key)||Ln(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return re.resolve(i)}getAllFromCollectionGroup(e,t,n,r){y()}Fr(e,t){return re.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new uo(this)}getSize(e){return re.resolve(this.size)}}class uo extends Ks{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),re.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class lo{constructor(e){this.persistence=e,this.Mr=new Rn((e=>fn(e)),pn),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Or=0,this.Nr=new so,this.targetCount=0,this.Br=Ms.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),re.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Br=new Ms(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.qn(t),re.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),re.waitFor(i).next((()=>r))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return re.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),re.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),re.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return re.resolve(n)}containsKey(e,t){return re.resolve(this.Nr.containsKey(t))}}class ho{constructor(e,t){this.Lr={},this.overlays={},this.kr=new ge(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new lo(this),this.indexManager=new ms,this.remoteDocumentCache=function(e){return new co(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Oi(t),this.$r=new ro(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new io,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Lr[e.toKey()];return n||(n=new ao(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){f("MemoryPersistence","Starting transaction:",e);const r=new fo(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return re.or(Object.values(this.Lr).map((n=>()=>n.containsKey(e,t))))}}class fo extends te{constructor(e){super(),this.currentSequenceNumber=e}}class po{constructor(e){this.persistence=e,this.zr=new so,this.jr=null}static Hr(e){return new po(e)}get Jr(){if(this.jr)return this.jr;throw y()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),re.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),re.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Jr,(n=>{const r=U.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,F.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return re.or([()=>re.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class go{constructor(e,t){this.persistence=e,this.Zr=new Rn((e=>we(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=zs(this,t)}static Hr(e,t){return new go(e,t)}Ur(){}Wr(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Hn(e){const t=this.Zn(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}Jn(e,t){return re.forEach(this.Zr,((n,r)=>this.er(e,n,r).next((e=>e?re.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.Fr(e,(r=>this.er(e,r,t).next((e=>{e||(n++,i.removeEntry(r,F.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.Zr.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),re.resolve()}removeReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.Zr.set(t,e.currentSequenceNumber),re.resolve()}Kr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=It(e.data.value)),t}er(e,t,n){return re.or([()=>this.persistence.Gr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Zr.get(t);return re.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class mo{constructor(e){this.serializer=e}B(e,t,n,r){const i=new ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ee,{unique:!0}),e.createObjectStore("documentMutations")}(e),yo(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=re.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),yo(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:F.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").G().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ee,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return re.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Xr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ei(i))))),n<7&&r>=7&&(s=s.next((()=>this.ti(i)))),n<8&&r>=8&&(s=s.next((()=>this.ni(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ri(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:je});t.createIndex("collectionPathOverlayIndex",Ve,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Be,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Ce});t.createIndex("documentKeyIndex",Ae),t.createIndex("collectionGroupIndex",De)}(e))).next((()=>this.ii(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.si(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Me}).createIndex("sequenceNumberIndex",Pe,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Re}).createIndex("documentKeyIndex",Fe,{unique:!1})}(e)))),s}ei(e){let t=0;return e.store("remoteDocuments").Z(((e,n)=>{t+=As(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.G().next((t=>re.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.G("userMutationsIndex",r).next((n=>re.forEach(n,(n=>{v(n.userId===t.userId);const r=ji(this.serializer,n);return Cs(e,t.userId,r).next((()=>{}))}))))}))))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Z(((n,i)=>{const s=new V(n),o=function(e){return[0,we(e)]}(s);r.push(t.get(o).next((n=>n?re.resolve():(n=>t.put({targetId:0,path:we(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>re.waitFor(r)))}))}ni(e,t){e.createObjectStore("collectionParents",{keyPath:Oe});const n=t.store("collectionParents"),r=new ys,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:we(r)})}};return t.store("remoteDocuments").Z({Y:!0},((e,t)=>{const n=new V(e);return i(n.popLast())})).next((()=>t.store("documentMutations").Z({Y:!0},(([e,t,n],r)=>{const s=xe(t);return i(s.popLast())}))))}ri(e){const t=e.store("targets");return t.Z(((e,n)=>{const r=Vi(n),i=Bi(this.serializer,r);return t.put(i)}))}ii(e,t){const n=t.store("remoteDocuments"),r=[];return n.Z(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new U(V.fromString(e.document.name).popFirst(5)):e.noDocument?U.fromSegments(e.noDocument.path):e.unknownDocument?U.fromSegments(e.unknownDocument.path):y()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>re.waitFor(r)))}si(e,t){const n=t.store("mutations"),r=Qs(this.serializer),i=new ho(po.Hr,this.serializer.ct);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Hn();ji(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),re.forEach(n,((e,n)=>{const s=new u(n),o=Qi.lt(this.serializer,s),a=i.getIndexManager(s),c=Ds.lt(s,this.serializer,a,i.referenceDelegate);return new no(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Ke(t,ge.ae),e).next()}))}))}}function yo(e){e.createObjectStore("targetDocuments",{keyPath:Ne}).createIndex("documentTargetsIndex",Le,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ke,{unique:!0}),e.createObjectStore("targetGlobal")}const vo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class wo{constructor(e,t,n,r,i,s,o,a,c,u,l=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=i,this.window=s,this.document=o,this._i=c,this.ai=u,this.ui=l,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=e=>Promise.resolve(),!wo.C())throw new _(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gs(this,r),this.Ti=t+"main",this.serializer=new Oi(a),this.Ei=new se(this.Ti,this.ui,new mo(this.serializer)),this.Qr=new Ps(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Qs(this.serializer),this.$r=new $i,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===u&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,vo);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Qr.getHighestSequenceNumber(e)))})).then((e=>{this.kr=new ge(e,this._i)})).then((()=>{this.qr=!0})).catch((e=>(this.Ei&&this.Ei.close(),Promise.reject(e))))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.k((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget((async()=>{this.started&&await this.Ai()})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>_o(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.gi(e).next((e=>{e||(this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))))}))})).next((()=>this.pi(e))).next((t=>this.isPrimary&&!t?this.yi(e).next((()=>!1)):!!t&&this.wi(e).next((()=>!0)))))).catch((e=>{if(ce(e))return f("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return f("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.oi.enqueueRetryable((()=>this.Ii(e))),this.isPrimary=e}))}gi(e){return bo(e).get("owner").next((e=>re.resolve(this.Si(e))))}bi(e){return _o(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=He(e,"clientMetadata");return t.G().next((e=>{const n=this.vi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return re.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ai().then((()=>this.Di())).then((()=>this.mi()))))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?re.resolve(!0):bo(e).get("owner").next((t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new _(b.FAILED_PRECONDITION,vo);return!1}}return!(!this.networkEnabled||!this.inForeground)||_o(e).G().next((e=>void 0===this.vi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&f("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ke(e,ge.ae);return this.yi(t).next((()=>this.bi(t)))})),this.Ei.close(),this.Bi()}vi(e,t){return e.filter((e=>this.Ci(e.updateTimeMs,t)&&!this.Mi(e.clientId)))}Li(){return this.runTransaction("getActiveClients","readonly",(e=>_o(e).G().next((e=>this.vi(e,18e5).map((e=>e.clientId))))))}get started(){return this.qr}getMutationQueue(e,t){return Ds.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ws(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Qi.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){f("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 15===e?$e:14===e?Ge:13===e?ze:12===e?Ue:11===e?qe:void y()}(this.ui);let s;return this.Ei.runTransaction(e,r,i,(r=>(s=new Ke(r,this.kr?this.kr.next():ge.ae),"readwrite-primary"===t?this.gi(s).next((e=>!!e||this.pi(s))).next((t=>{if(!t)throw p(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))),new _(b.FAILED_PRECONDITION,ee);return n(s)})).next((e=>this.wi(s).next((()=>e)))):this.ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}ki(e){return bo(e).get("owner").next((e=>{if(null!==e&&this.Ci(e.leaseTimestampMs,5e3)&&!this.Mi(e.ownerId)&&!this.Si(e)&&!(this.ai||this.allowTabSynchronization&&e.allowTabSynchronization))throw new _(b.FAILED_PRECONDITION,vo)}))}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bo(e).put("owner",t)}static C(){return se.C()}yi(e){const t=bo(e);return t.get("owner").next((e=>this.Si(e)?(f("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):re.resolve()))}Ci(e,t){const n=Date.now();return!(e<n-t||e>n&&(p(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=()=>{this.oi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai())))},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;o.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return f("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return p("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){p("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bo(e){return He(e,"owner")}function _o(e){return He(e,"clientMetadata")}function xo(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Eo{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=Hn(),r=Hn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Eo(e,t.fromCache,n,r)}}class Io{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class To{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=8}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ji(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Hi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Io;return this.Ji(e,t,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>i.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","SDK will not create cache indexes for query:",Nn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),re.resolve()):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Query:",Nn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(d()<=s.LogLevel.DEBUG&&f("QueryEngine","The SDK decides to create cache indexes for query:",Nn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tn(t))):re.resolve())}ji(e,t){if(xn(t))return re.resolve(null);let n=Tn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=An(t,null,"F"),n=Tn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Hn(...r);return this.zi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Zi(t,r);return this.Xi(t,s,i,n.readTime)?this.ji(e,An(t,null,"F")):this.es(e,s,t,n)}))))})))))}Hi(e,t,n,r){return xn(t)||r.isEqual(F.min())?re.resolve(null):this.zi.getDocuments(e,n).next((i=>{const o=this.Zi(t,i);return this.Xi(t,o,n,r)?re.resolve(null):(d()<=s.LogLevel.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Nn(t)),this.es(e,o,t,X(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new et(Mn(e));return t.forEach(((t,r)=>{Ln(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(e,t,n){return d()<=s.LogLevel.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Nn(t)),this.zi.getDocumentsMatchingQuery(e,t,J.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class So{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new Ye(O),this.rs=new Rn((e=>fn(e)),pn),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new no(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}function Co(e,t,n,r){return new So(e,t,n,r)}async function Ao(e,t){const n=w(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Hn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function Do(e){const t=w(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function ko(e,t,n){let r=Hn(),i=Hn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=jn();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(F.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):f("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:r,ls:i}}))}function No(e,t){const n=w(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Lo(e,t){const n=w(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((i=>i?(r=i,re.resolve(r)):n.Qr.allocateTargetId(e).next((i=>(r=new Li(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}async function Oo(e,t,n){const r=w(e),i=r.ns.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ce(e))throw e;f("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ns=r.ns.remove(t),r.rs.delete(i.target)}function Mo(e,t,n){const r=w(e);let i=F.min(),s=Hn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=w(e),i=r.rs.get(n);return void 0!==i?re.resolve(r.ns.get(i)):r.Qr.getTargetData(t,n)}(r,e,Tn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?i:F.min(),n?s:Hn()))).next((e=>(Fo(r,On(t),e),{documents:e,hs:s})))))}function Po(e,t){const n=w(e),r=w(n.Qr),i=n.ns.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ut(e,t).next((e=>e?e.target:null))))}function Ro(e,t){const n=w(e),r=n.ss.get(t)||F.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.os.getAllFromCollectionGroup(e,t,X(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Fo(n,t,e),e)))}function Fo(e,t,n){let r=e.ss.get(t)||F.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}async function jo(e,t,n=Hn()){const r=await Lo(e,Tn(qi(t.bundledQuery))),i=w(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=ai(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.$r.saveNamedQuery(e,t);const o=r.withResumeToken(st.EMPTY_BYTE_STRING,s);return i.ns=i.ns.insert(o.targetId,o),i.Qr.updateTargetData(e,o).next((()=>i.Qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.$r.saveNamedQuery(e,t)))}))}function Vo(e,t){return`firestore_clients_${e}_${t}`}function Bo(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function qo(e,t){return`firestore_targets_${e}_${t}`}class Uo{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new _(r.error.code,r.error.message))),s?new Uo(e,t,r.state,i):(p("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zo{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new _(n.error.code,n.error.message))),i?new zo(e,n.state,r):(p("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Go{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wn();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=ve(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Go(e,i):(p("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class $o{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new $o(t.clientId,t.onlineState):(p("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Ko{constructor(){this.activeTargetIds=Wn()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ho{constructor(e,t,n,r,i){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ye(O),this.started=!1,this.ys=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ws=Vo(this.persistenceKey,this.Vs),this.Ss=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ko),this.bs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.vs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Fs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Li();for(const t of e){if(t===this.Vs)continue;const e=this.getItem(Vo(this.persistenceKey,t));if(e){const n=Go.Es(t,e);n&&(this.ps=this.ps.insert(n.clientId,n))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const e=this.xs(t);e&&this.Os(e)}for(const e of this.ys)this.gs(e);this.ys=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,t,n){this.Bs(e,t,n),this.Ls(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(qo(this.persistenceKey,e));if(n){const r=zo.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qo(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Ls(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return f("SharedClientState","READ",e,t),t}setItem(e,t){f("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){f("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(f("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.bs.test(t.key)){if(null==t.newValue){const e=this.$s(t.key);return this.Us(e,null)}{const e=this.Ws(t.key,t.newValue);if(e)return this.Us(e.clientId,e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.Gs(t.key,t.newValue);if(e)return this.zs(e)}}else if(this.Cs.test(t.key)){if(null!==t.newValue){const e=this.js(t.key,t.newValue);if(e)return this.Hs(e)}}else if(t.key===this.vs){if(null!==t.newValue){const e=this.xs(t.newValue);if(e)return this.Os(e)}}else if(t.key===this.Ss){const e=function(e){let t=ge.ae;if(null!=e)try{const n=JSON.parse(e);v("number"==typeof n),t=n}catch(e){p("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==ge.ae&&this.sequenceNumberHandler(e)}else if(t.key===this.Fs){const e=this.Js(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Ys(e))))}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,t,n){const r=new Uo(this.currentUser,e,t,n),i=Bo(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ds())}Ls(e){const t=Bo(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){const r=qo(this.persistenceKey,e),i=new zo(e,t,n);this.setItem(r,i.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return Go.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Uo.Es(new u(i),r,t)}js(e,t){const n=this.Cs.exec(e),r=Number(n[1]);return zo.Es(r,t)}xs(e){return $o.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);f("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),i=this.Ns(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.eo(s,o).then((()=>{this.ps=n}))}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Wn();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Qo{constructor(){this.no=new Ko,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ko,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wo{io(e){}shutdown(){}}class Xo{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){f("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){f("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Yo=null;function Jo(){return null===Yo?Yo=268435456+Math.round(2147483648*Math.random()):Yo++,"0x"+Yo.toString(16)}const Zo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ea{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const ta="WebChannelConnection";class na extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(e,t,n,r,i){const s=Jo(),o=this.bo(e,t);f("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(e,o,a,n).then((t=>(f("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw g("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,r,i,s){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+l,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=Zo[e];return`${this.fo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const i=Jo();return new Promise(((s,o)=>{const c=new a.XhrIo;c.setWithCredentials(!0),c.listenOnce(a.EventType.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case a.ErrorCode.NO_ERROR:const t=c.getResponseJson();f(ta,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case a.ErrorCode.TIMEOUT:f(ta,`RPC '${e}' ${i} timed out`),o(new _(b.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:const n=c.getStatus();if(f(ta,`RPC '${e}' ${i} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(t)>=0?t:b.UNKNOWN}(t.status);o(new _(e,t.message))}else o(new _(b.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new _(b.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{f(ta,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(r);f(ta,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,n,15)}))}Fo(e,t,n){const r=Jo(),i=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=a.createWebChannelTransport(),o=a.getStatEventTarget(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const l=i.join("");f(ta,`Creating RPC '${e}' stream ${r}: ${l}`,c);const h=s.createWebChannel(l,c);let d=!1,p=!1;const m=new ea({lo:t=>{p?f(ta,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(f(ta,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),f(ta,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},ho:()=>h.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(h,a.WebChannel.EventType.OPEN,(()=>{p||f(ta,`RPC '${e}' stream ${r} transport opened.`)})),y(h,a.WebChannel.EventType.CLOSE,(()=>{p||(p=!0,f(ta,`RPC '${e}' stream ${r} transport closed`),m.Vo())})),y(h,a.WebChannel.EventType.ERROR,(t=>{p||(p=!0,g(ta,`RPC '${e}' stream ${r} transport errored:`,t),m.Vo(new _(b.UNAVAILABLE,"The operation could not be completed")))})),y(h,a.WebChannel.EventType.MESSAGE,(t=>{var n;if(!p){const i=t.data[0];v(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){f(ta,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Or[e];if(void 0!==t)return Rr(t)}(t),i=o.message;void 0===n&&(n=b.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),p=!0,m.Vo(new _(n,i)),h.close()}else f(ta,`RPC '${e}' stream ${r} received:`,i),m.mo(i)}})),y(o,a.Event.STAT_EVENT,(t=>{t.stat===a.Stat.PROXY?f(ta,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===a.Stat.NOPROXY&&f(ta,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{m.Ro()}),0),m}}function ra(){return"undefined"!=typeof window?window:null}function ia(){return"undefined"!=typeof document?document:null}function sa(e){return new ni(e,!0)}class oa{constructor(e,t,n=1e3,r=1.5,i=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),r=Math.max(0,t-n);r>0&&f("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Lo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class aa{constructor(e,t,n,r,i,s,o,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new oa(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(p(t.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===b.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Wo===t&&this.o_(e,n)}),(t=>{e((()=>{const e=new _(b.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return f("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(f("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ca extends aa{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(v(void 0===t||"string"==typeof t),st.fromBase64String(t||"")):(v(void 0===t||t instanceof Uint8Array),st.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?b.UNKNOWN:Rr(e.code);return new _(t,e.message||"")}(o);n=new Qr(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=hi(e,r.document.name),s=ai(r.document.updateTime),o=r.document.createTime?ai(r.document.createTime):F.min(),a=new Ft({mapValue:{fields:r.document.fields}}),c=Vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Kr(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=hi(e,r.document),s=r.readTime?ai(r.readTime):F.min(),o=Vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Kr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=hi(e,r.document),s=r.removedTargetIds||[];n=new Kr([],s,i,null)}else{if(!("filter"in t))return y();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Lr(r,i),o=e.targetId;n=new Hr(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return F.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?F.min():t.readTime?ai(t.readTime):F.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=pi(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=gn(r)?{documents:bi(e,r)}:{query:_i(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=si(e,t.resumeToken);const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(F.min())>0){n.readTime=ii(e,t.snapshotVersion.toTimestamp());const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return y()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=pi(this.serializer),t.removeTarget=e,this.t_(t)}}class ua extends aa{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(v(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(v(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ai(e.updateTime):ai(t);return n.isEqual(F.min())&&(n=ai(t)),new dr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ai(e.commitTime);return this.listener.T_(n,t)}return v(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=pi(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>vi(this.serializer,e)))};this.t_(t)}}class la extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.So(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}vo(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.vo(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(b.UNKNOWN,e.toString())}))}terminate(){this.A_=!0}}class ha{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(p(t),this.g_=!1):f("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class da{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((e=>{n.enqueueAndForget((async()=>{_a(this)&&(f("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=w(e);t.v_.add(4),await pa(t),t.x_.set("Unknown"),t.v_.delete(4),await fa(t)}(this))}))})),this.x_=new ha(n,r)}}async function fa(e){if(_a(e))for(const t of e.F_)await t(!0)}async function pa(e){for(const t of e.F_)await t(!1)}function ga(e,t){const n=w(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),ba(n)?wa(n):Va(n).Jo()&&ya(n,t))}function ma(e,t){const n=w(e),r=Va(n);n.C_.delete(t),r.Jo()&&va(n,t),0===n.C_.size&&(r.Jo()?r.Xo():_a(n)&&n.x_.set("Unknown"))}function ya(e,t){if(e.O_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(F.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Va(e).c_(t)}function va(e,t){e.O_.Ne(t),Va(e).l_(t)}function wa(e){e.O_=new Xr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ut:t=>e.C_.get(t)||null,rt:()=>e.datastore.serializer.databaseId}),Va(e).start(),e.x_.p_()}function ba(e){return _a(e)&&!Va(e).Ho()&&e.C_.size>0}function _a(e){return 0===w(e).v_.size}function xa(e){e.O_=void 0}async function Ea(e){e.C_.forEach(((t,n)=>{ya(e,t)}))}async function Ia(e,t){xa(e),ba(e)?(e.x_.S_(t),wa(e)):e.x_.set("Unknown")}async function Ta(e,t,n){if(e.x_.set("Online"),t instanceof Qr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){f("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Sa(e,n)}else if(t instanceof Kr?e.O_.Ue(t):t instanceof Hr?e.O_.Ye(t):e.O_.ze(t),!n.isEqual(F.min()))try{const t=await Do(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.O_.st(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.C_.get(r);i&&e.C_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(st.EMPTY_BYTE_STRING,r.snapshotVersion)),va(e,t);const i=new Li(r.target,t,n,r.sequenceNumber);ya(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){f("RemoteStore","Failed to raise snapshot:",t),await Sa(e,t)}}async function Sa(e,t,n){if(!ce(t))throw t;e.v_.add(1),await pa(e),e.x_.set("Offline"),n||(n=()=>Do(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{f("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await fa(e)}))}function Ca(e,t){return t().catch((n=>Sa(e,n,t)))}async function Aa(e){const t=w(e),n=Ba(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;Da(t);)try{const e=await No(t.localStore,r);if(null===e){0===t.D_.length&&n.Xo();break}r=e.batchId,ka(t,e)}catch(e){await Sa(t,e)}Na(t)&&La(t)}function Da(e){return _a(e)&&e.D_.length<10}function ka(e,t){e.D_.push(t);const n=Ba(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Na(e){return _a(e)&&!Ba(e).Ho()&&e.D_.length>0}function La(e){Ba(e).start()}async function Oa(e){Ba(e).d_()}async function Ma(e){const t=Ba(e);for(const n of e.D_)t.I_(n.mutations)}async function Pa(e,t,n){const r=e.D_.shift(),i=Dr.from(r,t,n);await Ca(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Aa(e)}async function Ra(e,t){t&&Ba(e).P_&&await async function(e,t){if(function(e){return Pr(e)&&e!==b.ABORTED}(t.code)){const n=e.D_.shift();Ba(e).Zo(),await Ca(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Aa(e)}}(e,t),Na(e)&&La(e)}async function Fa(e,t){const n=w(e);n.asyncQueue.verifyOperationInProgress(),f("RemoteStore","RemoteStore received new credentials");const r=_a(n);n.v_.add(3),await pa(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await fa(n)}async function ja(e,t){const n=w(e);t?(n.v_.delete(2),await fa(n)):t||(n.v_.add(2),await pa(n),n.x_.set("Unknown"))}function Va(e){return e.N_||(e.N_=function(e,t,n){const r=w(e);return r.R_(),new ca(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Ea.bind(null,e),To:Ia.bind(null,e),u_:Ta.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),ba(e)?wa(e):e.x_.set("Unknown")):(await e.N_.stop(),xa(e))}))),e.N_}function Ba(e){return e.B_||(e.B_=function(e,t,n){const r=w(e);return r.R_(),new ua(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Oa.bind(null,e),To:Ra.bind(null,e),E_:Ma.bind(null,e),T_:Pa.bind(null,e)}),e.F_.push((async t=>{t?(e.B_.Zo(),await Aa(e)):(await e.B_.stop(),e.D_.length>0&&(f("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.B_}class qa{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new x,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new qa(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ua(e,t){if(p("AsyncQueue",`${t}: ${e}`),ce(e))return new _(b.UNAVAILABLE,`${t}: ${e}`);throw e}class za{constructor(e){this.comparator=e?(t,n)=>e(t,n)||U.comparator(t.key,n.key):(e,t)=>U.comparator(e.key,t.key),this.keyedMap=Bn(),this.sortedSet=new Ye(this.comparator)}static emptySet(e){return new za(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof za))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new za;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ga{constructor(){this.L_=new Ye(U.comparator)}track(e){const t=e.doc.key,n=this.L_.get(t);n?0!==e.type&&3===n.type?this.L_=this.L_.insert(t,e):3===e.type&&1!==n.type?this.L_=this.L_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.L_=this.L_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.L_=this.L_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.L_=this.L_.remove(t):1===e.type&&2===n.type?this.L_=this.L_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.L_=this.L_.insert(t,{type:2,doc:e.doc}):y():this.L_=this.L_.insert(t,e)}k_(){const e=[];return this.L_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class $a{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new $a(e,t,za.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Dn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Ka{constructor(){this.q_=void 0,this.listeners=[]}}class Ha{constructor(){this.queries=new Rn((e=>kn(e)),Dn),this.onlineState="Unknown",this.Q_=new Set}}async function Qa(e,t){const n=w(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Ka),i)try{s.q_=await n.onListen(r)}catch(e){const n=Ua(e,`Initialization of query '${Nn(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.K_(n.onlineState),s.q_&&t.U_(s.q_)&&Ja(n)}async function Wa(e,t){const n=w(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function Xa(e,t){const n=w(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.U_(e)&&(r=!0);i.q_=e}}r&&Ja(n)}function Ya(e,t,n){const r=w(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function Ja(e){e.Q_.forEach((e=>{e.next()}))}class Za{constructor(e,t,n){this.query=e,this.W_=t,this.G_=!1,this.z_=null,this.onlineState="Unknown",this.options=n||{}}U_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new $a(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.G_?this.j_(e)&&(this.W_.next(e),t=!0):this.H_(e,this.onlineState)&&(this.J_(e),t=!0),this.z_=e,t}onError(e){this.W_.error(e)}K_(e){this.onlineState=e;let t=!1;return this.z_&&!this.G_&&this.H_(this.z_,e)&&(this.J_(this.z_),t=!0),t}H_(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Y_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}j_(e){if(e.docChanges.length>0)return!0;const t=this.z_&&this.z_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}J_(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.G_=!0,this.W_.next(e)}}class ec{constructor(e,t){this.Z_=e,this.byteLength=t}X_(){return"metadata"in this.Z_}}class tc{constructor(e){this.serializer=e}Ps(e){return hi(this.serializer,e)}Is(e){return e.metadata.exists?yi(this.serializer,e.document,!1):Vt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ai(e)}}class nc{constructor(e,t,n){this.ea=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=rc(e)}ta(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Z_.namedQuery)this.queries.push(e.Z_.namedQuery);else if(e.Z_.documentMetadata){this.documents.push({metadata:e.Z_.documentMetadata}),e.Z_.documentMetadata.exists||++t;const n=V.fromString(e.Z_.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Z_.document&&(this.documents[this.documents.length-1].document=e.Z_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}na(e){const t=new Map,n=new tc(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Ps(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Hn()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=w(e);let s=Hn(),o=jn();for(const e of n){const n=t.Ps(e.metadata.name);e.document&&(s=s.add(n));const r=t.Is(e);r.setReadTime(t.Ts(e.metadata.readTime)),o=o.insert(n,r)}const a=i.os.newChangeBuffer({trackRemovals:!0}),c=await Lo(i,function(e){return Tn(_n(V.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>ko(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Qr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.Qr.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls))).next((()=>t.cs))))))}(this.localStore,new tc(this.serializer),this.documents,this.ea.id),t=this.na(this.documents);for(const e of this.queries)await jo(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,ra:this.collectionGroups,ia:e}}}function rc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ic{constructor(e){this.key=e}}class sc{constructor(e){this.key=e}}class oc{constructor(e,t){this.query=e,this.sa=t,this.oa=null,this.hasCachedResults=!1,this.current=!1,this._a=Hn(),this.mutatedKeys=Hn(),this.aa=Mn(e),this.ua=new za(this.aa)}get ca(){return this.sa}la(e,t){const n=t?t.ha:new Ga,r=t?t.ua:this.ua;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=Ln(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Pa(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.aa(l,a)>0||c&&this.aa(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ua:s,ha:n,Xi:o,mutatedKeys:i}}Pa(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ua;this.ua=e.ua,this.mutatedKeys=e.mutatedKeys;const i=e.ha.k_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||this.aa(e.doc,t.doc))),this.Ia(n);const s=t?this.Ta():[],o=0===this._a.size&&this.current?1:0,a=o!==this.oa;return this.oa=o,0!==i.length||a?{snapshot:new $a(this.query,e.ua,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ea:s}:{Ea:s}}K_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ua:this.ua,ha:new Ga,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Ea:[]}}da(e){return!this.sa.has(e)&&!!this.ua.has(e)&&!this.ua.get(e).hasLocalMutations}Ia(e){e&&(e.addedDocuments.forEach((e=>this.sa=this.sa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.sa=this.sa.delete(e))),this.current=e.current)}Ta(){if(!this.current)return[];const e=this._a;this._a=Hn(),this.ua.forEach((e=>{this.da(e.key)&&(this._a=this._a.add(e.key))}));const t=[];return e.forEach((e=>{this._a.has(e)||t.push(new sc(e))})),this._a.forEach((n=>{e.has(n)||t.push(new ic(n))})),t}Aa(e){this.sa=e.hs,this._a=Hn();const t=this.la(e.documents);return this.applyChanges(t,!0)}Ra(){return $a.fromInitialDocuments(this.query,this.ua,this.mutatedKeys,0===this.oa,this.hasCachedResults)}}class ac{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class cc{constructor(e){this.key=e,this.Va=!1}}class uc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.ma={},this.fa=new Rn((e=>kn(e)),Dn),this.ga=new Map,this.pa=new Set,this.ya=new Ye(U.comparator),this.wa=new Map,this.Sa=new so,this.ba={},this.Da=new Map,this.Ca=Ms.Bn(),this.onlineState="Unknown",this.va=void 0}get isPrimaryClient(){return!0===this.va}}async function lc(e,t){const n=Rc(e);let r,i;const s=n.fa.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ra();else{const e=await Lo(n.localStore,Tn(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await hc(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&ga(n.remoteStore,e)}return i}async function hc(e,t,n,r,i){e.Fa=(t,n,r)=>async function(e,t,n,r){let i=t.view.la(n);i.Xi&&(i=await Mo(e.localStore,t.query,!1).then((({documents:e})=>t.view.la(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return xc(e,t.targetId,o.Ea),o.snapshot}(e,t,n,r);const s=await Mo(e.localStore,t,!0),o=new oc(t,s.hs),a=o.la(s.documents),c=$r.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);xc(e,n,u.Ea);const l=new ac(t,n,o);return e.fa.set(t,l),e.ga.has(n)?e.ga.get(n).push(t):e.ga.set(n,[t]),u.snapshot}async function dc(e,t){const n=w(e),r=n.fa.get(t),i=n.ga.get(r.targetId);if(i.length>1)return n.ga.set(r.targetId,i.filter((e=>!Dn(e,t)))),void n.fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Oo(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),ma(n.remoteStore,r.targetId),bc(n,r.targetId)})).catch(ne)):(bc(n,r.targetId),await Oo(n.localStore,r.targetId,!0))}async function fc(e,t){const n=w(e);try{const e=await function(e,t){const n=w(e),r=t.snapshotVersion;let i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(st.EMPTY_BYTE_STRING,F.min()).withLastLimboFreeSnapshotVersion(F.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Qr.updateTargetData(e,u))}));let a=jn(),c=Hn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(ko(e,s,t.documentUpdates).next((e=>{a=e.cs,c=e.ls}))),!r.isEqual(F.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return re.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ns=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.wa.get(t);r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Va=!0:e.modifiedDocuments.size>0?v(r.Va):e.removedDocuments.size>0&&(v(r.Va),r.Va=!1))})),await Tc(n,e,t)}catch(e){await ne(e)}}function pc(e,t,n){const r=w(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.fa.forEach(((n,r)=>{const i=r.view.K_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=w(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.K_(t)&&(r=!0)})),r&&Ja(n)}(r.eventManager,t),e.length&&r.ma.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function gc(e,t,n){const r=w(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.wa.get(t),s=i&&i.key;if(s){let e=new Ye(U.comparator);e=e.insert(s,Vt.newNoDocument(s,F.min()));const n=Hn().add(s),i=new Gr(F.min(),new Map,new Ye(O),e,n);await fc(r,i),r.ya=r.ya.remove(s),r.wa.delete(t),Ic(r)}else await Oo(r.localStore,t,!1).then((()=>bc(r,t,n))).catch(ne)}async function mc(e,t){const n=w(e),r=t.batch.batchId;try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=re.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);v(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Hn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);wc(n,r,null),vc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Tc(n,e)}catch(e){await ne(e)}}async function yc(e,t,n){const r=w(e);try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(v(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);wc(r,t,n),vc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Tc(r,e)}catch(n){await ne(n)}}function vc(e,t){(e.Da.get(t)||[]).forEach((e=>{e.resolve()})),e.Da.delete(t)}function wc(e,t,n){const r=w(e);let i=r.ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.ba[r.currentUser.toKey()]=i}}function bc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ga.get(t))e.fa.delete(r),n&&e.ma.Ma(r,n);e.ga.delete(t),e.isPrimaryClient&&e.Sa.Vr(t).forEach((t=>{e.Sa.containsKey(t)||_c(e,t)}))}function _c(e,t){e.pa.delete(t.path.canonicalString());const n=e.ya.get(t);null!==n&&(ma(e.remoteStore,n),e.ya=e.ya.remove(t),e.wa.delete(n),Ic(e))}function xc(e,t,n){for(const r of n)r instanceof ic?(e.Sa.addReference(r.key,t),Ec(e,r)):r instanceof sc?(f("SyncEngine","Document no longer in limbo: "+r.key),e.Sa.removeReference(r.key,t),e.Sa.containsKey(r.key)||_c(e,r.key)):y()}function Ec(e,t){const n=t.key,r=n.path.canonicalString();e.ya.get(n)||e.pa.has(r)||(f("SyncEngine","New document in limbo: "+n),e.pa.add(r),Ic(e))}function Ic(e){for(;e.pa.size>0&&e.ya.size<e.maxConcurrentLimboResolutions;){const t=e.pa.values().next().value;e.pa.delete(t);const n=new U(V.fromString(t)),r=e.Ca.next();e.wa.set(r,new cc(n)),e.ya=e.ya.insert(n,r),ga(e.remoteStore,new Li(Tn(_n(n.path)),r,"TargetPurposeLimboResolution",ge.ae))}}async function Tc(e,t,n){const r=w(e),i=[],s=[],o=[];r.fa.isEmpty()||(r.fa.forEach(((e,a)=>{o.push(r.Fa(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Eo.Ki(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.ma.u_(i),await async function(e,t){const n=w(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>re.forEach(t,(t=>re.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>re.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ce(e))throw e;f("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ns.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(t,i)}}}(r.localStore,s))}async function Sc(e,t){const n=w(e);if(!n.currentUser.isEqual(t)){f("SyncEngine","User change. New user:",t.toKey());const e=await Ao(n.localStore,t);n.currentUser=t,function(e,t){e.Da.forEach((e=>{e.forEach((e=>{e.reject(new _(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Da.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Tc(n,e.us)}}function Cc(e,t){const n=w(e),r=n.wa.get(t);if(r&&r.Va)return Hn().add(r.key);{let e=Hn();const r=n.ga.get(t);if(!r)return e;for(const t of r){const r=n.fa.get(t);e=e.unionWith(r.view.ca)}return e}}async function Ac(e,t){const n=w(e),r=await Mo(n.localStore,t.query,!0),i=t.view.Aa(r);return n.isPrimaryClient&&xc(n,t.targetId,i.Ea),i}async function Dc(e,t){const n=w(e);return Ro(n.localStore,t).then((e=>Tc(n,e)))}async function kc(e,t,n,r){const i=w(e),s=await function(e,t){const n=w(e),r=w(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.vn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):re.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Aa(i.remoteStore):"acknowledged"===n||"rejected"===n?(wc(i,t,r||null),vc(i,t),function(e,t){w(w(e).mutationQueue).Mn(t)}(i.localStore,t)):y(),await Tc(i,s)):f("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Nc(e,t,n){const r=w(e),i=[],s=[];for(const e of t){let t;const n=r.ga.get(e);if(n&&0!==n.length){t=await Lo(r.localStore,Tn(n[0]));for(const e of n){const t=r.fa.get(e),n=await Ac(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await Po(r.localStore,e);t=await Lo(r.localStore,n),await hc(r,Lc(n),e,!1,t.resumeToken)}i.push(t)}return r.ma.u_(s),i}function Lc(e){return bn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Oc(e){return function(e){return w(w(e).persistence).Li()}(w(e).localStore)}async function Mc(e,t,n,r){const i=w(e);if(i.va)return void f("SyncEngine","Ignoring unexpected query state notification.");const s=i.ga.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await Ro(i.localStore,On(s[0])),r=Gr.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,st.EMPTY_BYTE_STRING);await Tc(i,e,r);break}case"rejected":await Oo(i.localStore,t,!0),bc(i,t,r);break;default:y()}}async function Pc(e,t,n){const r=Rc(e);if(r.va){for(const e of t){if(r.ga.has(e)){f("SyncEngine","Adding an already active target "+e);continue}const t=await Po(r.localStore,e),n=await Lo(r.localStore,t);await hc(r,Lc(t),n.targetId,!1,n.resumeToken),ga(r.remoteStore,n)}for(const e of n)r.ga.has(e)&&await Oo(r.localStore,e,!1).then((()=>{ma(r.remoteStore,e),bc(r,e)})).catch(ne)}}function Rc(e){const t=w(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Cc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gc.bind(null,t),t.ma.u_=Xa.bind(null,t.eventManager),t.ma.Ma=Ya.bind(null,t.eventManager),t}function Fc(e){const t=w(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=mc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yc.bind(null,t),t}class jc{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=sa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Co(this.persistence,new To,e.initialUser,this.serializer)}createPersistence(e){return new ho(po.Hr,this.serializer)}createSharedClientState(e){return new Qo}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Vc extends jc{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){v(this.persistence.referenceDelegate instanceof go);const n=this.persistence.referenceDelegate.garbageCollector;return new qs(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?Ss.withCacheSize(this.cacheSizeBytes):Ss.DEFAULT;return new ho((e=>go.Hr(e,t)),this.serializer)}}class Bc extends jc{constructor(e,t,n){super(),this.Oa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Oa.initialize(this,e),await Fc(this.Oa.syncEngine),await Aa(this.Oa.remoteStore),await this.persistence.fi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return Co(this.persistence,new To,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new qs(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new pe(t,this.persistence);return new fe(e.asyncQueue,n)}createPersistence(e){const t=xo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ss.withCacheSize(this.cacheSizeBytes):Ss.DEFAULT;return new wo(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,ra(),ia(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Qo}}class qc extends Bc{constructor(e,t){super(e,t,!1),this.Oa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Oa.syncEngine;this.sharedClientState instanceof Ho&&(this.sharedClientState.syncEngine={Zs:kc.bind(null,t),Xs:Mc.bind(null,t),eo:Pc.bind(null,t),Li:Oc.bind(null,t),Ys:Dc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi((async e=>{await async function(e,t){const n=w(e);if(Rc(n),Fc(n),!0===t&&!0!==n.va){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Nc(n,e.toArray());n.va=!0,await ja(n.remoteStore,!0);for(const e of t)ga(n.remoteStore,e)}else if(!1===t&&!1!==n.va){const e=[];let t=Promise.resolve();n.ga.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(bc(n,i),Oo(n.localStore,i,!0)))),ma(n.remoteStore,i)})),await t,await Nc(n,e),function(e){const t=w(e);t.wa.forEach(((e,n)=>{ma(t.remoteStore,n)})),t.Sa.mr(),t.wa=new Map,t.ya=new Ye(U.comparator)}(n),n.va=!1,await ja(n.remoteStore,!1)}}(this.Oa.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=ra();if(!Ho.C(t))throw new _(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=xo(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ho(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Uc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>pc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sc.bind(null,this.syncEngine),await ja(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ha}createDatastore(e){const t=sa(e.databaseInfo.databaseId),n=function(e){return new na(e)}(e.databaseInfo);return function(e,t,n,r){return new la(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new da(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>pc(this.syncEngine,e,0)),Xo.C()?new Xo:new Wo)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uc(e,t,n,r,i,s);return o&&(a.va=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=w(e);f("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await pa(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore)}}function zc(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Gc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Na(this.observer.next,e)}error(e){this.observer.error?this.Na(this.observer.error,e):p("Uncaught Error in snapshot listener:",e.toString())}Ba(){this.muted=!0}Na(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class $c{constructor(e,t){this.La=e,this.serializer=t,this.metadata=new x,this.buffer=new Uint8Array,this.ka=new TextDecoder("utf-8"),this.qa().then((e=>{e&&e.X_()?this.metadata.resolve(e.Z_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.Z_)}`))}),(e=>this.metadata.reject(e)))}close(){return this.La.cancel()}async getMetadata(){return this.metadata.promise}async xa(){return await this.getMetadata(),this.qa()}async qa(){const e=await this.Qa();if(null===e)return null;const t=this.ka.decode(e),n=Number(t);isNaN(n)&&this.Ka(`length string (${t}) is not valid number`);const r=await this.$a(n);return new ec(JSON.parse(r),e.length+n)}Ua(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Qa(){for(;this.Ua()<0&&!await this.Wa(););if(0===this.buffer.length)return null;const e=this.Ua();e<0&&this.Ka("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $a(e){for(;this.buffer.length<e;)await this.Wa()&&this.Ka("Reached the end of bundle when more is expected.");const t=this.ka.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Ka(e){throw this.La.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wa(){const e=await this.La.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Kc{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new _(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=w(e),r=pi(n.serializer)+"/documents",i={documents:t.map((e=>li(n.serializer,e)))},s=await n.vo("BatchGetDocuments",r,i,t.length),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){v(!!t.found),t.found.name,t.found.updateTime;const n=hi(e,t.found.name),r=ai(t.found.updateTime),i=t.found.createTime?ai(t.found.createTime):F.min(),s=new Ft({mapValue:{fields:t.found.fields}});return Vt.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){v(!!t.missing),v(!!t.readTime);const n=hi(e,t.missing),r=ai(t.readTime);return Vt.newNoDocument(n,r)}(e,t):y()}(n.serializer,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());v(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Sr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=U.fromPath(t);this.mutations.push(new Cr(n,this.precondition(n)))})),await async function(e,t){const n=w(e),r=pi(n.serializer)+"/documents",i={writes:t.map((e=>vi(n.serializer,e)))};await n.So("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw y();t=F.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new _(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(F.min())?fr.exists(!1):fr.updateTime(t):fr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(F.min()))throw new _(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fr.updateTime(t)}return fr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Hc{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Ga=n.maxAttempts,this.jo=new oa(this.asyncQueue,"transaction_retry")}run(){this.Ga-=1,this.za()}za(){this.jo.qo((async()=>{const e=new Kc(this.datastore),t=this.ja(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.Ha(e)}))))})).catch((e=>{this.Ha(e)}))}))}ja(e){try{const t=this.updateFunction(e);return!me(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Ha(e){this.Ga>0&&this.Ja(e)?(this.Ga-=1,this.asyncQueue.enqueueAndForget((()=>(this.za(),Promise.resolve())))):this.deferred.reject(e)}Ja(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Pr(t)}return!1}}class Qc{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=u.UNAUTHENTICATED,this.clientId=L.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{f("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(f("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new x;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ua(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Wc(e,t){e.asyncQueue.verifyOperationInProgress(),f("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Ao(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Xc(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Jc(e);f("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>Fa(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Fa(t.remoteStore,n))),e._onlineComponents=t}function Yc(e){return"FirebaseError"===e.name?e.code===b.FAILED_PRECONDITION||e.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function Jc(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){f("FirestoreClient","Using user provided OfflineComponentProvider");try{await Wc(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!Yc(n))throw n;g("Error using user provided cache. Falling back to memory cache: "+n),await Wc(e,new jc)}}else f("FirestoreClient","Using default OfflineComponentProvider"),await Wc(e,new jc);return e._offlineComponents}async function Zc(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(f("FirestoreClient","Using user provided OnlineComponentProvider"),await Xc(e,e._uninitializedComponentsProvider._online)):(f("FirestoreClient","Using default OnlineComponentProvider"),await Xc(e,new Uc))),e._onlineComponents}function eu(e){return Jc(e).then((e=>e.persistence))}function tu(e){return Jc(e).then((e=>e.localStore))}function nu(e){return Zc(e).then((e=>e.remoteStore))}function ru(e){return Zc(e).then((e=>e.syncEngine))}function iu(e){return Zc(e).then((e=>e.datastore))}async function su(e){const t=await Zc(e),n=t.eventManager;return n.onListen=lc.bind(null,t.syncEngine),n.onUnlisten=dc.bind(null,t.syncEngine),n}function ou(e,t,n={}){const r=new x;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Gc({next:s=>{t.enqueueAndForget((()=>Wa(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new _(b.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new Za(_n(n.path),s,{includeMetadataChanges:!0,Y_:!0});return Qa(e,o)}(await su(e),e.asyncQueue,t,n,r))),r.promise}function au(e,t,n={}){const r=new x;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Gc({next:n=>{t.enqueueAndForget((()=>Wa(e,o))),n.fromCache&&"server"===r.source?i.reject(new _(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Za(n,s,{includeMetadataChanges:!0,Y_:!0});return Qa(e,o)}(await su(e),e.asyncQueue,t,n,r))),r.promise}function cu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const uu=new Map;function lu(e,t,n){if(!n)throw new _(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function hu(e,t,n,r){if(!0===t&&!0===r)throw new _(b.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function du(e){if(!U.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function fu(e){if(U.isDocumentKey(e))throw new _(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function pu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":y()}function gu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=pu(e);throw new _(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function mu(e,t){if(t<=0)throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class yu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new _(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hu("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new _(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yu(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new I;switch(e.type){case"firstParty":return new A(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new _(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=uu.get(e);t&&(f("ComponentProvider","Removing Datastore"),uu.delete(e),t.terminate())}(this),Promise.resolve()}}function wu(e,t,n,r={}){var i;const s=(e=gu(e,vu))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&g("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=u.MOCK_USER;else{t=o.createMockUserToken(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new _(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(s)}e._authCredentials=new T(new E(t,n))}}class bu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bu(this.firestore,e,this._query)}}class _u{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _u(this.firestore,e,this._key)}}class xu extends bu{constructor(e,t,n){super(e,t,_n(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _u(this.firestore,null,new U(e))}withConverter(e){return new xu(this.firestore,e,this._path)}}function Eu(e,t,...n){if(e=o.getModularInstance(e),1===arguments.length&&(t=L.V()),lu("doc","path",t),e instanceof vu){const r=V.fromString(t,...n);return du(r),new _u(e,null,new U(r))}{if(!(e instanceof _u||e instanceof xu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return du(r),new _u(e.firestore,e instanceof xu?e.converter:null,new U(r))}}function Iu(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),e instanceof bu&&t instanceof bu&&e.firestore===t.firestore&&Dn(e._query,t._query)&&e.converter===t.converter}class Tu{constructor(){this.Ya=Promise.resolve(),this.Za=[],this.Xa=!1,this.eu=[],this.tu=null,this.nu=!1,this.ru=!1,this.iu=[],this.jo=new oa(this,"async_queue_retry"),this.su=()=>{const e=ia();e&&f("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=ia();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.su)}get isShuttingDown(){return this.Xa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ou(),this._u(e)}enterRestrictedMode(e){if(!this.Xa){this.Xa=!0,this.ru=e||!1;const t=ia();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.su)}}enqueue(e){if(this.ou(),this.Xa)return new Promise((()=>{}));const t=new x;return this._u((()=>this.Xa&&this.ru?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Za.push(e),this.au())))}async au(){if(0!==this.Za.length){try{await this.Za[0](),this.Za.shift(),this.jo.reset()}catch(e){if(!ce(e))throw e;f("AsyncQueue","Operation failed with retryable error: "+e)}this.Za.length>0&&this.jo.qo((()=>this.au()))}}_u(e){const t=this.Ya.then((()=>(this.nu=!0,e().catch((e=>{this.tu=e,this.nu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw p("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.nu=!1,e))))));return this.Ya=t,t}enqueueAfterDelay(e,t,n){this.ou(),this.iu.indexOf(e)>-1&&(t=0);const r=qa.createAndSchedule(this,e,t,n,(e=>this.uu(e)));return this.eu.push(r),r}ou(){this.tu&&y()}verifyOperationInProgress(){}async cu(){let e;do{e=this.Ya,await e}while(e!==this.Ya)}lu(e){for(const t of this.eu)if(t.timerId===e)return!0;return!1}hu(e){return this.cu().then((()=>{this.eu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.eu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.cu()}))}Pu(e){this.iu.push(e)}uu(e){const t=this.eu.indexOf(e);this.eu.splice(t,1)}}function Su(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Cu{constructor(){this._progressObserver={},this._taskCompletionResolver=new x,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Au extends vu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Tu,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ku(this),this._firestoreClient.terminate()}}function Du(e){return e._firestoreClient||ku(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ku(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new ft(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,cu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Qc(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Nu(e,t,n){const r=new x;return e.asyncQueue.enqueue((async()=>{try{await Wc(e,n),await Xc(e,t),r.resolve()}catch(e){const t=e;if(!Yc(t))throw t;g("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function Lu(e){if(e._initialized||e._terminated)throw new _(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Ou{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Mu{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Pu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pu(st.fromBase64String(e))}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Pu(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ru{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new _(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new q(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fu{constructor(e){this._methodName=e}}class ju{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return O(this._lat,e._lat)||O(this._long,e._long)}}const Vu=/^__.*__$/;class Bu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new xr(e,this.data,this.fieldMask,t,this.fieldTransforms):new _r(e,this.data,t,this.fieldTransforms)}}class qu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new xr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Uu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}class zu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Iu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Tu(){return this.settings.Tu}Eu(e){return new zu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}du(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Eu({path:n,Au:!1});return r.Ru(e),r}Vu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Eu({path:n,Au:!1});return r.Iu(),r}mu(e){return this.Eu({path:void 0,Au:!0})}fu(e){return ul(e,this.settings.methodName,this.settings.gu||!1,this.path,this.settings.pu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Iu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ru(this.path.get(e))}Ru(e){if(0===e.length)throw this.fu("Document fields must not be empty");if(Uu(this.Tu)&&Vu.test(e))throw this.fu('Document fields cannot begin and end with "__"')}}class Gu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sa(e)}yu(e,t,n,r=!1){return new zu({Tu:e,methodName:t,pu:n,path:q.emptyPath(),Au:!1,gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $u(e){const t=e._freezeSettings(),n=sa(e._databaseId);return new Gu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ku(e,t,n,r,i,s={}){const o=e.yu(s.merge||s.mergeFields?2:0,t,n,i);sl("Data must be an object, but it was:",o,r);const a=rl(r,o);let c,u;if(s.merge)c=new rt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=ol(t,r,n);if(!o.contains(i))throw new _(b.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);ll(e,i)||e.push(i)}c=new rt(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Bu(new Ft(a),c,u)}class Hu extends Fu{_toFieldTransform(e){if(2!==e.Tu)throw 1===e.Tu?e.fu(`${this._methodName}() can only appear at the top level of your update data`):e.fu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hu}}function Qu(e,t,n){return new zu({Tu:3,pu:t.settings.pu,methodName:e._methodName,Au:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Wu extends Fu{_toFieldTransform(e){return new hr(e.path,new rr)}isEqual(e){return e instanceof Wu}}class Xu extends Fu{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=Qu(this,e,!0),n=this.wu.map((e=>nl(e,t))),r=new ir(n);return new hr(e.path,r)}isEqual(e){return this===e}}class Yu extends Fu{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=Qu(this,e,!0),n=this.wu.map((e=>nl(e,t))),r=new or(n);return new hr(e.path,r)}isEqual(e){return this===e}}class Ju extends Fu{constructor(e,t){super(e),this.Su=t}_toFieldTransform(e){const t=new cr(e.serializer,Jn(e.serializer,this.Su));return new hr(e.path,t)}isEqual(e){return this===e}}function Zu(e,t,n,r){const i=e.yu(1,t,n);sl("Data must be an object, but it was:",i,r);const s=[],a=Ft.empty();We(r,((e,r)=>{const c=cl(t,e,n);r=o.getModularInstance(r);const u=i.Vu(c);if(r instanceof Hu)s.push(c);else{const e=nl(r,u);null!=e&&(s.push(c),a.set(c,e))}}));const c=new rt(s);return new qu(a,c,i.fieldTransforms)}function el(e,t,n,r,i,s){const a=e.yu(1,t,n),c=[ol(t,r,n)],u=[i];if(s.length%2!=0)throw new _(b.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)c.push(ol(t,s[e])),u.push(s[e+1]);const l=[],h=Ft.empty();for(let e=c.length-1;e>=0;--e)if(!ll(l,c[e])){const t=c[e];let n=u[e];n=o.getModularInstance(n);const r=a.Vu(t);if(n instanceof Hu)l.push(t);else{const e=nl(n,r);null!=e&&(l.push(t),h.set(t,e))}}const d=new rt(l);return new qu(h,d,a.fieldTransforms)}function tl(e,t,n,r=!1){return nl(n,e.yu(r?4:3,t))}function nl(e,t){if(il(e=o.getModularInstance(e)))return sl("Unsupported field value:",t,e),rl(e,t);if(e instanceof Fu)return function(e,t){if(!Uu(t.Tu))throw t.fu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.fu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Au&&4!==t.Tu)throw t.fu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=nl(i,t.mu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=o.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Jn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=R.fromDate(e);return{timestampValue:ii(t.serializer,n)}}if(e instanceof R){const n=new R(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ii(t.serializer,n)}}if(e instanceof ju)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Pu)return{bytesValue:si(t.serializer,e._byteString)};if(e instanceof _u){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.fu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ci(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.fu(`Unsupported field value: ${pu(e)}`)}(e,t)}function rl(e,t){const n={};return Xe(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):We(e,((e,r)=>{const i=nl(r,t.du(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function il(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof R||e instanceof ju||e instanceof Pu||e instanceof _u||e instanceof Fu)}function sl(e,t,n){if(!il(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=pu(n);throw"an object"===r?t.fu(e+" a custom object"):t.fu(e+" "+r)}}function ol(e,t,n){if((t=o.getModularInstance(t))instanceof Ru)return t._internalPath;if("string"==typeof t)return cl(e,t);throw ul("Field path arguments must be of type string or ",e,!1,void 0,n)}const al=new RegExp("[~\\*/\\[\\]]");function cl(e,t,n){if(t.search(al)>=0)throw ul(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ru(...t.split("."))._internalPath}catch(r){throw ul(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ul(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new _(b.INVALID_ARGUMENT,a+e+c)}function ll(e,t){return e.some((e=>e.isEqual(t)))}class hl{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _u(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new dl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class dl extends hl{data(){return super.data()}}function fl(e,t){return"string"==typeof t?cl(e,t):t instanceof Ru?t._internalPath:t._delegate._internalPath}function pl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new _(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gl{}class ml extends gl{}class yl extends ml{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yl(e,t,n)}_apply(e){const t=this._parse(e);return Sl(e._query,t),new bu(e.firestore,e.converter,Cn(e._query,t))}_parse(e){const t=$u(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new _(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Tl(o,s);const t=[];for(const n of o)t.push(Il(r,e,n));a={arrayValue:{values:t}}}else a=Il(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Tl(o,s),a=tl(n,"where",o,"in"===s||"not-in"===s);return Kt.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class vl extends gl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vl(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Sl(n,e),n=Cn(n,e)}(e._query,t),new bu(e.firestore,e.converter,Cn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class wl extends ml{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zt(t,n)}(e._query,this._field,this._direction);return new bu(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new wn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class bl extends ml{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new bl(e,t,n)}_apply(e){return new bu(e.firestore,e.converter,An(e._query,this._limit,this._limitType))}}class _l extends ml{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new _l(e,t,n)}_apply(e){const t=El(e,this.type,this._docOrFields,this._inclusive);return new bu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class xl extends ml{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new xl(e,t,n)}_apply(e){const t=El(e,this.type,this._docOrFields,this._inclusive);return new bu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function El(e,t,n,r){if(n[0]=o.getModularInstance(n[0]),n[0]instanceof hl)return function(e,t,n,r,i){if(!r)throw new _(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of In(e))if(n.field.isKeyField())s.push(Tt(t,r.key));else{const e=r.data.field(n.field);if(lt(e))throw new _(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new _(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Bt(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=$u(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new _(b.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new _(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!En(e)&&-1!==c.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(V.fromString(c));if(!U.isDocumentKey(n))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new U(n);a.push(Tt(t,i))}else{const e=tl(n,r,c);a.push(e)}}return new Bt(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Il(e,t,n){if("string"==typeof(n=o.getModularInstance(n))){if(""===n)throw new _(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!En(t)&&-1!==n.indexOf("/"))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(V.fromString(n));if(!U.isDocumentKey(r))throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tt(e,new U(r))}if(n instanceof _u)return Tt(e,n._key);throw new _(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pu(n)}.`)}function Tl(e,t){if(!Array.isArray(e)||0===e.length)throw new _(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Sl(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Cl(e,t){if(!(t instanceof yl||t instanceof vl))throw new _(b.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Al{convertValue(e,t="none"){switch(yt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ut(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return We(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new ju(ct(e.latitude),ct(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ht(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dt(e));default:return null}}convertTimestamp(e){const t=at(e);return new R(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=V.fromString(e);v(Ni(n));const r=new pt(n.get(1),n.get(3)),i=new U(n.popFirst(5));return r.isEqual(t)||p(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Dl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class kl extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _u(this.firestore,null,t)}}function Nl(){return new Ou("count")}class Ll{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ol extends hl{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ml(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(fl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ml extends Ol{data(e={}){return super.data(e)}}class Pl{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ll(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Ml(this._firestore,this._userDataWriter,n.key,n,new Ll(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Ml(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ll(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Ml(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ll(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Rl(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Rl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}class Fl extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _u(this.firestore,null,t)}}function jl(e,t){return function(e,t){const n=new x;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Fc(e);try{const e=await function(e,t){const n=w(e),r=R.now(),i=t.reduce(((e,t)=>e.add(t.key)),Hn());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=jn(),c=Hn();return n.os.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=wr(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new xr(e.key,t,jt(t.value.mapValue),fr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:qn(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.ba[e.currentUser.toKey()];r||(r=new Ye(O)),r=r.insert(t,n),e.ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Tc(r,e.changes),await Aa(r.remoteStore)}catch(e){const t=Ua(e,"Failed to persist write");n.reject(t)}}(await ru(e),t,n))),n.promise}(Du(e),t)}function Vl(e,t,n){const r=n.docs.get(t._key),i=new Fl(e);return new Ol(e,i,t._key,r,new Ll(n.hasPendingWrites,n.fromCache),t.converter)}function Bl(e,t){const n=gu(e.firestore,Au),r=Du(n),i=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,((e,t)=>new Nr(t,e.aggregateType,e._internalFieldPath)));return function(e,t,n){const r=new x;return e.asyncQueue.enqueueAndForget((async()=>{try{const i=await iu(e);r.resolve(async function(e,t,n){var r;const i=w(e),{request:s,V_:o}=function(e,t,n){const r=_i(e,t),i={},s=[];let o=0;return n.forEach((e=>{const t="aggregate_"+o++;i[t]=e.alias,"count"===e.aggregateType?s.push({alias:t,count:{}}):"avg"===e.aggregateType?s.push({alias:t,avg:{field:Ci(e.fieldPath)}}):"sum"===e.aggregateType&&s.push({alias:t,sum:{field:Ci(e.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:r.structuredQuery},parent:r.parent},V_:i}}(i.serializer,function(e){const t=w(e);return t.Ie||(t.Ie=Sn(t,e.explicitOrderBy)),t.Ie}(t),n),a=s.parent;i.connection.wo||delete s.parent;const c=(await i.vo("RunAggregationQuery",a,s,1)).filter((e=>!!e.result));v(1===c.length);const u=null===(r=c[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce(((e,t)=>(e[o[t]]=u[t],e)),{})}(i,t,n))}catch(e){r.reject(e)}})),r.promise}(r,e._query,i).then((t=>function(e,t,n){const r=new Fl(e);return new Mu(t,r,n)}(n,e,t)))}class ql{constructor(e){this.kind="memory",this._onlineComponentProvider=new Uc,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new jc}toJSON(){return{kind:this.kind}}}class Ul{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=Hl(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class zl{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new jc}toJSON(){return{kind:this.kind}}}class Gl{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new Vc(e)}toJSON(){return{kind:this.kind}}}class $l{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Uc,this._offlineComponentProvider=new Bc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class Kl{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new Uc,this._offlineComponentProvider=new qc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function Hl(e){return new $l(null==e?void 0:e.forceOwnership)}const Ql={maxAttempts:5};class Wl{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$u(e)}set(e,t,n){this._verifyNotCommitted();const r=Xl(e,this._firestore),i=Dl(r.converter,t,n),s=Ku(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,fr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=Xl(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(this._dataReader,"WriteBatch.update",i._key,t,n,r):Zu(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,fr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Xl(e,this._firestore);return this._mutations=this._mutations.concat(new Sr(t._key,fr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Xl(e,t){if((e=o.getModularInstance(e)).firestore!==t)throw new _(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Yl extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$u(e)}get(e){const t=Xl(e,this._firestore),n=new kl(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return y();const r=e[0];if(r.isFoundDocument())return new hl(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new hl(this._firestore,n,t._key,null,t.converter);throw y()}))}set(e,t,n){const r=Xl(e,this._firestore),i=Dl(r.converter,t,n),s=Ku(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=Xl(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(this._dataReader,"Transaction.update",i._key,t,n,r):Zu(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=Xl(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Xl(e,this._firestore),n=new Fl(this._firestore);return super.get(e).then((e=>new Ol(this._firestore,n,t._key,e._document,new Ll(!1,!1),t.converter)))}}function Jl(e,t){if("string"!=typeof e[t])throw new _(b.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class Zl{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}}function eh(e,t){e._client.verifyNotTerminated(),function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){w(e).ts.Ui=t}(await tu(e),t)))}(e._client,t).then((e=>f(`setting persistent cache index auto creation isEnabled=${t} succeeded`))).catch((e=>g(`setting persistent cache index auto creation isEnabled=${t} failed`,e)))}const th=new WeakMap;class nh{constructor(){this.bu=new Map}static get instance(){return rh||(rh=new nh,function(e){if(Fr)throw new Error("a TestingHooksSpi instance is already set");Fr=e}(rh)),rh}nt(e){this.bu.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.bu;return n.set(t,e),()=>n.delete(t)}}let rh=null;!function(e,t=!0){!function(e){l=e}(r.SDK_VERSION),r._registerComponent(new i.Component("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new Au(new S(e.getProvider("auth-internal")),new k(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pt(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),r.registerVersion(c,"4.3.0",e),r.registerVersion(c,"4.3.0","cjs2017")}(),t.AbstractUserDataWriter=Al,t.AggregateField=Ou,t.AggregateQuerySnapshot=Mu,t.Bytes=Pu,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=xu,t.DocumentReference=_u,t.DocumentSnapshot=Ol,t.FieldPath=Ru,t.FieldValue=Fu,t.Firestore=Au,t.FirestoreError=_,t.GeoPoint=ju,t.LoadBundleTask=Cu,t.PersistentCacheIndexManager=Zl,t.Query=bu,t.QueryCompositeFilterConstraint=vl,t.QueryConstraint=ml,t.QueryDocumentSnapshot=Ml,t.QueryEndAtConstraint=xl,t.QueryFieldFilterConstraint=yl,t.QueryLimitConstraint=bl,t.QueryOrderByConstraint=wl,t.QuerySnapshot=Pl,t.QueryStartAtConstraint=_l,t.SnapshotMetadata=Ll,t.Timestamp=R,t.Transaction=Yl,t.WriteBatch=Wl,t._ByteString=st,t._DatabaseId=pt,t._DocumentKey=U,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new D(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=I,t._FieldPath=q,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return nh.instance.onExistenceFilterMismatch(e)}},t._cast=gu,t._debugAssert=function(e,t){e||y()},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=g,t._validateIsNotUsedTogether=hu,t.addDoc=function(e,t){const n=gu(e.firestore,Au),r=Eu(e),i=Dl(e.converter,t);return jl(n,[Ku($u(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,fr.exists(!1))]).then((()=>r))},t.aggregateFieldEqual=function(e,t){var n,r;return e instanceof Ou&&t instanceof Ou&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Iu(e.query,t.query)&&o.deepEqual(e.data(),t.data())},t.and=function(...e){return e.forEach((e=>Cl("and",e))),vl._create("and",e)},t.arrayRemove=function(...e){return new Yu("arrayRemove",e)},t.arrayUnion=function(...e){return new Xu("arrayUnion",e)},t.average=function(e){return new Ou("avg",ol("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new _(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new x;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!se.C())return Promise.resolve();const t=e+"main";await se.delete(t)}(xo(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise},t.collection=function(e,t,...n){if(e=o.getModularInstance(e),lu("collection","path",t),e instanceof vu){const r=V.fromString(t,...n);return fu(r),new xu(e,null,r)}{if(!(e instanceof _u||e instanceof xu))throw new _(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return fu(r),new xu(e.firestore,null,r)}},t.collectionGroup=function(e,t){if(e=gu(e,vu),lu("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new _(b.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new bu(e,null,function(e){return new wn(V.emptyPath(),e)}(t))},t.connectFirestoreEmulator=wu,t.count=Nl,t.deleteAllPersistentCacheIndexes=function(e){e._client.verifyNotTerminated(),function(e){return e.asyncQueue.enqueue((async()=>function(e){const t=w(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",(e=>n.deleteAllFieldIndexes(e)))}(await tu(e))))}(e._client).then((e=>f("deleting all persistent cache indexes succeeded"))).catch((e=>g("deleting all persistent cache indexes failed",e)))},t.deleteDoc=function(e){return jl(gu(e.firestore,Au),[new Sr(e._key,fr.none())])},t.deleteField=function(){return new Hu("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await eu(e),n=await nu(e);return t.setNetworkEnabled(!1),async function(e){const t=w(e);t.v_.add(0),await pa(t),t.x_.set("Offline")}(n)}))}(Du(e=gu(e,Au)))},t.disablePersistentCacheIndexAutoCreation=function(e){eh(e,!1)},t.doc=Eu,t.documentId=function(){return new Ru("__name__")},t.enableIndexedDbPersistence=function(e,t){Lu(e=gu(e,Au));const n=Du(e);if(n._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");g("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Uc;return Nu(n,i,new Bc(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(e){Lu(e=gu(e,Au));const t=Du(e);if(t._uninitializedComponentsProvider)throw new _(b.FAILED_PRECONDITION,"SDK cache is already specified.");g("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Uc;return Nu(t,r,new qc(r,n.cacheSizeBytes))},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await eu(e),n=await nu(e);return t.setNetworkEnabled(!0),function(e){const t=w(e);return t.v_.delete(0),fa(t)}(n)}))}(Du(e=gu(e,Au)))},t.enablePersistentCacheIndexAutoCreation=function(e){eh(e,!0)},t.endAt=function(...e){return xl._create("endAt",e,!0)},t.endBefore=function(...e){return xl._create("endBefore",e,!1)},t.ensureFirestoreConfigured=Du,t.executeWrite=jl,t.getAggregateFromServer=Bl,t.getCountFromServer=function(e){return Bl(e,{count:Nl()})},t.getDoc=function(e){e=gu(e,_u);const t=gu(e.firestore,Au);return ou(Du(t),e._key).then((n=>Vl(t,e,n)))},t.getDocFromCache=function(e){e=gu(e,_u);const t=gu(e.firestore,Au),n=Du(t),r=new Fl(t);return function(e,t){const n=new x;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=w(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new _(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Ua(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await tu(e),t,n))),n.promise}(n,e._key).then((n=>new Ol(t,r,e._key,n,new Ll(null!==n&&n.hasLocalMutations,!0),e.converter)))},t.getDocFromServer=function(e){e=gu(e,_u);const t=gu(e.firestore,Au);return ou(Du(t),e._key,{source:"server"}).then((n=>Vl(t,e,n)))},t.getDocs=function(e){e=gu(e,bu);const t=gu(e.firestore,Au),n=Du(t),r=new Fl(t);return pl(e._query),au(n,e._query).then((n=>new Pl(t,r,e,n)))},t.getDocsFromCache=function(e){e=gu(e,bu);const t=gu(e.firestore,Au),n=Du(t),r=new Fl(t);return function(e,t){const n=new x;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Mo(e,t,!0),i=new oc(t,r.hs),s=i.la(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Ua(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await tu(e),t,n))),n.promise}(n,e._query).then((n=>new Pl(t,r,e,n)))},t.getDocsFromServer=function(e){e=gu(e,bu);const t=gu(e.firestore,Au),n=Du(t),r=new Fl(t);return au(n,e._query,{source:"server"}).then((n=>new Pl(t,r,e,n)))},t.getFirestore=function(e,t){const n="object"==typeof e?e:r.getApp(),i="string"==typeof e?e:t||"(default)",s=r._getProvider(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const e=o.getDefaultEmulatorHostnameAndPort("firestore");e&&wu(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=gu(e,Au);const n=th.get(e);if(n)return n;const r=Du(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;const i=new Zl(r);return th.set(e,i),i},t.increment=function(e){return new Ju("increment",e)},t.initializeFirestore=function(e,t,n){n||(n="(default)");const i=r._getProvider(e,"firestore");if(i.isInitialized(n)){const e=i.getImmediate({identifier:n}),r=i.getOptions(n);if(o.deepEqual(r,t))return e;throw new _(b.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new _(b.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new _(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:n})},t.limit=function(e){return mu("limit",e),bl._create("limit",e,"F")},t.limitToLast=function(e){return mu("limitToLast",e),bl._create("limitToLast",e,"L")},t.loadBundle=function(e,t){const n=Du(e=gu(e,Au)),r=new Cu;return function(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?jr().encode(e):e,function(e,t){return new $c(e,t)}(function(e,t){if(e instanceof Uint8Array)return zc(e,t);if(e instanceof ArrayBuffer)return zc(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,sa(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=w(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=w(e),r=ai(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.$r.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(rc(r));const i=new nc(r,e.localStore,t.serializer);let s=await t.xa();for(;s;){const e=await i.ta(s);e&&n._updateProgress(e),s=await t.xa()}const o=await i.complete();return await Tc(e,o.ia,void 0),await function(e,t){const n=w(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.$r.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.ra)}catch(e){return g("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await ru(e),i,r)}))}(n,e._databaseId,t,r),r},t.memoryEagerGarbageCollector=function(){return new zl},t.memoryLocalCache=function(e){return new ql(e)},t.memoryLruGarbageCollector=function(e){return new Gl(null==e?void 0:e.cacheSizeBytes)},t.namedQuery=function(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=w(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.$r.getNamedQuery(e,t)))}(await tu(e),t)))}(Du(e=gu(e,Au)),t).then((t=>t?new bu(e,null,t.query):null))},t.onSnapshot=function(e,...t){var n,r,i;e=o.getModularInstance(e);let s={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||Su(t[a])||(s=t[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges};if(Su(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof _u)l=gu(e.firestore,Au),h=_n(e._key.path),u={next:n=>{t[a]&&t[a](Vl(l,e,n))},error:t[a+1],complete:t[a+2]};else{const n=gu(e,bu);l=gu(n.firestore,Au),h=n._query;const r=new Fl(l);u={next:e=>{t[a]&&t[a](new Pl(l,r,n,e))},error:t[a+1],complete:t[a+2]},pl(e._query)}return function(e,t,n,r){const i=new Gc(r),s=new Za(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Qa(await su(e),s))),()=>{i.Ba(),e.asyncQueue.enqueueAndForget((async()=>Wa(await su(e),s)))}}(Du(l),h,c,u)},t.onSnapshotsInSync=function(e,t){return function(e,t){const n=new Gc(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).Q_.add(t),t.next()}(await su(e),n))),()=>{n.Ba(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).Q_.delete(t)}(await su(e),n)))}}(Du(e=gu(e,Au)),Su(t)?t:{next:t})},t.or=function(...e){return e.forEach((e=>Cl("or",e))),vl._create("or",e)},t.orderBy=function(e,t="asc"){const n=t,r=fl("orderBy",e);return wl._create(r,n)},t.persistentLocalCache=function(e){return new Ul(e)},t.persistentMultipleTabManager=function(){return new Kl},t.persistentSingleTabManager=Hl,t.query=function(e,t,...n){let r=[];t instanceof gl&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof vl)).length,n=e.filter((e=>e instanceof yl)).length;if(t>1||t>0&&n>0)throw new _(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e},t.queryEqual=Iu,t.refEqual=function(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),(e instanceof _u||e instanceof xu)&&(t instanceof _u||t instanceof xu)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,n){e=gu(e,Au);const r=Object.assign(Object.assign({},Ql),n);return function(e){if(e.maxAttempts<1)throw new _(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new x;return e.asyncQueue.enqueueAndForget((async()=>{const i=await iu(e);new Hc(e.asyncQueue,i,n,t,r).run()})),r.promise}(Du(e),(n=>t(new Yl(e,n))),r)},t.serverTimestamp=function(){return new Wu("serverTimestamp")},t.setDoc=function(e,t,n){e=gu(e,_u);const r=gu(e.firestore,Au),i=Dl(e.converter,t,n);return jl(r,[Ku($u(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,fr.none())])},t.setIndexConfiguration=function(e,t){var n;const r=Du(e=gu(e,Au));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return g("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new _(b.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const e of t.indexes){const t=Jl(e,"collectionGroup"),r=[];if(Array.isArray(e.fields))for(const t of e.fields){const e=cl("setIndexConfiguration",Jl(t,"fieldPath"));"CONTAINS"===t.arrayConfig?r.push(new H(e,2)):"ASCENDING"===t.order?r.push(new H(e,0)):"DESCENDING"===t.order&&r.push(new H(e,1))}n.push(new z(z.UNKNOWN_ID,t,r,W.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue((async()=>async function(e,t){const n=w(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",(e=>r.getFieldIndexes(e).next((n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,c=0;for(;a<o&&c<s;){const s=n(e[c],t[a]);s<0?i(e[c++]):s>0?r(t[a++]):(a++,c++)}for(;a<o;)r(t[a++]);for(;c<s;)i(e[c++])}(n,t,K,(t=>{i.push(r.addFieldIndex(e,t))}),(t=>{i.push(r.deleteFieldIndex(e,t))})))).next((()=>re.waitFor(i)))))}(await tu(e),t)))}(r,i)},t.setLogLevel=function(e){h.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof Ol&&t instanceof Ol?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Pl&&t instanceof Pl&&e._firestore===t._firestore&&Iu(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(...e){return _l._create("startAfter",e,!1)},t.startAt=function(...e){return _l._create("startAt",e,!0)},t.sum=function(e){return new Ou("sum",ol("sum",e))},t.terminate=function(e){return r._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,n,...r){e=gu(e,_u);const i=gu(e.firestore,Au),s=$u(i);let a;return a="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(s,"updateDoc",e._key,t,n,r):Zu(s,"updateDoc",e._key,t),jl(i,[a.toMutation(e._key,fr.exists(!0))])},t.waitForPendingWrites=function(e){return function(e){const t=new x;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=w(e);_a(n.remoteStore)||f("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=w(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Da.get(e)||[];r.push(t),n.Da.set(e,r)}catch(e){const n=Ua(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await ru(e),t))),t.promise}(Du(e=gu(e,Au)))},t.where=function(e,t,n){const r=t,i=fl("where",e);return yl._create(i,r,n)},t.writeBatch=function(e){return Du(e=gu(e,Au)),new Wl(e,(t=>jl(e,t)))}},19:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(582),o=[];t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var a={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},c=t.LogLevel.INFO,u=((r={})[t.LogLevel.DEBUG]="log",r[t.LogLevel.VERBOSE]="log",r[t.LogLevel.INFO]="info",r[t.LogLevel.WARN]="warn",r[t.LogLevel.ERROR]="error",r),l=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=u[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));console[o].apply(console,s.__spreadArray(["[".concat(i,"]  ").concat(e.name,":")],n,!1))}},h=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1))},e}();t.Logger=h,t.setLogLevel=function(e){o.forEach((function(t){t.setLogLevel(e)}))},t.setUserLogHandler=function(e,n){for(var r=function(r){var i=null;n&&n.level&&(i=a[n.level]),r.userLogHandler=null===e?null:function(n,r){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];var a=s.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");r>=(null!=i?i:n.logLevel)&&e({level:t.LogLevel[r].toLowerCase(),message:a,args:s,type:n.name})}},i=0,s=o;i<s.length;i++)r(s[i])}},313:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new c;const u=i<<2|s>>4;if(r.push(u),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=o(e);return a.encodeByteArray(t,!0)},l=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}function f(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const p=()=>{try{return f().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},g=e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){var e;const t=null===(e=p())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}class w extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(_,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new w(r,o,n)}}const _=/\{\$([^}]+)}/g;function x(e){return JSON.parse(e)}const E=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=x(h(s[0])||""),n=x(h(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function I(e){return null!==e&&"object"==typeof e}class T{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=S),void 0===r.error&&(r.error=S),void 0===r.complete&&(r.complete=S);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function S(){}function C(e,t){return`${e} failed: ${t} argument `}const A=144e5;t.CONSTANTS=r,t.DecodeBase64StringError=c,t.Deferred=m,t.ErrorFactory=b,t.FirebaseError=w,t.MAX_VALUE_MILLIS=A,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}},t.areCookiesEnabled=function(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)},t.assert=i,t.assertionError=s,t.async=function(e,t){return(...n)=>{Promise.resolve(!0).then((()=>{e(...n)})).catch((e=>{t&&t(e)}))}},t.base64=a,t.base64Decode=h,t.base64Encode=u,t.base64urlEncodeWithoutPadding=l,t.calculateBackoffMillis=function(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(A,r+i)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")},t.createSubscribe=function(e,t){const n=new T(e,t);return n.subscribe.bind(n)},t.decode=E,t.deepCopy=function(e){return d(void 0,e)},t.deepEqual=function e(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const r=t[s],o=n[s];if(I(r)&&I(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(const e of i)if(!r.includes(e))return!1;return!0},t.deepExtend=d,t.errorPrefix=C,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=g,t.getDefaultEmulatorHostnameAndPort=e=>{const t=g(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},t.getDefaults=p,t.getExperimentalSetting=e=>{var t;return null===(t=p())||void 0===t?void 0:t[`_${e}`]},t.getGlobal=f,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=y,t.isAdmin=function(e){const t=E(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return y().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=y();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"==typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())},t.isNode=v,t.isNodeSdk=function(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!v()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return y().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=E(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=E(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){const t=E(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=x,t.map=function(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){const t=(e=Math.abs(e))%100;if(t>=10&&t<=20)return"th";const n=e%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(e):`${e}`},t.promiseWithTimeout=function(e,t=2e3){const n=new m;return setTimeout((()=>n.reject("timeout!")),t),e.then(n.resolve,n.reject),n.promise},t.querystring=function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const t=s-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(r)-56320)}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.validateArgCount=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(C(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(C(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))},t.validateNamespace=function(e,t,n){if((!n||t)&&"string"!=typeof t)throw new Error(C(e,"namespace")+"must be a valid firebase namespace.")}},816:(e,t,n)=>{(function(){var t;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:r(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}var s,o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(e,t){if(t)e:{var n=c;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{var l;e:{var h={};try{h.__proto__={a:!0},l=h.a;break e}catch(q){}l=!1}s=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=s;function f(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function p(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}u("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),u("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return f(r(this))}})}return e})),u("Promise",(function(e){function t(e){this.g=0,this.i=void 0,this.h=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=c.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.B),reject:e(this.l)}},t.prototype.B=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.D(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.g)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.g);this.g=e,this.i=t,2===this.g&&this.C(),this.u()},t.prototype.C=function(){var e=this;s((function(){if(e.v()){var t=c.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.v=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)o.h(this.h[e]);this.h=null}};var o=new n;return t.prototype.D=function(e){var t=this.j();e.la(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){s(e)}}:t}var i,s,o=new t((function(e,t){i=e,s=t}));return this.la(r(e,i),r(n,s)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.la=function(e,t){function n(){switch(r.g){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.g)}}var r=this;null==this.h?o.h(n):this.h.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var s=i(e),o=s.next();!o.done;o=s.next())r(o.value).la(t,n)}))},t.all=function(e){var n=i(e),s=n.next();return s.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--a&&e(o)}}var o=[],a=0;do{o.push(void 0),a++,r(s.value).la(i(o.length-1),t),s=n.next()}while(!s.done)}))},t})),u("Array.prototype.values",(function(e){return e||function(){return p(this,(function(e,t){return t}))}})),u("Array.prototype.keys",(function(e){return e||function(){return p(this,(function(e){return e}))}})),u("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=i(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function s(e){if(!g(e,c)){var t=new n;a(e,c,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&s(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var c="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(s(e),!g(e,c))throw Error("WeakMap key fail: "+e);return e[c][this.g]=t,this},t.prototype.get=function(e){return r(e)&&g(e,c)?e[c][this.g]:void 0},t.prototype.has=function(e){return r(e)&&g(e,c)&&g(e[c],this.g)},t.prototype.delete=function(e){return!!(r(e)&&g(e,c)&&g(e[c],this.g))&&delete e[c][this.g]},t})),u("Map",(function(e){function t(){var e={};return e.V=e.next=e.head=e}function n(e,t){var n=e.g;return f((function(){if(n){for(;n.head!=e.g;)n=n.V;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++a,o.set(t,n)):n="p_"+t;var r=e.h[n];if(r&&g(e.h,n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,K:i}}return{id:n,list:r,index:-1,K:void 0}}function s(e){if(this.h={},this.g=t(),this.size=0,e){e=i(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&"s"==s.value[1]&&!((s=r.next()).done||4!=s.value[0].x||"t"!=s.value[1]||!r.next().done)}catch(e){return!1}}())return e;var o=new WeakMap;s.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.K?n.K.value=t:(n.K={next:this.g,V:this.g.V,head:this.g,key:e,value:t},n.list.push(n.K),this.g.V.next=n.K,this.g.V=n.K,this.size++),this},s.prototype.delete=function(e){return!(!(e=r(this,e)).K||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.K.V.next=e.K.next,e.K.next.V=e.K.V,e.K.head=null,this.size--,0))},s.prototype.clear=function(){this.h={},this.g=this.g.V=t(),this.size=0},s.prototype.has=function(e){return!!r(this,e).K},s.prototype.get=function(e){return(e=r(this,e).K)&&e.value},s.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},s.prototype.keys=function(){return n(this,(function(e){return e.key}))},s.prototype.values=function(){return n(this,(function(e){return e.value}))},s.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},s.prototype[Symbol.iterator]=s.prototype.entries;var a=0;return s})),u("Array.prototype.find",(function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var r=n.length,i=0;i<r;i++){var s=n[i];if(e.call(t,s,i,n)){e=s;break e}}e=void 0}return e}})),u("Array.prototype.entries",(function(e){return e||function(){return p(this,(function(e,t){return[e,t]}))}})),u("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var s=0;!(i=e.next()).done;)r.push(t.call(n,i.value,s++))}else for(i=e.length,s=0;s<i;s++)r.push(t.call(n,e[s],s));return r}})),u("Set",(function(e){function t(e){if(this.g=new Map,e){e=i(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&s.value[1]==t&&!(s=r.next()).done&&s.value[0]!=t&&4==s.value[0].x&&s.value[1]==s.value[0]&&r.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(r){return e.call(t,r,r,n)}))},t)}));var m=m||{},y=this||self;function v(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function w(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function b(e){return Object.prototype.hasOwnProperty.call(e,_)&&e[_]||(e[_]=++x)}var _="closure_uid_"+(1e9*Math.random()>>>0),x=0;function E(e,t,n){return e.call.apply(e.bind,arguments)}function I(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function T(e,t,n){return(T=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:I).apply(null,arguments)}function S(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function C(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dc=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function A(){0!=D&&(k[b(this)]=this),this.s=this.s,this.o=this.o}var D=0,k={};A.prototype.s=!1,A.prototype.va=function(){if(!this.s&&(this.s=!0,this.O(),0!=D)){var e=b(this);if(0!=D&&this.o&&0<this.o.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete k[e]}},A.prototype.O=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var N=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function L(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function O(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(v(r)){var i=e.length||0,s=r.length||0;e.length=i+s;for(var o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}}function M(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{y.addEventListener("test",(function(){}),t),y.removeEventListener("test",(function(){}),t)}catch(e){}return e}();function R(e){return/^[\s\xa0]*$/.test(e)}function F(){var e=y.navigator;return e&&(e=e.userAgent)?e:""}function j(e){return-1!=F().indexOf(e)}function V(e){return V[" "](e),e}V[" "]=function(){};var B,q,U,z=j("Opera"),G=j("Trident")||j("MSIE"),$=j("Edge"),K=$||G,H=j("Gecko")&&!(-1!=F().toLowerCase().indexOf("webkit")&&!j("Edge"))&&!(j("Trident")||j("MSIE"))&&!j("Edge"),Q=-1!=F().toLowerCase().indexOf("webkit")&&!j("Edge");function W(){var e=y.document;return e?e.documentMode:void 0}e:{var X="",Y=(q=F(),H?/rv:([^\);]+)(\)|;)/.exec(q):$?/Edge\/([\d\.]+)/.exec(q):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):Q?/WebKit\/(\S+)/.exec(q):z?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(Y&&(X=Y?Y[1]:""),G){var J=W();if(null!=J&&J>parseFloat(X)){B=String(J);break e}}B=X}y.document&&G?U=W()||parseInt(B,10)||void 0:U=void 0;var Z=U;function ee(e,t){if(M.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(H){e:{try{V(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:te[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ee.Z.h.call(this)}}C(ee,M);var te={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.oa=i,this.key=++re,this.ha=this.ka=!1}function se(e){e.ha=!0,e.listener=null,e.proxy=null,e.src=null,e.oa=null}function oe(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ae(e){var t,n={};for(t in e)n[t]=e[t];return n}var ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<ce.length;s++)n=ce[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function le(e){this.src=e,this.g={},this.h=0}function he(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=N(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ha&&s.listener==t&&s.capture==!!n&&s.oa==r)return i}return-1}le.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=de(e,t,r,i);return-1<o?(t=e[o],n||(t.ka=!1)):((t=new ie(t,this.src,s,!!r,i)).ka=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function ge(e,t,n,r,i){if(r&&r.once)return ye(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ge(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.P(t,n,w(r)?!!r.capture:!!r,i):me(e,t,n,!1,r,i)}function me(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=w(i)?!!i.capture:!!i,a=xe(e);if(a||(e[fe]=a=new le(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=_e;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ye(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.R(t,n,w(r)?!!r.capture:!!r,i):me(e,t,n,!0,r,i)}function ve(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ve(e,t[s],n,r,i);else r=w(r)?!!r.capture:!!r,n=Ie(n),e&&e[ne]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=de(s=e.g[t],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=xe(e))&&(t=e.g[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&we(n))}function we(e){if("number"!=typeof e&&e&&!e.ha){var t=e.src;if(t&&t[ne])he(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=xe(t))?(he(n,e),0==n.h&&(n.src=null,t[fe]=null)):se(e)}}}function be(e){return e in pe?pe[e]:pe[e]="on"+e}function _e(e,t){if(e.ha)e=!0;else{t=new ee(t,this);var n=e.listener,r=e.oa||e.src;e.ka&&we(e),e=n.call(r,t)}return e}function xe(e){return(e=e[fe])instanceof le?e:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ie(e){return"function"==typeof e?e:(e[Ee]||(e[Ee]=function(t){return e.handleEvent(t)}),e[Ee])}function Te(){A.call(this),this.i=new le(this),this.T=this,this.J=null}function Se(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.T,r=t.type||t,"string"==typeof t)t=new M(t,e);else if(t instanceof M)t.target=t.target||e;else{var i=t;ue(t=new M(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ce(o,r,!0,t)&&i}if(i=Ce(o=t.g=e,r,!0,t)&&i,i=Ce(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ce(o=t.g=n[s],r,!1,t)&&i}function Ce(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ha&&o.capture==n){var a=o.listener,c=o.oa||o.src;o.ka&&he(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}C(Te,A),Te.prototype[ne]=!0,Te.prototype.removeEventListener=function(e,t,n,r){ve(this,e,t,n,r)},Te.prototype.O=function(){if(Te.Z.O.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},Te.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Te.prototype.R=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ae=y.JSON.stringify;function De(e,t){this.i=e,this.j=t,this.h=0,this.g=null}function ke(){this.h=this.g=null}function Ne(){var e=je,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}De.prototype.get=function(){if(0<this.h){this.h--;var e=this.g;this.g=e.next,e.next=null}else e=this.i();return e},ke.prototype.add=function(e,t){var n=Le.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n};var Le=new De((function(){return new Oe}),(function(e){return e.reset()}));function Oe(){this.next=this.g=this.h=null}function Me(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Pe(e){y.setTimeout((function(){throw e}),0)}Oe.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},Oe.prototype.reset=function(){this.next=this.g=this.h=null};var Re,Fe=!1,je=new ke;function Ve(e,t){Re||function(){var e=y.Promise.resolve(void 0);Re=function(){e.then(Be)}}(),Fe||(Re(),Fe=!0),je.add(e,t)}function Be(){for(var e;e=Ne();){try{e.h.call(e.g)}catch(e){Pe(e)}var t=Le;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fe=!1}function qe(e,t){Te.call(this),this.h=e||1,this.g=t||y,this.j=T(this.tb,this),this.l=Date.now()}function Ue(e){e.ia=!1,e.U&&(e.g.clearTimeout(e.U),e.U=null)}function ze(e,t,n){if("function"==typeof e)n&&(e=T(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=T(e.handleEvent,e)}return 2147483647<Number(t)?-1:y.setTimeout(e,t||0)}function Ge(e,t,n){A.call(this),this.m=null!=n?e.bind(n):e,this.j=t,this.h=null,this.i=!1,this.g=null}if(C(qe,Te),(t=qe.prototype).ia=!1,t.U=null,t.tb=function(){if(this.ia){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.U=this.g.setTimeout(this.j,this.h-e):(this.U&&(this.g.clearTimeout(this.U),this.U=null),Se(this,"tick"),this.ia&&(Ue(this),this.start()))}},t.start=function(){this.ia=!0,this.U||(this.U=this.g.setTimeout(this.j,this.h),this.l=Date.now())},t.O=function(){qe.Z.O.call(this),Ue(this),delete this.g},Ge.prototype=o(A.prototype),Ge.prototype.constructor=Ge,d)d(Ge,A);else for(var $e in A)if("prototype"!=$e)if(Object.defineProperties){var Ke=Object.getOwnPropertyDescriptor(A,$e);Ke&&Object.defineProperty(Ge,$e,Ke)}else Ge[$e]=A[$e];function He(e){e.g=ze((function(){e.g=null,e.i&&(e.i=!1,He(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}function Qe(e){A.call(this),this.h=e,this.g={}}Ge.Z=A.prototype,Ge.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:He(this)},Ge.prototype.O=function(){A.prototype.O.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},C(Qe,A);var We=[];function Xe(e,t,n,r){Array.isArray(n)||(n&&(We[0]=n.toString()),n=We);for(var i=0;i<n.length;i++){var s=ge(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Ye(e){oe(e.g,(function(e,t){this.g.hasOwnProperty(t)&&we(e)}),e),e.g={}}function Je(){this.g=!0}function Ze(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ae(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Qe.prototype.O=function(){Qe.Z.O.call(this),Ye(this)},Qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Je.prototype.Ha=function(){this.g=!1},Je.prototype.info=function(){};var et={},tt=null;function nt(){return tt=tt||new Te}function rt(e){M.call(this,et.Wa,e)}function it(e){var t=nt();Se(t,new rt(t,e))}function st(e,t){M.call(this,et.STAT_EVENT,e),this.stat=t}function ot(e){var t=nt();Se(t,new st(t,e))}function at(e,t){M.call(this,et.Xa,e),this.size=t}function ct(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){e()}),t)}et.Wa="serverreachability",C(rt,M),et.STAT_EVENT="statevent",C(st,M),et.Xa="timingevent",C(at,M);var ut={NO_ERROR:0,ub:1,Hb:2,Gb:3,Bb:4,Fb:5,Ib:6,Ta:7,TIMEOUT:8,Lb:9},lt={zb:"complete",Vb:"success",Ua:"error",Ta:"abort",Nb:"ready",Ob:"readystatechange",TIMEOUT:"timeout",Jb:"incrementaldata",Mb:"progress",Cb:"downloadprogress",cc:"uploadprogress"};function ht(){}function dt(e){return e.h||(e.h=e.i())}function ft(){}ht.prototype.h=null;var pt,gt={OPEN:"a",yb:"b",Ua:"c",Kb:"d"};function mt(){M.call(this,"d")}function yt(){M.call(this,"c")}function vt(){}function wt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.Y=r||1,this.W=new Qe(this),this.R=_t,e=K?125:void 0,this.X=new qe(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.M=this.G=this.aa=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.ea=-1,this.J=!1,this.P=0,this.N=null,this.da=this.L=this.ca=this.T=!1,this.h=new bt}function bt(){this.i=null,this.g="",this.h=!1}C(mt,M),C(yt,M),C(vt,ht),vt.prototype.g=function(){return new XMLHttpRequest},vt.prototype.i=function(){return{}},pt=new vt;var _t=45e3,xt={},Et={};function It(e,t,n){e.M=1,e.v=zt(jt(t)),e.s=n,e.T=!0,Tt(e,null)}function Tt(e,t){e.G=Date.now(),Dt(e),e.A=jt(e.v);var n=e.A,r=e.Y;Array.isArray(r)||(r=[String(r)]),nn(n.i,"t",r),e.C=0,n=e.l.J,e.h=new bt,e.g=ir(e.l,n?t:null,!e.s),0<e.P&&(e.N=new Ge(T(e.Sa,e,e.g),e.P)),Xe(e.W,e.g,"readystatechange",e.qb),t=e.I?ae(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ja(e.A,e.u,e.s,t)):(e.u="GET",e.g.ja(e.A,e.u,null,t)),it(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.Y,e.s)}function St(e){return!!e.g&&"GET"==e.u&&2!=e.M&&e.l.Ka}function Ct(e,t,n){for(var r,i=!0;!e.J&&e.C<n.length;){if((r=At(e,n))==Et){4==t&&(e.o=4,ot(14),i=!1),Ze(e.j,e.m,null,"[Incomplete Response]");break}if(r==xt){e.o=4,ot(15),Ze(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ze(e.j,e.m,r,null),Mt(e,r)}St(e)&&r!=Et&&r!=xt&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,ot(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.da&&(e.da=!0,(t=e.l).g==e&&t.ea&&!t.N&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(t),t.N=!0,ot(11))):(Ze(e.j,e.m,n,"[Invalid Chunked Response]"),Ot(e),Lt(e))}function At(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Et:(n=Number(t.substring(n,r)),isNaN(n)?xt:(r+=1)+n>t.length?Et:(t=t.slice(r,r+n),e.C=r+n,t))}function Dt(e){e.aa=Date.now()+e.R,kt(e,e.R)}function kt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ct(T(e.ob,e),t)}function Nt(e){e.B&&(y.clearTimeout(e.B),e.B=null)}function Lt(e){0==e.l.H||e.J||Zn(e.l,e)}function Ot(e){Nt(e);var t=e.N;t&&"function"==typeof t.va&&t.va(),e.N=null,Ue(e.X),Ye(e.W),e.g&&(t=e.g,e.g=null,t.abort(),t.va())}function Mt(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||hn(n.i,e)))if(!e.L&&hn(n.i,e)&&3==n.H){try{var r=n.Ma.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Jn(n),Un(n)}Wn(n),ot(18)}}else n.Ia=i[1],0<n.Ia-n.X&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ct(T(n.lb,n),6e3));if(1>=ln(n.i)&&n.ra){try{n.ra()}catch(e){}n.ra=void 0}}else tr(n,11)}else if((e.L||n.g==e)&&Jn(n),!R(t))for(i=n.Ma.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.X=s[0],s=s[1],2==n.H)if("c"==s[0]){n.L=s[1],n.sa=s[2];var o=s[3];null!=o&&(n.ua=o,n.l.info("VER="+n.ua));var a=s[4];null!=a&&(n.Ja=a,n.l.info("SVER="+n.Ja));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.M=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(dn(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.Ga=d,Ut(r.I,r.D,d))}}n.H=3,n.h&&n.h.Ea(),n.ea&&(n.T=Date.now()-e.G,n.l.info("Handshake RTT: "+n.T+"ms"));var f=e;if((r=n).za=rr(r,r.J?r.sa:null,r.aa),f.L){fn(r.i,f);var p=f,g=r.M;g&&p.setTimeout(g),p.B&&(Nt(p),Dt(p)),r.g=f}else Qn(r);0<n.j.length&&Gn(n)}else"stop"!=s[0]&&"close"!=s[0]||tr(n,7);else 3==n.H&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?tr(n,7):qn(n):"noop"!=s[0]&&n.h&&n.h.Da(s),n.A=0)}it(4)}catch(e){}}function Pt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.wa&&"function"==typeof e.wa)return e.wa();if(!e.ba||"function"!=typeof e.ba){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(v(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.ba&&"function"==typeof e.ba)return e.ba();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(t=wt.prototype).setTimeout=function(e){this.R=e},t.qb=function(e){e=e.target;var t=this.N;t&&3==Pn(e)?t.l():this.Sa(e)},t.Sa=function(e){try{if(e==this.g)e:{var t=Pn(this.g),n=this.g.La(),r=this.g.fa();if(!(3>t)&&(3!=t||K||this.g&&(this.h.h||this.g.ma()||Rn(this.g)))){this.J||4!=t||7==n||it(8==n||0>=r?3:2),Nt(this);var i=this.g.fa();this.ea=i;t:if(St(this)){var s=Rn(this.g);e="";var o=s.length,a=4==Pn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ot(this),Lt(this);var c="";break t}this.h.i=new y.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=e,this.C=0,c=this.h.g}else c=this.g.ma();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.Y,t,i),this.i){if(this.ca&&!this.L){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,ot(12),Ot(this),Lt(this);break e}Ze(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Mt(this,i)}this.T?(Ct(this,t,c),K&&this.i&&3==t&&(Xe(this.W,this.X,"tick",this.pb),this.X.start())):(Ze(this.j,this.m,c,null),Mt(this,c)),4==t&&Ot(this),this.i&&!this.J&&(4==t?Zn(this.l,this):(this.i=!1,Dt(this)))}else(function(e){var t={};e=(e.g&&2<=Pn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!R(e[n])){var r=Me(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var s=t[i]||[];t[i]=s,s.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==i&&0<c.indexOf("Unknown SID")?(this.o=3,ot(12)):(this.o=0,ot(13)),Ot(this),Lt(this)}}}catch(e){}},t.pb=function(){if(this.g){var e=Pn(this.g),t=this.g.ma();this.C<t.length&&(Nt(this),Ct(this,e,t),this.i&&4!=e&&Dt(this))}},t.cancel=function(){this.J=!0,Ot(this)},t.ob=function(){this.B=null;var e=Date.now();0<=e-this.aa?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.M&&(it(3),ot(17)),Ot(this),this.o=2,Lt(this)):kt(this,this.aa-e)};var Rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(e){var t;this.g=this.s=this.j="",this.o=null,this.m=this.h="",this.l=!1,e instanceof Ft?(this.l=e.l,Vt(this,e.j),this.s=e.s,this.g=e.g,Bt(this,e.o),this.h=e.h,qt(this,rn(e.i)),this.m=e.m):e&&(t=String(e).match(Rt))?(this.l=!1,Vt(this,t[1]||"",!0),this.s=Gt(t[2]||""),this.g=Gt(t[3]||"",!0),Bt(this,t[4]),this.h=Gt(t[5]||"",!0),qt(this,t[6]||"",!0),this.m=Gt(t[7]||"")):(this.l=!1,this.i=new Jt(null,this.l))}function jt(e){return new Ft(e)}function Vt(e,t,n){e.j=n?Gt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.o=t}else e.o=null}function qt(e,t,n){t instanceof Jt?(e.i=t,function(e,t){t&&!e.j&&(Zt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(en(this,t),nn(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=$t(t,Xt)),e.i=new Jt(t,e.l))}function Ut(e,t,n){e.i.set(t,n)}function zt(e){return Ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Gt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function $t(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push($t(t,Ht,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push($t(t,Ht,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.o)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push($t(n,"/"==n.charAt(0)?Wt:Qt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",$t(n,Yt)),e.join("")},Ft.prototype.resolve=function(e){var t=jt(this),n=!!e.j;n?Vt(t,e.j):n=!!e.s,n?t.s=e.s:n=!!e.g,n?t.g=e.g:n=null!=e.o;var r=e.h;if(n)Bt(t,e.o);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],o=0;o<i.length;){var a=i[o++];"."==a?r&&o==i.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&o==i.length&&s.push("")):(s.push(a),r=!0)}r=s.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?qt(t,rn(e.i)):n=!!e.m,n&&(t.m=e.m),t};var Ht=/[#\/\?@]/g,Qt=/[#\?:]/g,Wt=/[#\?]/g,Xt=/[#\?@]/g,Yt=/#/g;function Jt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Zt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function en(e,t){Zt(e),t=sn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tn(e,t){return Zt(e),t=sn(e,t),e.g.has(t)}function nn(e,t,n){en(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),L(n)),e.h+=n.length)}function rn(e){var t=new Jt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function on(e,t){this.g=e,this.map=t}function an(e){this.l=e||cn,e=y.PerformanceNavigationTiming?0<(e=y.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(y.g&&y.g.Na&&y.g.Na()&&y.g.Na().hc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(t=Jt.prototype).add=function(e,t){Zt(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},t.forEach=function(e,t){Zt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},t.wa=function(){Zt(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},t.ba=function(e){Zt(this);var t=[];if("string"==typeof e)tn(this,e)&&(t=t.concat(this.g.get(sn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},t.set=function(e,t){return Zt(this),this.i=null,tn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&0<(e=this.ba(e)).length?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.ba(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var cn=10;function un(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ln(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dn(e,t){e.g?e.g.add(t):e.h=t}function fn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){for(var t=e.i,n=(e=i(e.g.values())).next();!n.done;n=e.next())t=t.concat(n.value.D);return t}return L(e.i)}function gn(){}function mn(){this.g=new gn}function yn(e,t,n){var r=n||"";try{Pt(e,(function(e,n){var i=e;w(e)&&(i=Ae(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function vn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function wn(e){this.l=e.ic||null,this.j=e.rb||!1}function bn(e,t){Te.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=_n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}an.prototype.cancel=function(){if(this.i=pn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e=i(this.g.values()),t=e.next();!t.done;t=e.next())t.value.cancel();this.g.clear()}},gn.prototype.stringify=function(e){return y.JSON.stringify(e,void 0)},gn.prototype.parse=function(e){return y.JSON.parse(e,void 0)},C(wn,ht),wn.prototype.g=function(){return new bn(this.l,this.j)},wn.prototype.i=function(e){return function(){return e}}({}),C(bn,Te);var _n=0;function xn(e){e.j.read().then(e.$a.bind(e)).catch(e.na.bind(e))}function En(e){e.readyState=4,e.l=null,e.j=null,e.A=null,In(e)}function In(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(t=bn.prototype).open=function(e,t){if(this.readyState!=_n)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,In(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||y).fetch(new Request(this.B,t)).then(this.cb.bind(this),this.na.bind(this))},t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,En(this)),this.readyState=_n},t.cb=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,In(this)),this.g&&(this.readyState=3,In(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.ab.bind(this),this.na.bind(this));else if(void 0!==y.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;xn(this)}else e.text().then(this.bb.bind(this),this.na.bind(this))},t.$a=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?En(this):In(this),3==this.readyState&&xn(this)}},t.bb=function(e){this.g&&(this.response=this.responseText=e,En(this))},t.ab=function(e){this.g&&(this.response=e,En(this))},t.na=function(){this.g&&En(this)},t.setRequestHeader=function(e,t){this.v.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(bn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Tn=y.JSON.parse;function Sn(e){Te.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.D=!1,this.B=0,this.A=null,this.L=Cn,this.M=this.N=!1}C(Sn,Te);var Cn="",An=/^https?$/i,Dn=["POST","PUT"];function kn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Nn(e),On(e)}function Nn(e){e.D||(e.D=!0,Se(e,"complete"),Se(e,"error"))}function Ln(e){if(e.h&&void 0!==m&&(!e.C[1]||4!=Pn(e)||2!=e.fa()))if(e.v&&4==Pn(e))ze(e.Oa,0,e);else if(Se(e,"readystatechange"),4==Pn(e)){e.h=!1;try{var t,n=e.fa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.I).match(Rt)[1]||null;!s&&y.self&&y.self.location&&(s=y.self.location.protocol.slice(0,-1)),i=!An.test(s?s.toLowerCase():"")}t=i}if(t)Se(e,"complete"),Se(e,"success");else{e.m=6;try{var o=2<Pn(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.fa()+"]",Nn(e)}}finally{On(e)}}}function On(e,t){if(e.g){Mn(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||Se(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Mn(e){e.g&&e.M&&(e.g.ontimeout=null),e.A&&(y.clearTimeout(e.A),e.A=null)}function Pn(e){return e.g?e.g.readyState:0}function Rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.L){case Cn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Fn(e){var t="";return oe(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function jn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Fn(n),"string"==typeof e?(encodeURIComponent(String(t)),null!=n&&encodeURIComponent(String(n))):Ut(e,t,n))}function Vn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Bn(e){this.Ja=0,this.j=[],this.l=new Je,this.sa=this.za=this.I=this.aa=this.g=this.Ga=this.D=this.qa=this.o=this.W=this.s=null,this.ib=this.Y=0,this.gb=Vn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.ca=!0,this.Ia=this.X=-1,this.da=this.A=this.C=0,this.eb=Vn("baseRetryDelayMs",5e3,e),this.kb=Vn("retryDelaySeedMs",1e4,e),this.hb=Vn("forwardChannelMaxRetries",2,e),this.Aa=Vn("forwardChannelRequestTimeoutMs",2e4,e),this.ya=e&&e.xmlHttpFactory||void 0,this.Ka=e&&e.useFetchStreams||!1,this.M=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.L="",this.i=new an(e&&e.concurrentRequestLimit),this.Ma=new mn,this.R=e&&e.fastHandshake||!1,this.P=e&&e.encodeInitMessageHeaders||!1,this.R&&this.P&&(this.P=!1),this.fb=e&&e.ec||!1,e&&e.Ha&&this.l.Ha(),e&&e.forceLongPolling&&(this.ca=!1),this.ea=!this.R&&this.ca&&e&&e.detectBufferingProxy||!1,this.ta=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ta=e.longPollingTimeout),this.ra=void 0,this.T=0,this.N=!1,this.pa=this.B=null}function qn(e){if(zn(e),3==e.H){var t=e.Y++,n=jt(e.I);if(Ut(n,"SID",e.L),Ut(n,"RID",t),Ut(n,"TYPE","terminate"),Kn(e,n),(t=new wt(e,e.l,t)).M=2,t.v=zt(jt(n)),n=!1,y.navigator&&y.navigator.sendBeacon)try{n=y.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&y.Image&&((new Image).src=t.v,n=!0),n||(t.g=ir(t.l,null),t.g.ja(t.v)),t.G=Date.now(),Dt(t)}nr(e)}function Un(e){e.g&&(Xn(e),e.g.cancel(),e.g=null)}function zn(e){Un(e),e.u&&(y.clearTimeout(e.u),e.u=null),Jn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&y.clearTimeout(e.m),e.m=null)}function Gn(e){un(e.i)||e.m||(e.m=!0,Ve(e.Qa,e),e.C=0)}function $n(e,t){var n;n=t?t.m:e.Y++;var r=jt(e.I);Ut(r,"SID",e.L),Ut(r,"RID",n),Ut(r,"AID",e.X),Kn(e,r),e.o&&e.s&&jn(r,e.o,e.s),n=new wt(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.D.concat(e.j)),t=Hn(e,n,1e3),n.setTimeout(Math.round(.5*e.Aa)+Math.round(.5*e.Aa*Math.random())),dn(e.i,n),It(n,r,t)}function Kn(e,t){e.qa&&oe(e.qa,(function(e,n){Ut(t,n,e)})),e.h&&Pt({},(function(e,n){Ut(t,n,e)}))}function Hn(e,t,n){n=Math.min(e.j.length,n);var r=e.h?T(e.h.Ya,e.h,e):null;e:for(var i=e.j,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].g,l=i[c].map;if(0>(u-=s))s=Math.max(0,i[c].g-100),a=!1;else try{yn(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.j.splice(0,n),t.D=e,r}function Qn(e){e.g||e.u||(e.da=1,Ve(e.Pa,e),e.A=0)}function Wn(e){return!(e.g||e.u||3<=e.A||(e.da++,e.u=ct(T(e.Pa,e),er(e,e.A)),e.A++,0))}function Xn(e){null!=e.B&&(y.clearTimeout(e.B),e.B=null)}function Yn(e){e.g=new wt(e,e.l,"rpc",e.da),null===e.o&&(e.g.I=e.s),e.g.P=0;var t=jt(e.za);Ut(t,"RID","rpc"),Ut(t,"SID",e.L),Ut(t,"AID",e.X),Ut(t,"CI",e.G?"0":"1"),!e.G&&e.ta&&Ut(t,"TO",e.ta),Ut(t,"TYPE","xmlhttp"),Kn(e,t),e.o&&e.s&&jn(t,e.o,e.s),e.M&&e.g.setTimeout(e.M);var n=e.g;e=e.sa,n.M=1,n.v=zt(jt(t)),n.s=null,n.T=!0,Tt(n,e)}function Jn(e){null!=e.v&&(y.clearTimeout(e.v),e.v=null)}function Zn(e,t){var n=null;if(e.g==t){Jn(e),Xn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,fn(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;Se(r=nt(),new at(r,n,t,i)),Gn(e)}else Qn(e);else if(3==(i=t.o)||0==i&&0<t.ea||!(1==r&&function(e,t){return!(ln(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.D.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.gb?0:e.hb)||(e.m=ct(T(e.Qa,e,t),er(e,e.C)),e.C++,0)))}(e,t)||2==r&&Wn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:tr(e,5);break;case 4:tr(e,10);break;case 3:tr(e,6);break;default:tr(e,2)}}function er(e,t){var n=e.eb+Math.floor(Math.random()*e.kb);return e.isActive()||(n*=2),n*t}function tr(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=T(e.sb,e);n||(n=new Ft("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||Vt(n,"https"),zt(n)),function(e,t){var n=new Je;if(y.Image){var r=new Image;r.onload=S(vn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=S(vn,n,r,"TestLoadImage: error",!1,t),r.onabort=S(vn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=S(vn,n,r,"TestLoadImage: timeout",!1,t),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ot(2);e.H=0,e.h&&e.h.Ca(t),nr(e),zn(e)}function nr(e){if(e.H=0,e.pa=[],e.h){var t=pn(e.i);0==t.length&&0==e.j.length||(O(e.pa,t),O(e.pa,e.j),e.i.i.length=0,L(e.j),e.j.length=0),e.h.Ba()}}function rr(e,t,n){var r=n instanceof Ft?jt(n):new Ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Bt(r,r.o);else{var i=y.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Ft(null);r&&Vt(s,r),t&&(s.g=t),i&&Bt(s,i),n&&(s.h=n),r=s}return n=e.D,t=e.Ga,n&&t&&Ut(r,n,t),Ut(r,"VER",e.ua),Kn(e,r),r}function ir(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ka&&!e.ya?new Sn(new wn({rb:!0})):new Sn(e.ya)).Ra(e.J),t}function sr(){}function or(){if(G&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function ar(e,t){Te.call(this),this.g=new Bn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Fa&&(e?e["X-WebChannel-Client-Profile"]=t.Fa:e={"X-WebChannel-Client-Profile":t.Fa}),this.g.W=e,(e=t&&t.fc)&&!R(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!R(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new lr(this)}function cr(e){mt.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){yt.call(this),this.status=1}function lr(e){this.g=e}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function dr(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function fr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(t=Sn.prototype).Ra=function(e){this.N=e},t.ja=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():pt.g(),this.C=this.u?dt(this.u):dt(pt),this.g.onreadystatechange=T(this.Oa,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void kn(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(var o=(s=i(r.keys())).next();!o.done;o=s.next())o=o.value,n.set(o,r.get(o))}for(r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=y.FormData&&e instanceof y.FormData,!(0<=N(Dn,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r=(t=i(n)).next();!r.done;r=t.next())r=(n=i(r.value)).next().value,n=n.next().value,this.g.setRequestHeader(r,n);this.L&&(this.g.responseType=this.L),"withCredentials"in this.g&&this.g.withCredentials!==this.N&&(this.g.withCredentials=this.N);try{Mn(this),0<this.B&&((this.M=function(e){return G&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=T(this.xa,this)):this.A=ze(this.xa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){kn(this,e)}},t.xa=function(){void 0!==m&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Se(this,"timeout"),this.abort(8))},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Se(this,"complete"),Se(this,"abort"),On(this))},t.O=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),On(this,!0)),Sn.Z.O.call(this)},t.Oa=function(){this.s||(this.G||this.v||this.l?Ln(this):this.nb())},t.nb=function(){Ln(this)},t.isActive=function(){return!!this.g},t.fa=function(){try{return 2<Pn(this)?this.g.status:-1}catch(e){return-1}},t.ma=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.Za=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Tn(t)}},t.La=function(){return this.m},t.Va=function(){return"string"==typeof this.j?this.j:String(this.j)},(t=Bn.prototype).ua=8,t.H=1,t.Qa=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.Y=Math.floor(1e5*Math.random()),e=this.Y++;var t,n=new wt(this,this.l,e),r=this.s;if(this.W&&(r?ue(r=ae(r),this.W):r=this.W),null!==this.o||this.P||(n.I=r,r=null),this.R)e:{for(var i=t=0;i<this.j.length;i++){var s=this.j[i];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=i;break e}if(4096===t||i===this.j.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Hn(this,n,t),Ut(i=jt(this.I),"RID",e),Ut(i,"CVER",22),this.D&&Ut(i,"X-HTTP-Session-Id",this.D),Kn(this,i),r&&(this.P?t="headers="+encodeURIComponent(String(Fn(r)))+"&"+t:this.o&&jn(i,this.o,r)),dn(this.i,n),this.fb&&Ut(i,"TYPE","init"),this.R?(Ut(i,"$req",t),Ut(i,"SID","null"),n.ca=!0,It(n,i,null)):It(n,i,t),this.H=2}}else 3==this.H&&(e?$n(this,e):0==this.j.length||un(this.i)||$n(this))},t.Pa=function(){if(this.u=null,Yn(this),this.ea&&!(this.N||null==this.g||0>=this.T)){var e=2*this.T;this.l.info("BP detection timer enabled: "+e),this.B=ct(T(this.mb,this),e)}},t.mb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.N=!0,ot(10),Un(this),Yn(this))},t.lb=function(){null!=this.v&&(this.v=null,Un(this),Wn(this),ot(19))},t.sb=function(e){e?(this.l.info("Successfully pinged google.com"),ot(2)):(this.l.info("Failed to ping google.com"),ot(1))},t.isActive=function(){return!!this.h&&this.h.isActive(this)},(t=sr.prototype).Ea=function(){},t.Da=function(){},t.Ca=function(){},t.Ba=function(){},t.isActive=function(){return!0},t.Ya=function(){},or.prototype.g=function(e,t){return new ar(e,t)},C(ar,Te),ar.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ot(0),e.aa=t,e.qa=n||{},e.G=e.ca,e.I=rr(e,null,e.aa),Gn(e)},ar.prototype.close=function(){qn(this.g)},ar.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Ae(e),e=n);t.j.push(new on(t.ib++,e)),3==t.H&&Gn(t)},ar.prototype.O=function(){this.g.h=null,delete this.j,qn(this.g),delete this.g,ar.Z.O.call(this)},C(cr,mt),C(ur,yt),C(lr,sr),lr.prototype.Ea=function(){Se(this.g,"a")},lr.prototype.Da=function(e){Se(this.g,new cr(e))},lr.prototype.Ca=function(e){Se(this.g,new ur(e))},lr.prototype.Ba=function(){Se(this.g,"b")},C(hr,(function(){this.blockSize=-1})),hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},hr.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)dr(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){dr(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){dr(this,r),i=0;break}}this.h=i,this.i+=t},hr.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var pr={};function gr(e){return-128<=e&&128>e?function(e,t){var n=pr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new fr([0|e],0>e?-1:0)}(e)}(e):new fr([0|e],0>e?-1:0)}function mr(e){if(isNaN(e)||!isFinite(e))return vr;if(0>e)return Er(mr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=yr;return new fr(t,0)}var yr=4294967296,vr=gr(0),wr=gr(1),br=gr(16777216);function _r(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function xr(e){return-1==e.h}function Er(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new fr(n,~e.h).add(wr)}function Ir(e,t){return e.add(Er(t))}function Tr(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Sr(e,t){this.g=e,this.h=t}function Cr(e,t){if(_r(t))throw Error("division by zero");if(_r(e))return new Sr(vr,vr);if(xr(e))return t=Cr(Er(e),t),new Sr(Er(t.g),Er(t.h));if(xr(t))return t=Cr(e,Er(t)),new Sr(Er(t.g),t.h);if(30<e.g.length){if(xr(e)||xr(t))throw Error("slowDivide_ only works with positive integers.");for(var n=wr,r=t;0>=r.$(e);)n=Ar(n),r=Ar(r);var i=Dr(n,1),s=Dr(r,1);for(r=Dr(r,2),n=Dr(n,2);!_r(r);){var o=s.add(r);0>=o.$(e)&&(i=i.add(n),s=o),r=Dr(r,1),n=Dr(n,1)}return t=Ir(e,i.S(t)),new Sr(i,t)}for(i=vr;0<=e.$(t);){for(n=Math.max(1,Math.floor(e.ga()/t.ga())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=mr(n)).S(t);xr(o)||0<o.$(e);)o=(s=mr(n-=r)).S(t);_r(s)&&(s=wr),i=i.add(s),e=Ir(e,o)}return new Sr(i,e)}function Ar(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.F(r)<<1|e.F(r-1)>>>31;return new fr(n,e.h)}function Dr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.F(s+n)>>>t|e.F(s+n+1)<<32-t:e.F(s+n);return new fr(i,e.h)}(t=fr.prototype).ga=function(){if(xr(this))return-Er(this).ga();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.F(n);e+=(0<=r?r:yr+r)*t,t*=yr}return e},t.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(_r(this))return"0";if(xr(this))return"-"+Er(this).toString(e);for(var t=mr(Math.pow(e,6)),n=this,r="";;){var i=Cr(n,t).g,s=((0<(n=Ir(n,i.S(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(_r(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.F=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},t.$=function(e){return xr(e=Ir(this,e))?-1:_r(e)?0:1},t.abs=function(){return xr(this)?Er(this):this},t.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.F(i))+(65535&e.F(i)),o=(s>>>16)+(this.F(i)>>>16)+(e.F(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new fr(n,-2147483648&n[n.length-1]?-1:0)},t.S=function(e){if(_r(this)||_r(e))return vr;if(xr(this))return xr(e)?Er(this).S(Er(e)):Er(Er(this).S(e));if(xr(e))return Er(this.S(Er(e)));if(0>this.$(br)&&0>e.$(br))return mr(this.ga()*e.ga());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.F(r)>>>16,o=65535&this.F(r),a=e.F(i)>>>16,c=65535&e.F(i);n[2*r+2*i]+=o*c,Tr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Tr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Tr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Tr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new fr(n,0)},t.jb=function(e){return Cr(this,e).h},t.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)&e.F(r);return new fr(n,this.h&e.h)},t.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)|e.F(r);return new fr(n,this.h|e.h)},t.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)^e.F(r);return new fr(n,this.h^e.h)},or.prototype.createWebChannel=or.prototype.g,ar.prototype.send=ar.prototype.u,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,lt.COMPLETE="complete",ft.EventType=gt,gt.OPEN="a",gt.CLOSE="b",gt.ERROR="c",gt.MESSAGE="d",Te.prototype.listen=Te.prototype.P,Sn.prototype.listenOnce=Sn.prototype.R,Sn.prototype.getLastError=Sn.prototype.Va,Sn.prototype.getLastErrorCode=Sn.prototype.La,Sn.prototype.getStatus=Sn.prototype.fa,Sn.prototype.getResponseJson=Sn.prototype.Za,Sn.prototype.getResponseText=Sn.prototype.ma,Sn.prototype.send=Sn.prototype.ja,Sn.prototype.setWithCredentials=Sn.prototype.Ra,hr.prototype.digest=hr.prototype.l,hr.prototype.reset=hr.prototype.reset,hr.prototype.update=hr.prototype.j,fr.prototype.add=fr.prototype.add,fr.prototype.multiply=fr.prototype.S,fr.prototype.modulo=fr.prototype.jb,fr.prototype.compare=fr.prototype.$,fr.prototype.toNumber=fr.prototype.ga,fr.prototype.toString=fr.prototype.toString,fr.prototype.getBits=fr.prototype.F,fr.fromNumber=mr,fr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Er(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=mr(Math.pow(n,8)),i=vr,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=mr(Math.pow(n,o)),i=i.S(o).add(mr(a))):i=(i=i.S(r)).add(mr(a))}return i},e.exports.createWebChannelTransport=function(){return new or},e.exports.getStatEventTarget=function(){return nt()},e.exports.ErrorCode=ut,e.exports.EventType=lt,e.exports.Event=et,e.exports.Stat={Ab:0,Db:1,Eb:2,Xb:3,bc:4,Zb:5,$b:6,Yb:7,Wb:8,ac:9,PROXY:10,NOPROXY:11,Ub:12,Qb:13,Rb:14,Pb:15,Sb:16,Tb:17,wb:18,vb:19,xb:20},e.exports.FetchXmlHttpFactory=wn,e.exports.WebChannel=ft,e.exports.XhrIo=Sn,e.exports.Md5=hr,e.exports.Integer=fr}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},923:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(752);r.registerVersion("firebase","10.5.0","app"),Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},755:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(r,i){"use strict";var s=[],o=Object.getPrototypeOf,a=s.slice,c=s.flat?function(e){return s.flat.call(e)}:function(e){return s.concat.apply([],e)},u=s.push,l=s.indexOf,h={},d=h.toString,f=h.hasOwnProperty,p=f.toString,g=p.call(Object),m={},y=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},w=r.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function _(e,t,n){var r,i,s=(n=n||w).createElement("script");if(s.text=e,t)for(r in b)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&s.setAttribute(r,i);n.head.appendChild(s).parentNode.removeChild(s)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?h[d.call(e)]||"object":typeof e}var E="3.7.1",I=/HTML$/i,T=function(e,t){return new T.fn.init(e,t)};function S(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!y(e)&&!v(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function C(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}T.fn=T.prototype={jquery:E,constructor:T,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=T.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return T.each(this,e)},map:function(e){return this.pushStack(T.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(T.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:s.sort,splice:s.splice},T.extend=T.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},a=1,c=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[a]||{},a++),"object"==typeof o||y(o)||(o={}),a===c&&(o=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(u&&r&&(T.isPlainObject(r)||(i=Array.isArray(r)))?(n=o[t],s=i&&!Array.isArray(n)?[]:i||T.isPlainObject(n)?n:{},i=!1,o[t]=T.extend(u,s,r)):void 0!==r&&(o[t]=r));return o},T.extend({expando:"jQuery"+(E+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==d.call(e)||(t=o(e))&&("function"!=typeof(n=f.call(t,"constructor")&&t.constructor)||p.call(n)!==g))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){_(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(S(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r++];)n+=T.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(S(Object(e))?T.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:l.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!I.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,s=e.length,o=!n;i<s;i++)!t(e[i],i)!==o&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,o=[];if(S(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&o.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&o.push(i);return c(o)},guid:1,support:m}),"function"==typeof Symbol&&(T.fn[Symbol.iterator]=s[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){h["[object "+t+"]"]=t.toLowerCase()}));var A=s.pop,D=s.sort,k=s.splice,N="[\\x20\\t\\r\\n\\f]",L=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g");T.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var O=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function M(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}T.escapeSelector=function(e){return(e+"").replace(O,M)};var P=w,R=u;!function(){var e,t,n,i,o,c,u,h,d,p,g=R,y=T.expando,v=0,w=0,b=ee(),_=ee(),x=ee(),E=ee(),I=function(e,t){return e===t&&(o=!0),0},S="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="(?:\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",M="\\["+N+"*("+O+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+N+"*\\]",F=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",j=new RegExp(N+"+","g"),V=new RegExp("^"+N+"*,"+N+"*"),B=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),q=new RegExp(N+"|>"),U=new RegExp(F),z=new RegExp("^"+O+"$"),G={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+S+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},$=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,H=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,W=new RegExp("\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\([^\\r\\n\\f])","g"),X=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},Y=function(){ce()},J=de((function(e){return!0===e.disabled&&C(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(s=a.call(P.childNodes),P.childNodes),s[P.childNodes.length].nodeType}catch(e){g={apply:function(e,t){R.apply(e,a.call(t))},call:function(e){R.apply(e,a.call(arguments,1))}}}function Z(e,t,n,r){var i,s,o,a,u,l,f,p=t&&t.ownerDocument,v=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==v&&9!==v&&11!==v)return n;if(!r&&(ce(t),t=t||c,h)){if(11!==v&&(u=H.exec(e)))if(i=u[1]){if(9===v){if(!(o=t.getElementById(i)))return n;if(o.id===i)return g.call(n,o),n}else if(p&&(o=p.getElementById(i))&&Z.contains(t,o)&&o.id===i)return g.call(n,o),n}else{if(u[2])return g.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&t.getElementsByClassName)return g.apply(n,t.getElementsByClassName(i)),n}if(!(E[e+" "]||d&&d.test(e))){if(f=e,p=t,1===v&&(q.test(e)||B.test(e))){for((p=Q.test(e)&&ae(t.parentNode)||t)==t&&m.scope||((a=t.getAttribute("id"))?a=T.escapeSelector(a):t.setAttribute("id",a=y)),s=(l=le(e)).length;s--;)l[s]=(a?"#"+a:":scope")+" "+he(l[s]);f=l.join(",")}try{return g.apply(n,p.querySelectorAll(f)),n}catch(t){E(e,!0)}finally{a===y&&t.removeAttribute("id")}}}return ve(e.replace(L,"$1"),t,n,r)}function ee(){var e=[];return function n(r,i){return e.push(r+" ")>t.cacheLength&&delete n[e.shift()],n[r+" "]=i}}function te(e){return e[y]=!0,e}function ne(e){var t=c.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function re(e){return function(t){return C(t,"input")&&t.type===e}}function ie(e){return function(t){return(C(t,"input")||C(t,"button"))&&t.type===e}}function se(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&J(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function oe(e){return te((function(t){return t=+t,te((function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function ce(e){var n,r=e?e.ownerDocument||e:P;return r!=c&&9===r.nodeType&&r.documentElement?(u=(c=r).documentElement,h=!T.isXMLDoc(c),p=u.matches||u.webkitMatchesSelector||u.msMatchesSelector,u.msMatchesSelector&&P!=c&&(n=c.defaultView)&&n.top!==n&&n.addEventListener("unload",Y),m.getById=ne((function(e){return u.appendChild(e).id=T.expando,!c.getElementsByName||!c.getElementsByName(T.expando).length})),m.disconnectedMatch=ne((function(e){return p.call(e,"*")})),m.scope=ne((function(){return c.querySelectorAll(":scope")})),m.cssHas=ne((function(){try{return c.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),m.getById?(t.filter.ID=function(e){var t=e.replace(W,X);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(W,X);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n,r,i,s=t.getElementById(e);if(s){if((n=s.getAttributeNode("id"))&&n.value===e)return[s];for(i=t.getElementsByName(e),r=0;s=i[r++];)if((n=s.getAttributeNode("id"))&&n.value===e)return[s]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&h)return t.getElementsByClassName(e)},d=[],ne((function(e){var t;u.appendChild(e).innerHTML="<a id='"+y+"' href='' disabled='disabled'></a><select id='"+y+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+N+"*(?:value|"+S+")"),e.querySelectorAll("[id~="+y+"-]").length||d.push("~="),e.querySelectorAll("a#"+y+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=c.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),u.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=c.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+N+"*name"+N+"*="+N+"*(?:''|\"\")")})),m.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),I=function(e,t){if(e===t)return o=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!m.sortDetached&&t.compareDocumentPosition(e)===n?e===c||e.ownerDocument==P&&Z.contains(P,e)?-1:t===c||t.ownerDocument==P&&Z.contains(P,t)?1:i?l.call(i,e)-l.call(i,t):0:4&n?-1:1)},c):c}for(e in Z.matches=function(e,t){return Z(e,null,null,t)},Z.matchesSelector=function(e,t){if(ce(e),h&&!E[t+" "]&&(!d||!d.test(t)))try{var n=p.call(e,t);if(n||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){E(t,!0)}return Z(t,c,null,[e]).length>0},Z.contains=function(e,t){return(e.ownerDocument||e)!=c&&ce(e),T.contains(e,t)},Z.attr=function(e,n){(e.ownerDocument||e)!=c&&ce(e);var r=t.attrHandle[n.toLowerCase()],i=r&&f.call(t.attrHandle,n.toLowerCase())?r(e,n,!h):void 0;return void 0!==i?i:e.getAttribute(n)},Z.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},T.uniqueSort=function(e){var t,n=[],r=0,s=0;if(o=!m.sortStable,i=!m.sortStable&&a.call(e,0),D.call(e,I),o){for(;t=e[s++];)t===e[s]&&(r=n.push(s));for(;r--;)k.call(e,n[r],1)}return i=null,e},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(a.apply(this)))},t=T.expr={cacheLength:50,createPseudo:te,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(W,X),e[3]=(e[3]||e[4]||e[5]||"").replace(W,X),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Z.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Z.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&U.test(n)&&(t=le(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(W,X).toLowerCase();return"*"===e?function(){return!0}:function(e){return C(e,t)}},CLASS:function(e){var t=b[e+" "];return t||(t=new RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&b(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=Z.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(j," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,l,h,d,f,p=s!==o?"nextSibling":"previousSibling",g=t.parentNode,m=a&&t.nodeName.toLowerCase(),w=!c&&!a,b=!1;if(g){if(s){for(;p;){for(h=t;h=h[p];)if(a?C(h,m):1===h.nodeType)return!1;f=p="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&w){for(b=(d=(u=(l=g[y]||(g[y]={}))[e]||[])[0]===v&&u[1])&&u[2],h=d&&g.childNodes[d];h=++d&&h&&h[p]||(b=d=0)||f.pop();)if(1===h.nodeType&&++b&&h===t){l[e]=[v,d,b];break}}else if(w&&(b=d=(u=(l=t[y]||(t[y]={}))[e]||[])[0]===v&&u[1]),!1===b)for(;(h=++d&&h&&h[p]||(b=d=0)||f.pop())&&(!(a?C(h,m):1===h.nodeType)||!++b||(w&&((l=h[y]||(h[y]={}))[e]=[v,b]),h!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,n){var r,i=t.pseudos[e]||t.setFilters[e.toLowerCase()]||Z.error("unsupported pseudo: "+e);return i[y]?i(n):i.length>1?(r=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var r,s=i(e,n),o=s.length;o--;)e[r=l.call(e,s[o])]=!(t[r]=s[o])})):function(e){return i(e,0,r)}):i}},pseudos:{not:te((function(e){var t=[],n=[],r=ye(e.replace(L,"$1"));return r[y]?te((function(e,t,n,i){for(var s,o=r(e,null,i,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))})):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return Z(e,t).length>0}})),contains:te((function(e){return e=e.replace(W,X),function(t){return(t.textContent||T.text(t)).indexOf(e)>-1}})),lang:te((function(e){return z.test(e||"")||Z.error("unsupported lang: "+e),e=e.replace(W,X).toLowerCase(),function(t){var n;do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===u},focus:function(e){return e===function(){try{return c.activeElement}catch(e){}}()&&c.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:se(!1),disabled:se(!0),checked:function(e){return C(e,"input")&&!!e.checked||C(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return $.test(e.nodeName)},button:function(e){return C(e,"input")&&"button"===e.type||C(e,"button")},text:function(e){var t;return C(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,t){return[t-1]})),eq:oe((function(e,t,n){return[n<0?n+t:n]})),even:oe((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:oe((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:oe((function(e,t,n){var r;for(r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:oe((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=re(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=ie(e);function ue(){}function le(e,n){var r,i,s,o,a,c,u,l=_[e+" "];if(l)return n?0:l.slice(0);for(a=e,c=[],u=t.preFilter;a;){for(o in r&&!(i=V.exec(a))||(i&&(a=a.slice(i[0].length)||a),c.push(s=[])),r=!1,(i=B.exec(a))&&(r=i.shift(),s.push({value:r,type:i[0].replace(L," ")}),a=a.slice(r.length)),t.filter)!(i=G[o].exec(a))||u[o]&&!(i=u[o](i))||(r=i.shift(),s.push({value:r,type:o,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?Z.error(e):_(e,c).slice(0)}function he(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function de(e,t,n){var r=t.dir,i=t.next,s=i||r,o=n&&"parentNode"===s,a=w++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i);return!1}:function(t,n,c){var u,l,h=[v,a];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(l=t[y]||(t[y]={}),i&&C(t,i))t=t[r]||t;else{if((u=l[s])&&u[0]===v&&u[1]===a)return h[2]=u[2];if(l[s]=h,h[2]=e(t,n,c))return!0}return!1}}function fe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function pe(e,t,n,r,i){for(var s,o=[],a=0,c=e.length,u=null!=t;a<c;a++)(s=e[a])&&(n&&!n(s,r,i)||(o.push(s),u&&t.push(a)));return o}function ge(e,t,n,r,i,s){return r&&!r[y]&&(r=ge(r)),i&&!i[y]&&(i=ge(i,s)),te((function(s,o,a,c){var u,h,d,f,p=[],m=[],y=o.length,v=s||function(e,t,n){for(var r=0,i=t.length;r<i;r++)Z(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),w=!e||!s&&t?v:pe(v,p,e,a,c);if(n?n(w,f=i||(s?e:y||r)?[]:o,a,c):f=w,r)for(u=pe(f,m),r(u,[],a,c),h=u.length;h--;)(d=u[h])&&(f[m[h]]=!(w[m[h]]=d));if(s){if(i||e){if(i){for(u=[],h=f.length;h--;)(d=f[h])&&u.push(w[h]=d);i(null,f=[],u,c)}for(h=f.length;h--;)(d=f[h])&&(u=i?l.call(s,d):p[h])>-1&&(s[u]=!(o[u]=d))}}else f=pe(f===o?f.splice(y,f.length):f),i?i(null,o,f,c):g.apply(o,f)}))}function me(e){for(var r,i,s,o=e.length,a=t.relative[e[0].type],c=a||t.relative[" "],u=a?1:0,h=de((function(e){return e===r}),c,!0),d=de((function(e){return l.call(r,e)>-1}),c,!0),f=[function(e,t,i){var s=!a&&(i||t!=n)||((r=t).nodeType?h(e,t,i):d(e,t,i));return r=null,s}];u<o;u++)if(i=t.relative[e[u].type])f=[de(fe(f),i)];else{if((i=t.filter[e[u].type].apply(null,e[u].matches))[y]){for(s=++u;s<o&&!t.relative[e[s].type];s++);return ge(u>1&&fe(f),u>1&&he(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(L,"$1"),i,u<s&&me(e.slice(u,s)),s<o&&me(e=e.slice(s)),s<o&&he(e))}f.push(i)}return fe(f)}function ye(e,r){var i,s=[],o=[],a=x[e+" "];if(!a){for(r||(r=le(e)),i=r.length;i--;)(a=me(r[i]))[y]?s.push(a):o.push(a);a=x(e,function(e,r){var i=r.length>0,s=e.length>0,o=function(o,a,u,l,d){var f,p,m,y=0,w="0",b=o&&[],_=[],x=n,E=o||s&&t.find.TAG("*",d),I=v+=null==x?1:Math.random()||.1,S=E.length;for(d&&(n=a==c||a||d);w!==S&&null!=(f=E[w]);w++){if(s&&f){for(p=0,a||f.ownerDocument==c||(ce(f),u=!h);m=e[p++];)if(m(f,a||c,u)){g.call(l,f);break}d&&(v=I)}i&&((f=!m&&f)&&y--,o&&b.push(f))}if(y+=w,i&&w!==y){for(p=0;m=r[p++];)m(b,_,a,u);if(o){if(y>0)for(;w--;)b[w]||_[w]||(_[w]=A.call(l));_=pe(_)}g.apply(l,_),d&&!o&&_.length>0&&y+r.length>1&&T.uniqueSort(l)}return d&&(v=I,n=x),b};return i?te(o):o}(o,s)),a.selector=e}return a}function ve(e,n,r,i){var s,o,a,c,u,l="function"==typeof e&&e,d=!i&&le(e=l.selector||e);if(r=r||[],1===d.length){if((o=d[0]=d[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===n.nodeType&&h&&t.relative[o[1].type]){if(!(n=(t.find.ID(a.matches[0].replace(W,X),n)||[])[0]))return r;l&&(n=n.parentNode),e=e.slice(o.shift().value.length)}for(s=G.needsContext.test(e)?0:o.length;s--&&(a=o[s],!t.relative[c=a.type]);)if((u=t.find[c])&&(i=u(a.matches[0].replace(W,X),Q.test(o[0].type)&&ae(n.parentNode)||n))){if(o.splice(s,1),!(e=i.length&&he(o)))return g.apply(r,i),r;break}}return(l||ye(e,d))(i,n,!h,r,!n||Q.test(e)&&ae(n.parentNode)||n),r}ue.prototype=t.filters=t.pseudos,t.setFilters=new ue,m.sortStable=y.split("").sort(I).join("")===y,ce(),m.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(c.createElement("fieldset"))})),T.find=Z,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,Z.compile=ye,Z.select=ve,Z.setDocument=ce,Z.tokenize=le,Z.escape=T.escapeSelector,Z.getText=T.text,Z.isXML=T.isXMLDoc,Z.selectors=T.expr,Z.support=T.support,Z.uniqueSort=T.uniqueSort}();var F=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&T(e).is(n))break;r.push(e)}return r},j=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},V=T.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function q(e,t,n){return y(t)?T.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?T.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?T.grep(e,(function(e){return l.call(t,e)>-1!==n})):T.filter(t,e,n)}T.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?T.find.matchesSelector(r,e)?[r]:[]:T.find.matches(e,T.grep(t,(function(e){return 1===e.nodeType})))},T.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(T(e).filter((function(){for(t=0;t<r;t++)if(T.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)T.find(e,i[t],n);return r>1?T.uniqueSort(n):n},filter:function(e){return this.pushStack(q(this,e||[],!1))},not:function(e){return this.pushStack(q(this,e||[],!0))},is:function(e){return!!q(this,"string"==typeof e&&V.test(e)?T(e):e||[],!1).length}});var U,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||U,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:z.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof T?t[0]:t,T.merge(this,T.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:w,!0)),B.test(r[1])&&T.isPlainObject(t))for(r in t)y(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=w.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):y(e)?void 0!==n.ready?n.ready(e):e(T):T.makeArray(e,this)}).prototype=T.fn,U=T(w);var G=/^(?:parents|prev(?:Until|All))/,$={children:!0,contents:!0,next:!0,prev:!0};function K(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}T.fn.extend({has:function(e){var t=T(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(T.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,s=[],o="string"!=typeof e&&T(e);if(!V.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&T.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?T.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?l.call(T(e),this[0]):l.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),T.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return F(e,"parentNode")},parentsUntil:function(e,t,n){return F(e,"parentNode",n)},next:function(e){return K(e,"nextSibling")},prev:function(e){return K(e,"previousSibling")},nextAll:function(e){return F(e,"nextSibling")},prevAll:function(e){return F(e,"previousSibling")},nextUntil:function(e,t,n){return F(e,"nextSibling",n)},prevUntil:function(e,t,n){return F(e,"previousSibling",n)},siblings:function(e){return j((e.parentNode||{}).firstChild,e)},children:function(e){return j(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(C(e,"template")&&(e=e.content||e),T.merge([],e.childNodes))}},(function(e,t){T.fn[e]=function(n,r){var i=T.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=T.filter(r,i)),this.length>1&&($[e]||T.uniqueSort(i),G.test(e)&&i.reverse()),this.pushStack(i)}}));var H=/[^\x20\t\r\n\f]+/g;function Q(e){return e}function W(e){throw e}function X(e,t,n,r){var i;try{e&&y(i=e.promise)?i.call(e).done(t).fail(n):e&&y(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}T.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return T.each(e.match(H)||[],(function(e,n){t[n]=!0})),t}(e):T.extend({},e);var t,n,r,i,s=[],o=[],a=-1,c=function(){for(i=i||e.once,r=t=!0;o.length;a=-1)for(n=o.shift();++a<s.length;)!1===s[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=s.length,n=!1);e.memory||(n=!1),t=!1,i&&(s=n?[]:"")},u={add:function(){return s&&(n&&!t&&(a=s.length-1,o.push(n)),function t(n){T.each(n,(function(n,r){y(r)?e.unique&&u.has(r)||s.push(r):r&&r.length&&"string"!==x(r)&&t(r)}))}(arguments),n&&!t&&c()),this},remove:function(){return T.each(arguments,(function(e,t){for(var n;(n=T.inArray(t,s,n))>-1;)s.splice(n,1),n<=a&&a--})),this},has:function(e){return e?T.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return i=o=[],s=n="",this},disabled:function(){return!s},lock:function(){return i=o=[],n||t||(s=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},T.extend({Deferred:function(e){var t=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return T.Deferred((function(n){T.each(t,(function(t,r){var i=y(e[r[4]])&&e[r[4]];s[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&y(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,i){var s=0;function o(e,t,n,i){return function(){var a=this,c=arguments,u=function(){var r,u;if(!(e<s)){if((r=n.apply(a,c))===t.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,y(u)?i?u.call(r,o(s,t,Q,i),o(s,t,W,i)):(s++,u.call(r,o(s,t,Q,i),o(s,t,W,i),o(s,t,Q,t.notifyWith))):(n!==Q&&(a=void 0,c=[r]),(i||t.resolveWith)(a,c))}},l=i?u:function(){try{u()}catch(r){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(r,l.error),e+1>=s&&(n!==W&&(a=void 0,c=[r]),t.rejectWith(a,c))}};e?l():(T.Deferred.getErrorHook?l.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(l.error=T.Deferred.getStackHook()),r.setTimeout(l))}}return T.Deferred((function(r){t[0][3].add(o(0,r,y(i)?i:Q,r.notifyWith)),t[1][3].add(o(0,r,y(e)?e:Q)),t[2][3].add(o(0,r,y(n)?n:W))})).promise()},promise:function(e){return null!=e?T.extend(e,i):i}},s={};return T.each(t,(function(e,r){var o=r[2],a=r[5];i[r[1]]=o.add,a&&o.add((function(){n=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(r[3].fire),s[r[0]]=function(){return s[r[0]+"With"](this===s?void 0:this,arguments),this},s[r[0]+"With"]=o.fireWith})),i.promise(s),e&&e.call(s,s),s},when:function(e){var t=arguments.length,n=t,r=Array(n),i=a.call(arguments),s=T.Deferred(),o=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?a.call(arguments):n,--t||s.resolveWith(r,i)}};if(t<=1&&(X(e,s.done(o(n)).resolve,s.reject,!t),"pending"===s.state()||y(i[n]&&i[n].then)))return s.then();for(;n--;)X(i[n],o(n),s.reject);return s.promise()}});var Y=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&Y.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},T.readyException=function(e){r.setTimeout((function(){throw e}))};var J=T.Deferred();function Z(){w.removeEventListener("DOMContentLoaded",Z),r.removeEventListener("load",Z),T.ready()}T.fn.ready=function(e){return J.then(e).catch((function(e){T.readyException(e)})),this},T.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--T.readyWait:T.isReady)||(T.isReady=!0,!0!==e&&--T.readyWait>0||J.resolveWith(w,[T]))}}),T.ready.then=J.then,"complete"===w.readyState||"loading"!==w.readyState&&!w.documentElement.doScroll?r.setTimeout(T.ready):(w.addEventListener("DOMContentLoaded",Z),r.addEventListener("load",Z));var ee=function(e,t,n,r,i,s,o){var a=0,c=e.length,u=null==n;if("object"===x(n))for(a in i=!0,n)ee(e,t,a,n[a],!0,s,o);else if(void 0!==r&&(i=!0,y(r)||(o=!0),u&&(o?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(T(e),n)})),t))for(;a<c;a++)t(e[a],n,o?r:r.call(e[a],a,t(e[a],n)));return i?e:u?t.call(e):c?t(e[0],n):s},te=/^-ms-/,ne=/-([a-z])/g;function re(e,t){return t.toUpperCase()}function ie(e){return e.replace(te,"ms-").replace(ne,re)}var se=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=T.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var t=e[this.expando];return t||(t={},se(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[ie(t)]=n;else for(r in t)i[ie(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ie(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(ie):(t=ie(t))in r?[t]:t.match(H)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||T.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!T.isEmptyObject(t)}};var ae=new oe,ce=new oe,ue=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,le=/[A-Z]/g;function he(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(le,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ue.test(e)?JSON.parse(e):e)}(n)}catch(e){}ce.set(e,t,n)}else n=void 0;return n}T.extend({hasData:function(e){return ce.hasData(e)||ae.hasData(e)},data:function(e,t,n){return ce.access(e,t,n)},removeData:function(e,t){ce.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),T.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(i=ce.get(s),1===s.nodeType&&!ae.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=ie(r.slice(5)),he(s,r,i[r]));ae.set(s,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){ce.set(this,e)})):ee(this,(function(t){var n;if(s&&void 0===t)return void 0!==(n=ce.get(s,e))||void 0!==(n=he(s,e))?n:void 0;this.each((function(){ce.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){ce.remove(this,e)}))}}),T.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ae.get(e,t),n&&(!r||Array.isArray(n)?r=ae.access(e,t,T.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=T.queue(e,t),r=n.length,i=n.shift(),s=T._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,(function(){T.dequeue(e,t)}),s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:T.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),T.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?T.queue(this[0],e):void 0===t?this:this.each((function(){var n=T.queue(this,e,t);T._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&T.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){T.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=T.Deferred(),s=this,o=this.length,a=function(){--r||i.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=ae.get(s[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var de=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fe=new RegExp("^(?:([+-])=|)("+de+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],ge=w.documentElement,me=function(e){return T.contains(e.ownerDocument,e)},ye={composed:!0};ge.getRootNode&&(me=function(e){return T.contains(e.ownerDocument,e)||e.getRootNode(ye)===e.ownerDocument});var ve=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&me(e)&&"none"===T.css(e,"display")};function we(e,t,n,r){var i,s,o=20,a=r?function(){return r.cur()}:function(){return T.css(e,t,"")},c=a(),u=n&&n[3]||(T.cssNumber[t]?"":"px"),l=e.nodeType&&(T.cssNumber[t]||"px"!==u&&+c)&&fe.exec(T.css(e,t));if(l&&l[3]!==u){for(c/=2,u=u||l[3],l=+c||1;o--;)T.style(e,t,l+u),(1-s)*(1-(s=a()/c||.5))<=0&&(o=0),l/=s;l*=2,T.style(e,t,l+u),n=n||[]}return n&&(l=+l||+c||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=l,r.end=i)),i}var be={};function _e(e){var t,n=e.ownerDocument,r=e.nodeName,i=be[r];return i||(t=n.body.appendChild(n.createElement(r)),i=T.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),be[r]=i,i)}function xe(e,t){for(var n,r,i=[],s=0,o=e.length;s<o;s++)(r=e[s]).style&&(n=r.style.display,t?("none"===n&&(i[s]=ae.get(r,"display")||null,i[s]||(r.style.display="")),""===r.style.display&&ve(r)&&(i[s]=_e(r))):"none"!==n&&(i[s]="none",ae.set(r,"display",n)));for(s=0;s<o;s++)null!=i[s]&&(e[s].style.display=i[s]);return e}T.fn.extend({show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?T(this).show():T(this).hide()}))}});var Ee,Ie,Te=/^(?:checkbox|radio)$/i,Se=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;Ee=w.createDocumentFragment().appendChild(w.createElement("div")),(Ie=w.createElement("input")).setAttribute("type","radio"),Ie.setAttribute("checked","checked"),Ie.setAttribute("name","t"),Ee.appendChild(Ie),m.checkClone=Ee.cloneNode(!0).cloneNode(!0).lastChild.checked,Ee.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!Ee.cloneNode(!0).lastChild.defaultValue,Ee.innerHTML="<option></option>",m.option=!!Ee.lastChild;var Ae={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function De(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&C(e,t)?T.merge([e],n):n}function ke(e,t){for(var n=0,r=e.length;n<r;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}Ae.tbody=Ae.tfoot=Ae.colgroup=Ae.caption=Ae.thead,Ae.th=Ae.td,m.option||(Ae.optgroup=Ae.option=[1,"<select multiple='multiple'>","</select>"]);var Ne=/<|&#?\w+;/;function Le(e,t,n,r,i){for(var s,o,a,c,u,l,h=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((s=e[f])||0===s)if("object"===x(s))T.merge(d,s.nodeType?[s]:s);else if(Ne.test(s)){for(o=o||h.appendChild(t.createElement("div")),a=(Se.exec(s)||["",""])[1].toLowerCase(),c=Ae[a]||Ae._default,o.innerHTML=c[1]+T.htmlPrefilter(s)+c[2],l=c[0];l--;)o=o.lastChild;T.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(t.createTextNode(s));for(h.textContent="",f=0;s=d[f++];)if(r&&T.inArray(s,r)>-1)i&&i.push(s);else if(u=me(s),o=De(h.appendChild(s),"script"),u&&ke(o),n)for(l=0;s=o[l++];)Ce.test(s.type||"")&&n.push(s);return h}var Oe=/^([^.]*)(?:\.(.+)|)/;function Me(){return!0}function Pe(){return!1}function Re(e,t,n,r,i,s){var o,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)Re(e,a,n,r,t[a],s);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Pe;else if(!i)return e;return 1===s&&(o=i,i=function(e){return T().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=T.guid++)),e.each((function(){T.event.add(this,t,i,r,n)}))}function Fe(e,t,n){n?(ae.set(e,t,!1),T.event.add(e,t,{namespace:!1,handler:function(e){var n,r=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(r)(T.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),ae.set(this,t,r),this[t](),n=ae.get(this,t),ae.set(this,t,!1),r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else r&&(ae.set(this,t,T.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Me)}})):void 0===ae.get(e,t)&&T.event.add(e,t,Me)}T.event={global:{},add:function(e,t,n,r,i){var s,o,a,c,u,l,h,d,f,p,g,m=ae.get(e);if(se(e))for(n.handler&&(n=(s=n).handler,i=s.selector),i&&T.find.matchesSelector(ge,i),n.guid||(n.guid=T.guid++),(c=m.events)||(c=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(t){return void 0!==T&&T.event.triggered!==t.type?T.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(H)||[""]).length;u--;)f=g=(a=Oe.exec(t[u])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=T.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,h=T.event.special[f]||{},l=T.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&T.expr.match.needsContext.test(i),namespace:p.join(".")},s),(d=c[f])||((d=c[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,r,p,o)||e.addEventListener&&e.addEventListener(f,o)),h.add&&(h.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,l):d.push(l),T.event.global[f]=!0)},remove:function(e,t,n,r,i){var s,o,a,c,u,l,h,d,f,p,g,m=ae.hasData(e)&&ae.get(e);if(m&&(c=m.events)){for(u=(t=(t||"").match(H)||[""]).length;u--;)if(f=g=(a=Oe.exec(t[u])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=T.event.special[f]||{},d=c[f=(r?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)l=d[s],!i&&g!==l.origType||n&&n.guid!==l.guid||a&&!a.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(d.splice(s,1),l.selector&&d.delegateCount--,h.remove&&h.remove.call(e,l));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,m.handle)||T.removeEvent(e,f,m.handle),delete c[f])}else for(f in c)T.event.remove(e,f+t[u],n,r,!0);T.isEmptyObject(c)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,s,o,a=new Array(arguments.length),c=T.event.fix(e),u=(ae.get(this,"events")||Object.create(null))[c.type]||[],l=T.event.special[c.type]||{};for(a[0]=c,t=1;t<arguments.length;t++)a[t]=arguments[t];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){for(o=T.event.handlers.call(this,c,u),t=0;(i=o[t++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,n=0;(s=i.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==s.namespace&&!c.rnamespace.test(s.namespace)||(c.handleObj=s,c.data=s.data,void 0!==(r=((T.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,a))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,i,s,o,a=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(s=[],o={},n=0;n<c;n++)void 0===o[i=(r=t[n]).selector+" "]&&(o[i]=r.needsContext?T(i,this).index(u)>-1:T.find(i,this,null,[u]).length),o[i]&&s.push(r);s.length&&a.push({elem:u,handlers:s})}return u=this,c<t.length&&a.push({elem:u,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(T.Event.prototype,e,{enumerable:!0,configurable:!0,get:y(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[T.expando]?e:new T.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Te.test(t.type)&&t.click&&C(t,"input")&&Fe(t,"click",!0),!1},trigger:function(e){var t=this||e;return Te.test(t.type)&&t.click&&C(t,"input")&&Fe(t,"click"),!0},_default:function(e){var t=e.target;return Te.test(t.type)&&t.click&&C(t,"input")&&ae.get(t,"click")||C(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},T.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},T.Event=function(e,t){if(!(this instanceof T.Event))return new T.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Me:Pe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&T.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:Pe,isPropagationStopped:Pe,isImmediatePropagationStopped:Pe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Me,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Me,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Me,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(w.documentMode){var n=ae.get(this,"handle"),r=T.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,n(e),r.target===r.currentTarget&&n(r)}else T.event.simulate(t,e.target,T.event.fix(e))}T.event.special[e]={setup:function(){var r;if(Fe(this,e,!0),!w.documentMode)return!1;(r=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(r||0)+1)},trigger:function(){return Fe(this,e),!0},teardown:function(){var e;if(!w.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},T.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=w.documentMode?this:r,s=ae.get(i,t);s||(w.documentMode?this.addEventListener(t,n):r.addEventListener(e,n,!0)),ae.set(i,t,(s||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=w.documentMode?this:r,s=ae.get(i,t)-1;s?ae.set(i,t,s):(w.documentMode?this.removeEventListener(t,n):r.removeEventListener(e,n,!0),ae.remove(i,t))}}})),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){T.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||T.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}})),T.fn.extend({on:function(e,t,n,r){return Re(this,e,t,n,r)},one:function(e,t,n,r){return Re(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,T(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Pe),this.each((function(){T.event.remove(this,e,n,t)}))}});var je=/<script|<style|<link/i,Ve=/checked\s*(?:[^=]|=\s*.checked.)/i,Be=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function qe(e,t){return C(e,"table")&&C(11!==t.nodeType?t:t.firstChild,"tr")&&T(e).children("tbody")[0]||e}function Ue(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ze(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ge(e,t){var n,r,i,s,o,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(i in ae.remove(t,"handle events"),a)for(n=0,r=a[i].length;n<r;n++)T.event.add(t,i,a[i][n]);ce.hasData(e)&&(s=ce.access(e),o=T.extend({},s),ce.set(t,o))}}function $e(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Te.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ke(e,t,n,r){t=c(t);var i,s,o,a,u,l,h=0,d=e.length,f=d-1,p=t[0],g=y(p);if(g||d>1&&"string"==typeof p&&!m.checkClone&&Ve.test(p))return e.each((function(i){var s=e.eq(i);g&&(t[0]=p.call(this,i,s.html())),Ke(s,t,n,r)}));if(d&&(s=(i=Le(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(a=(o=T.map(De(i,"script"),Ue)).length;h<d;h++)u=i,h!==f&&(u=T.clone(u,!0,!0),a&&T.merge(o,De(u,"script"))),n.call(e[h],u,h);if(a)for(l=o[o.length-1].ownerDocument,T.map(o,ze),h=0;h<a;h++)u=o[h],Ce.test(u.type||"")&&!ae.access(u,"globalEval")&&T.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?T._evalUrl&&!u.noModule&&T._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):_(u.textContent.replace(Be,""),u,l))}return e}function He(e,t,n){for(var r,i=t?T.filter(t,e):e,s=0;null!=(r=i[s]);s++)n||1!==r.nodeType||T.cleanData(De(r)),r.parentNode&&(n&&me(r)&&ke(De(r,"script")),r.parentNode.removeChild(r));return e}T.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,s,o,a=e.cloneNode(!0),c=me(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||T.isXMLDoc(e)))for(o=De(a),r=0,i=(s=De(e)).length;r<i;r++)$e(s[r],o[r]);if(t)if(n)for(s=s||De(e),o=o||De(a),r=0,i=s.length;r<i;r++)Ge(s[r],o[r]);else Ge(e,a);return(o=De(a,"script")).length>0&&ke(o,!c&&De(e,"script")),a},cleanData:function(e){for(var t,n,r,i=T.event.special,s=0;void 0!==(n=e[s]);s++)if(se(n)){if(t=n[ae.expando]){if(t.events)for(r in t.events)i[r]?T.event.remove(n,r):T.removeEvent(n,r,t.handle);n[ae.expando]=void 0}n[ce.expando]&&(n[ce.expando]=void 0)}}}),T.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?T.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ke(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,e).appendChild(e)}))},prepend:function(){return Ke(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=qe(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ke(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ke(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(T.cleanData(De(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return T.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!je.test(e)&&!Ae[(Se.exec(e)||["",""])[1].toLowerCase()]){e=T.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(T.cleanData(De(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ke(this,arguments,(function(t){var n=this.parentNode;T.inArray(this,e)<0&&(T.cleanData(De(this)),n&&n.replaceChild(t,this))}),e)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){T.fn[e]=function(e){for(var n,r=[],i=T(e),s=i.length-1,o=0;o<=s;o++)n=o===s?this:this.clone(!0),T(i[o])[t](n),u.apply(r,n.get());return this.pushStack(r)}}));var Qe=new RegExp("^("+de+")(?!px)[a-z%]+$","i"),We=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},Ye=function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=s[i];return r},Je=new RegExp(pe.join("|"),"i");function Ze(e,t,n){var r,i,s,o,a=We.test(t),c=e.style;return(n=n||Xe(e))&&(o=n.getPropertyValue(t)||n[t],a&&o&&(o=o.replace(L,"$1")||void 0),""!==o||me(e)||(o=T.style(e,t)),!m.pixelBoxStyles()&&Qe.test(o)&&Je.test(t)&&(r=c.width,i=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=o,o=n.width,c.width=r,c.minWidth=i,c.maxWidth=s)),void 0!==o?o+"":o}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ge.appendChild(u).appendChild(l);var e=r.getComputedStyle(l);n="1%"!==e.top,c=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),i=36===t(e.width),l.style.position="absolute",s=12===t(l.offsetWidth/3),ge.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,i,s,o,a,c,u=w.createElement("div"),l=w.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===l.style.backgroundClip,T.extend(m,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,t,n,i;return null==a&&(e=w.createElement("table"),t=w.createElement("tr"),n=w.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",ge.appendChild(e).appendChild(t).appendChild(n),i=r.getComputedStyle(t),a=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,ge.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],nt=w.createElement("div").style,rt={};function it(e){return T.cssProps[e]||rt[e]||(e in nt?e:rt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=tt.length;n--;)if((e=tt[n]+t)in nt)return e}(e)||e)}var st=/^(none|table(?!-c[ea]).+)/,ot={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function ct(e,t,n){var r=fe.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function ut(e,t,n,r,i,s){var o="width"===t?1:0,a=0,c=0,u=0;if(n===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(u+=T.css(e,n+pe[o],!0,i)),r?("content"===n&&(c-=T.css(e,"padding"+pe[o],!0,i)),"margin"!==n&&(c-=T.css(e,"border"+pe[o]+"Width",!0,i))):(c+=T.css(e,"padding"+pe[o],!0,i),"padding"!==n?c+=T.css(e,"border"+pe[o]+"Width",!0,i):a+=T.css(e,"border"+pe[o]+"Width",!0,i));return!r&&s>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-s-c-a-.5))||0),c+u}function lt(e,t,n){var r=Xe(e),i=(!m.boxSizingReliable()||n)&&"border-box"===T.css(e,"boxSizing",!1,r),s=i,o=Ze(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Qe.test(o)){if(!n)return o;o="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&C(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===T.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===T.css(e,"boxSizing",!1,r),(s=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+ut(e,t,n||(i?"border":"content"),s,r,o)+"px"}function ht(e,t,n,r,i){return new ht.prototype.init(e,t,n,r,i)}T.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,a=ie(t),c=We.test(t),u=e.style;if(c||(t=it(a)),o=T.cssHooks[t]||T.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(i=o.get(e,!1,r))?i:u[t];"string"==(s=typeof n)&&(i=fe.exec(n))&&i[1]&&(n=we(e,t,i),s="number"),null!=n&&n==n&&("number"!==s||c||(n+=i&&i[3]||(T.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var i,s,o,a=ie(t);return We.test(t)||(t=it(a)),(o=T.cssHooks[t]||T.cssHooks[a])&&"get"in o&&(i=o.get(e,!0,n)),void 0===i&&(i=Ze(e,t,r)),"normal"===i&&t in at&&(i=at[t]),""===n||n?(s=parseFloat(i),!0===n||isFinite(s)?s||0:i):i}}),T.each(["height","width"],(function(e,t){T.cssHooks[t]={get:function(e,n,r){if(n)return!st.test(T.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?lt(e,t,r):Ye(e,ot,(function(){return lt(e,t,r)}))},set:function(e,n,r){var i,s=Xe(e),o=!m.scrollboxSize()&&"absolute"===s.position,a=(o||r)&&"border-box"===T.css(e,"boxSizing",!1,s),c=r?ut(e,t,r,a,s):0;return a&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(s[t])-ut(e,t,"border",!1,s)-.5)),c&&(i=fe.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=T.css(e,t)),ct(0,n,c)}}})),T.cssHooks.marginLeft=et(m.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ze(e,"marginLeft"))||e.getBoundingClientRect().left-Ye(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),T.each({margin:"",padding:"",border:"Width"},(function(e,t){T.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+pe[r]+t]=s[r]||s[r-2]||s[0];return i}},"margin"!==e&&(T.cssHooks[e+t].set=ct)})),T.fn.extend({css:function(e,t){return ee(this,(function(e,t,n){var r,i,s={},o=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;o<i;o++)s[t[o]]=T.css(e,t[o],!1,r);return s}return void 0!==n?T.style(e,t,n):T.css(e,t)}),e,t,arguments.length>1)}}),T.Tween=ht,ht.prototype={constructor:ht,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||T.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(T.cssNumber[n]?"":"px")},cur:function(){var e=ht.propHooks[this.prop];return e&&e.get?e.get(this):ht.propHooks._default.get(this)},run:function(e){var t,n=ht.propHooks[this.prop];return this.options.duration?this.pos=t=T.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ht.propHooks._default.set(this),this}},ht.prototype.init.prototype=ht.prototype,ht.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=T.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){T.fx.step[e.prop]?T.fx.step[e.prop](e):1!==e.elem.nodeType||!T.cssHooks[e.prop]&&null==e.elem.style[it(e.prop)]?e.elem[e.prop]=e.now:T.style(e.elem,e.prop,e.now+e.unit)}}},ht.propHooks.scrollTop=ht.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},T.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},T.fx=ht.prototype.init,T.fx.step={};var dt,ft,pt=/^(?:toggle|show|hide)$/,gt=/queueHooks$/;function mt(){ft&&(!1===w.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(mt):r.setTimeout(mt,T.fx.interval),T.fx.tick())}function yt(){return r.setTimeout((function(){dt=void 0})),dt=Date.now()}function vt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=pe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function wt(e,t,n){for(var r,i=(bt.tweeners[t]||[]).concat(bt.tweeners["*"]),s=0,o=i.length;s<o;s++)if(r=i[s].call(n,t,e))return r}function bt(e,t,n){var r,i,s=0,o=bt.prefilters.length,a=T.Deferred().always((function(){delete c.elem})),c=function(){if(i)return!1;for(var t=dt||yt(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),s=0,o=u.tweens.length;s<o;s++)u.tweens[s].run(r);return a.notifyWith(e,[u,r,n]),r<1&&o?n:(o||a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:T.extend({},t),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},n),originalProperties:t,originalOptions:n,startTime:dt||yt(),duration:n.duration,tweens:[],createTween:function(t,n){var r=T.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u,t])):a.rejectWith(e,[u,t]),this}}),l=u.props;for(function(e,t){var n,r,i,s,o;for(n in e)if(i=t[r=ie(n)],s=e[n],Array.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),(o=T.cssHooks[r])&&"expand"in o)for(n in s=o.expand(s),delete e[r],s)n in e||(e[n]=s[n],t[n]=i);else t[r]=i}(l,u.opts.specialEasing);s<o;s++)if(r=bt.prefilters[s].call(u,e,l,u.opts))return y(r.stop)&&(T._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return T.map(l,wt,u),y(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),T.fx.timer(T.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}T.Animation=T.extend(bt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return we(n.elem,e,fe.exec(t),n),n}]},tweener:function(e,t){y(e)?(t=e,e=["*"]):e=e.match(H);for(var n,r=0,i=e.length;r<i;r++)n=e[r],bt.tweeners[n]=bt.tweeners[n]||[],bt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,s,o,a,c,u,l,h="width"in t||"height"in t,d=this,f={},p=e.style,g=e.nodeType&&ve(e),m=ae.get(e,"fxshow");for(r in n.queue||(null==(o=T._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,T.queue(e,"fx").length||o.empty.fire()}))}))),t)if(i=t[r],pt.test(i)){if(delete t[r],s=s||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}f[r]=m&&m[r]||T.style(e,r)}if((c=!T.isEmptyObject(t))||!T.isEmptyObject(f))for(r in h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=m&&m.display)&&(u=ae.get(e,"display")),"none"===(l=T.css(e,"display"))&&(u?l=u:(xe([e],!0),u=e.style.display||u,l=T.css(e,"display"),xe([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===T.css(e,"float")&&(c||(d.done((function(){p.display=u})),null==u&&(l=p.display,u="none"===l?"":l)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),c=!1,f)c||(m?"hidden"in m&&(g=m.hidden):m=ae.access(e,"fxshow",{display:u}),s&&(m.hidden=!g),g&&xe([e],!0),d.done((function(){for(r in g||xe([e]),ae.remove(e,"fxshow"),f)T.style(e,r,f[r])}))),c=wt(g?m[r]:0,r,d),r in m||(m[r]=c.start,g&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?bt.prefilters.unshift(e):bt.prefilters.push(e)}}),T.speed=function(e,t,n){var r=e&&"object"==typeof e?T.extend({},e):{complete:n||!n&&t||y(e)&&e,duration:e,easing:n&&t||t&&!y(t)&&t};return T.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in T.fx.speeds?r.duration=T.fx.speeds[r.duration]:r.duration=T.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){y(r.old)&&r.old.call(this),r.queue&&T.dequeue(this,r.queue)},r},T.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ve).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=T.isEmptyObject(e),s=T.speed(t,n,r),o=function(){var t=bt(this,T.extend({},e),s);(i||ae.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",s=T.timers,o=ae.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&gt.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));!t&&n||T.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=T.timers,o=r?r.length:0;for(n.finish=!0,T.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),T.each(["toggle","show","hide"],(function(e,t){var n=T.fn[t];T.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(vt(t,!0),e,r,i)}})),T.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){T.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),T.timers=[],T.fx.tick=function(){var e,t=0,n=T.timers;for(dt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||T.fx.stop(),dt=void 0},T.fx.timer=function(e){T.timers.push(e),T.fx.start()},T.fx.interval=13,T.fx.start=function(){ft||(ft=!0,mt())},T.fx.stop=function(){ft=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(e,t){return e=T.fx&&T.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var i=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(i)}}))},function(){var e=w.createElement("input"),t=w.createElement("select").appendChild(w.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=w.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var _t,xt=T.expr.attrHandle;T.fn.extend({attr:function(e,t){return ee(this,T.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){T.removeAttr(this,e)}))}}),T.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===e.getAttribute?T.prop(e,t,n):(1===s&&T.isXMLDoc(e)||(i=T.attrHooks[t.toLowerCase()]||(T.expr.match.bool.test(t)?_t:void 0)),void 0!==n?null===n?void T.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=T.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&C(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(H);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),_t={set:function(e,t,n){return!1===t?T.removeAttr(e,n):e.setAttribute(n,n),n}},T.each(T.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=xt[t]||T.find.attr;xt[t]=function(e,t,r){var i,s,o=t.toLowerCase();return r||(s=xt[o],xt[o]=i,i=null!=n(e,t,r)?o:null,xt[o]=s),i}}));var Et=/^(?:input|select|textarea|button)$/i,It=/^(?:a|area)$/i;function Tt(e){return(e.match(H)||[]).join(" ")}function St(e){return e.getAttribute&&e.getAttribute("class")||""}function Ct(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(H)||[]}T.fn.extend({prop:function(e,t){return ee(this,T.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[T.propFix[e]||e]}))}}),T.extend({prop:function(e,t,n){var r,i,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&T.isXMLDoc(e)||(t=T.propFix[t]||t,i=T.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=T.find.attr(e,"tabindex");return t?parseInt(t,10):Et.test(e.nodeName)||It.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(T.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){T.propFix[this.toLowerCase()]=this})),T.fn.extend({addClass:function(e){var t,n,r,i,s,o;return y(e)?this.each((function(t){T(this).addClass(e.call(this,t,St(this)))})):(t=Ct(e)).length?this.each((function(){if(r=St(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(s=0;s<t.length;s++)i=t[s],n.indexOf(" "+i+" ")<0&&(n+=i+" ");o=Tt(n),r!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var t,n,r,i,s,o;return y(e)?this.each((function(t){T(this).removeClass(e.call(this,t,St(this)))})):arguments.length?(t=Ct(e)).length?this.each((function(){if(r=St(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(s=0;s<t.length;s++)for(i=t[s];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");o=Tt(n),r!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,s,o=typeof e,a="string"===o||Array.isArray(e);return y(e)?this.each((function(n){T(this).toggleClass(e.call(this,n,St(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(n=Ct(e),this.each((function(){if(a)for(s=T(this),i=0;i<n.length;i++)r=n[i],s.hasClass(r)?s.removeClass(r):s.addClass(r);else void 0!==e&&"boolean"!==o||((r=St(this))&&ae.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+Tt(St(n))+" ").indexOf(t)>-1)return!0;return!1}});var At=/\r/g;T.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=y(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,T(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=T.map(i,(function(e){return null==e?"":e+""}))),(t=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=T.valHooks[i.type]||T.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(At,""):null==n?"":n:void 0}}),T.extend({valHooks:{option:{get:function(e){var t=T.find.attr(e,"value");return null!=t?t:Tt(T.text(e))}},select:{get:function(e){var t,n,r,i=e.options,s=e.selectedIndex,o="select-one"===e.type,a=o?null:[],c=o?s+1:i.length;for(r=s<0?c:o?s:0;r<c;r++)if(((n=i[r]).selected||r===s)&&!n.disabled&&(!n.parentNode.disabled||!C(n.parentNode,"optgroup"))){if(t=T(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,s=T.makeArray(t),o=i.length;o--;)((r=i[o]).selected=T.inArray(T.valHooks.option.get(r),s)>-1)&&(n=!0);return n||(e.selectedIndex=-1),s}}}}),T.each(["radio","checkbox"],(function(){T.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=T.inArray(T(e).val(),t)>-1}},m.checkOn||(T.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var Dt=r.location,kt={guid:Date.now()},Nt=/\?/;T.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||T.error("Invalid XML: "+(n?T.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Lt=/^(?:focusinfocus|focusoutblur)$/,Ot=function(e){e.stopPropagation()};T.extend(T.event,{trigger:function(e,t,n,i){var s,o,a,c,u,l,h,d,p=[n||w],g=f.call(e,"type")?e.type:e,m=f.call(e,"namespace")?e.namespace.split("."):[];if(o=d=a=n=n||w,3!==n.nodeType&&8!==n.nodeType&&!Lt.test(g+T.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),u=g.indexOf(":")<0&&"on"+g,(e=e[T.expando]?e:new T.Event(g,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:T.makeArray(t,[e]),h=T.event.special[g]||{},i||!h.trigger||!1!==h.trigger.apply(n,t))){if(!i&&!h.noBubble&&!v(n)){for(c=h.delegateType||g,Lt.test(c+g)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||w)&&p.push(a.defaultView||a.parentWindow||r)}for(s=0;(o=p[s++])&&!e.isPropagationStopped();)d=o,e.type=s>1?c:h.bindType||g,(l=(ae.get(o,"events")||Object.create(null))[e.type]&&ae.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&se(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=g,i||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),t)||!se(n)||u&&y(n[g])&&!v(n)&&((a=n[u])&&(n[u]=null),T.event.triggered=g,e.isPropagationStopped()&&d.addEventListener(g,Ot),n[g](),e.isPropagationStopped()&&d.removeEventListener(g,Ot),T.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=T.extend(new T.Event,n,{type:e,isSimulated:!0});T.event.trigger(r,null,t)}}),T.fn.extend({trigger:function(e,t){return this.each((function(){T.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return T.event.trigger(e,t,n,!0)}});var Mt=/\[\]$/,Pt=/\r?\n/g,Rt=/^(?:submit|button|image|reset|file)$/i,Ft=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))T.each(t,(function(t,i){n||Mt.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}T.param=function(e,t){var n,r=[],i=function(e,t){var n=y(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!T.isPlainObject(e))T.each(e,(function(){i(this.name,this.value)}));else for(n in e)jt(n,e[n],t,i);return r.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=T.prop(this,"elements");return e?T.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!T(this).is(":disabled")&&Ft.test(this.nodeName)&&!Rt.test(e)&&(this.checked||!Te.test(e))})).map((function(e,t){var n=T(this).val();return null==n?null:Array.isArray(n)?T.map(n,(function(e){return{name:t.name,value:e.replace(Pt,"\r\n")}})):{name:t.name,value:n.replace(Pt,"\r\n")}})).get()}});var Vt=/%20/g,Bt=/#.*$/,qt=/([?&])_=[^&]*/,Ut=/^(.*?):[ \t]*([^\r\n]*)$/gm,zt=/^(?:GET|HEAD)$/,Gt=/^\/\//,$t={},Kt={},Ht="*/".concat("*"),Qt=w.createElement("a");function Wt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(H)||[];if(y(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Xt(e,t,n,r){var i={},s=e===Kt;function o(a){var c;return i[a]=!0,T.each(e[a]||[],(function(e,a){var u=a(t,n,r);return"string"!=typeof u||s||i[u]?s?!(c=u):void 0:(t.dataTypes.unshift(u),o(u),!1)})),c}return o(t.dataTypes[0])||!i["*"]&&o("*")}function Yt(e,t){var n,r,i=T.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&T.extend(!0,e,r),e}Qt.href=Dt.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Dt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Dt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Yt(Yt(e,T.ajaxSettings),t):Yt(T.ajaxSettings,e)},ajaxPrefilter:Wt($t),ajaxTransport:Wt(Kt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,s,o,a,c,u,l,h,d,f=T.ajaxSetup({},t),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?T(p):T.event,m=T.Deferred(),y=T.Callbacks("once memory"),v=f.statusCode||{},b={},_={},x="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(u){if(!o)for(o={};t=Ut.exec(s);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?s:null},setRequestHeader:function(e,t){return null==u&&(e=_[e.toLowerCase()]=_[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==u&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)E.always(e[E.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),I(0,t),this}};if(m.promise(E),f.url=((e||f.url||Dt.href)+"").replace(Gt,Dt.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(H)||[""],null==f.crossDomain){c=w.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Qt.protocol+"//"+Qt.host!=c.protocol+"//"+c.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=T.param(f.data,f.traditional)),Xt($t,f,t,E),u)return E;for(h in(l=T.event&&f.global)&&0==T.active++&&T.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!zt.test(f.type),i=f.url.replace(Bt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Vt,"+")):(d=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Nt.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace(qt,"$1"),d=(Nt.test(i)?"&":"?")+"_="+kt.guid+++d),f.url=i+d),f.ifModified&&(T.lastModified[i]&&E.setRequestHeader("If-Modified-Since",T.lastModified[i]),T.etag[i]&&E.setRequestHeader("If-None-Match",T.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&E.setRequestHeader("Content-Type",f.contentType),E.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ht+"; q=0.01":""):f.accepts["*"]),f.headers)E.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,E,f)||u))return E.abort();if(x="abort",y.add(f.complete),E.done(f.success),E.fail(f.error),n=Xt(Kt,f,t,E)){if(E.readyState=1,l&&g.trigger("ajaxSend",[E,f]),u)return E;f.async&&f.timeout>0&&(a=r.setTimeout((function(){E.abort("timeout")}),f.timeout));try{u=!1,n.send(b,I)}catch(e){if(u)throw e;I(-1,e)}}else I(-1,"No Transport");function I(e,t,o,c){var h,d,w,b,_,x=t;u||(u=!0,a&&r.clearTimeout(a),n=void 0,s=c||"",E.readyState=e>0?4:0,h=e>=200&&e<300||304===e,o&&(b=function(e,t,n){for(var r,i,s,o,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){c.unshift(i);break}if(c[0]in n)s=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==c[0]&&c.unshift(s),n[s]}(f,E,o)),!h&&T.inArray("script",f.dataTypes)>-1&&T.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),b=function(e,t,n,r){var i,s,o,a,c,u={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(s=l.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=s,s=l.shift())if("*"===s)s=c;else if("*"!==c&&c!==s){if(!(o=u[c+" "+s]||u["* "+s]))for(i in u)if((a=i.split(" "))[1]===s&&(o=u[c+" "+a[0]]||u["* "+a[0]])){!0===o?o=u[i]:!0!==u[i]&&(s=a[0],l.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+s}}}return{state:"success",data:t}}(f,b,E,h),h?(f.ifModified&&((_=E.getResponseHeader("Last-Modified"))&&(T.lastModified[i]=_),(_=E.getResponseHeader("etag"))&&(T.etag[i]=_)),204===e||"HEAD"===f.type?x="nocontent":304===e?x="notmodified":(x=b.state,d=b.data,h=!(w=b.error))):(w=x,!e&&x||(x="error",e<0&&(e=0))),E.status=e,E.statusText=(t||x)+"",h?m.resolveWith(p,[d,x,E]):m.rejectWith(p,[E,x,w]),E.statusCode(v),v=void 0,l&&g.trigger(h?"ajaxSuccess":"ajaxError",[E,f,h?d:w]),y.fireWith(p,[E,x]),l&&(g.trigger("ajaxComplete",[E,f]),--T.active||T.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return T.get(e,t,n,"json")},getScript:function(e,t){return T.get(e,void 0,t,"script")}}),T.each(["get","post"],(function(e,t){T[t]=function(e,n,r,i){return y(n)&&(i=i||r,r=n,n=void 0),T.ajax(T.extend({url:e,type:t,dataType:i,data:n,success:r},T.isPlainObject(e)&&e))}})),T.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),T._evalUrl=function(e,t,n){return T.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){T.globalEval(e,t,n)}})},T.fn.extend({wrapAll:function(e){var t;return this[0]&&(y(e)&&(e=e.call(this[0])),t=T(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return y(e)?this.each((function(t){T(this).wrapInner(e.call(this,t))})):this.each((function(){var t=T(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=y(e);return this.each((function(n){T(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){T(this).replaceWith(this.childNodes)})),this}}),T.expr.pseudos.hidden=function(e){return!T.expr.pseudos.visible(e)},T.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var Jt={0:200,1223:204},Zt=T.ajaxSettings.xhr();m.cors=!!Zt&&"withCredentials"in Zt,m.ajax=Zt=!!Zt,T.ajaxTransport((function(e){var t,n;if(m.cors||Zt&&!e.crossDomain)return{send:function(i,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)a.setRequestHeader(o,i[o]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Jt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&r.setTimeout((function(){t&&n()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),T.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return T.globalEval(e),e}}}),T.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),T.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=T("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),w.head.appendChild(t[0])},abort:function(){n&&n()}}}));var en,tn=[],nn=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||T.expando+"_"+kt.guid++;return this[e]=!0,e}}),T.ajaxPrefilter("json jsonp",(function(e,t,n){var i,s,o,a=!1!==e.jsonp&&(nn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(nn,"$1"+i):!1!==e.jsonp&&(e.url+=(Nt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||T.error(i+" was not called"),o[0]},e.dataTypes[0]="json",s=r[i],r[i]=function(){o=arguments},n.always((function(){void 0===s?T(r).removeProp(i):r[i]=s,e[i]&&(e.jsonpCallback=t.jsonpCallback,tn.push(i)),o&&y(s)&&s(o[0]),o=s=void 0})),"script"})),m.createHTMLDocument=((en=w.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===en.childNodes.length),T.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=w.implementation.createHTMLDocument("")).createElement("base")).href=w.location.href,t.head.appendChild(r)):t=w),s=!n&&[],(i=B.exec(e))?[t.createElement(i[1])]:(i=Le([e],t,s),s&&s.length&&T(s).remove(),T.merge([],i.childNodes)));var r,i,s},T.fn.load=function(e,t,n){var r,i,s,o=this,a=e.indexOf(" ");return a>-1&&(r=Tt(e.slice(a)),e=e.slice(0,a)),y(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),o.length>0&&T.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){s=arguments,o.html(r?T("<div>").append(T.parseHTML(e)).find(r):e)})).always(n&&function(e,t){o.each((function(){n.apply(this,s||[e.responseText,t,e])}))}),this},T.expr.pseudos.animated=function(e){return T.grep(T.timers,(function(t){return e===t.elem})).length},T.offset={setOffset:function(e,t,n){var r,i,s,o,a,c,u=T.css(e,"position"),l=T(e),h={};"static"===u&&(e.style.position="relative"),a=l.offset(),s=T.css(e,"top"),c=T.css(e,"left"),("absolute"===u||"fixed"===u)&&(s+c).indexOf("auto")>-1?(o=(r=l.position()).top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(c)||0),y(t)&&(t=t.call(e,n,T.extend({},a))),null!=t.top&&(h.top=t.top-a.top+o),null!=t.left&&(h.left=t.left-a.left+i),"using"in t?t.using.call(e,h):l.css(h)}},T.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){T.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===T.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===T.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=T(e).offset()).top+=T.css(e,"borderTopWidth",!0),i.left+=T.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-T.css(r,"marginTop",!0),left:t.left-i.left-T.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===T.css(e,"position");)e=e.offsetParent;return e||ge}))}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;T.fn[e]=function(r){return ee(this,(function(e,r,i){var s;if(v(e)?s=e:9===e.nodeType&&(s=e.defaultView),void 0===i)return s?s[t]:e[r];s?s.scrollTo(n?s.pageXOffset:i,n?i:s.pageYOffset):e[r]=i}),e,r,arguments.length)}})),T.each(["top","left"],(function(e,t){T.cssHooks[t]=et(m.pixelPosition,(function(e,n){if(n)return n=Ze(e,t),Qe.test(n)?T(e).position()[t]+"px":n}))})),T.each({Height:"height",Width:"width"},(function(e,t){T.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){T.fn[r]=function(i,s){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===s?"margin":"border");return ee(this,(function(t,n,i){var s;return v(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===i?T.css(t,n,a):T.style(t,n,i,a)}),t,o?i:void 0,o)}}))})),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){T.fn[t]=function(e){return this.on(t,e)}})),T.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){T.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var rn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;T.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),y(e))return r=a.call(arguments,2),i=function(){return e.apply(t||this,r.concat(a.call(arguments)))},i.guid=e.guid=e.guid||T.guid++,i},T.holdReady=function(e){e?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=C,T.isFunction=y,T.isWindow=v,T.camelCase=ie,T.type=x,T.now=Date.now,T.isNumeric=function(e){var t=T.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},T.trim=function(e){return null==e?"":(e+"").replace(rn,"$1")},void 0===(n=function(){return T}.apply(t,[]))||(e.exports=n);var sn=r.jQuery,on=r.$;return T.noConflict=function(e){return r.$===T&&(r.$=on),e&&r.jQuery===T&&(r.jQuery=sn),T},void 0===i&&(r.jQuery=r.$=T),T}))},828:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t=-1/0,n=1/0){return Math.max(t,Math.min(n,e))}},875:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(899)),s={"<":"&lt;",">":"&gt;",'"':"&quot;","(":"&#40;",")":"&#41;","+":"&#43;",",":"&#44;","-":"&#45;",".":"&#46;","=":"&#61;","`":"&#96;"};function o(e,...t){for(let n=0;n<e.childElementCount;n++){const r=e.children[n];t.some((e=>e.toLowerCase()===r.tagName.toLowerCase()))?r.remove():0!==r.childElementCount&&o(r,...t)}return e}Object.seal(s);const a={a:"href",applet:"codebase",area:"href",base:"href",blockquote:"cite",body:"background",del:"cite",form:"action",frame:["longdesc","src"],head:"profile",iframe:["longdesc","src"],img:["longdesc","src","usemap"],input:["src","usemap","formaction"],ins:"cite",link:"href",object:["classid","codebase","data","usemap"],q:"cite",script:"src",audio:"src",button:"formaction",command:"icon",embed:"src",html:"manifest",source:"src",track:"src",video:["poster","src"]},c={img:"srcset",source:"srcset",object:"archive",applet:"archive",meta:"content"};function u(e){if(e instanceof Element){let t;(t=a[e.tagName.toLowerCase()])&&("string"==typeof t?e.removeAttribute(t):t.forEach((t=>{var n;e.hasAttribute(t)&&("string"==typeof(n=e.getAttribute(t))&&(n=new URL(n)),"javascript:"===n.protocol)&&e.removeAttribute(t)}))),(t=c[e.tagName.toLowerCase()])&&e.hasAttribute(t)&&e.setAttribute(t,e.getAttribute(t).replaceAll("javascript:",""))}for(let t=0;t<e.childElementCount;t++)u(e.children[t]);return e}const l=/\ |\n|\,|\;|\:|\.|\?|\!/g;t.default=class{static parseLine(e,t=!0){return t&&(e=function(e){for(let t in s)e=e.replaceAll(t,s[t]);return e}(e)),e}static parse(e,t={}){e=this.parseLine(e,!1),t.allowDoubleSpaces||(e=e.replaceAll(/ +/g," ")),t.skipLineBreaks?e=e.replaceAll(/(<br>)|(\n)/g,""):t.allowMultilineBreaks||(e=e.replaceAll(/(<br>)+/g,"<br>").replaceAll("\n+","\n"));const n=(new DOMParser).parseFromString(e,"text/html");if(o(n,"script",...t.disallowedTags??[]),u(n),"number"==typeof t.maxWords){let e=t.maxWords;const r=[n.body];for(;0!==r.length;){const n=r.shift();if(e<=0)n.parentElement?.removeChild(n);else{if(n instanceof Text)for(let r=1;r<n.data.length;r++)if(!l.test(n.data[r-1])&&l.test(n.data[r])&&--e<=0){n.data=n.data.substring(0,r)+t.cutoffMarker??"";break}const i=[];n.childNodes.forEach((e=>i.push(e))),r.unshift(...i)}}}const r=[];return n.body.childNodes.forEach((e=>r.push(e))),i.default.div().class("rich-text",...t.classes??[]).children(...r).make()}}},318:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(755));class s extends HTMLElement{constructor(){super(),this.classList.add("center-content"),this.delay=Number.parseFloat(this.getAttribute("delay")),isNaN(this.delay)&&(this.delay=5e3),this.fadeTime=Number.parseFloat(this.getAttribute("fade-time")),isNaN(this.fadeTime)&&(this.fadeTime=1e3);try{this.current=Number.parseInt(this.getAttribute("first")??"0")}catch(e){this.current=0}(0,i.default)(this).children().filter(((e,t)=>t.hasAttribute("cover"))).css({"z-index":1});const e=(0,i.default)(this).children().filter(((e,t)=>!t.hasAttribute("cover")));e.filter((e=>e!==this.current)).hide(),setInterval((()=>{const t=this.current;this.current=(this.current+1)%e.length,e.eq(t).fadeOut(this.fadeTime),e.eq(this.current).fadeIn(this.fadeTime)}),this.delay)}}t.default=s,customElements.define("element-carousel",s)},803:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(875)),s=r(n(899));class o extends HTMLElement{constructor(e,t,n,r=!0,a){super(),this.style.display="block",this.heading=this.appendChild(s.default.heading(r?2:1).class("heading","markdown").children(a?s.default.a(a).openInNewTab(!0).html(i.default.parseLine(e)):new Text(i.default.parseLine(e))).make()),this.body=this.appendChild(i.default.parse(t,r?{maxWords:o.DEFAULT_PREVIEW_CUTOFF,cutoffMarker:" ",skipLineBreaks:!0,disallowedTags:["img"]}:void 0)),this.body.classList.add("body"),this.createdAt=n,r&&(this.setAttribute("is-preview",""),a)&&(this.body.lastChild instanceof Text||null===this.body.lastChild?this.body:this.body.lastChild).appendChild(s.default.a(a,"lees verder »").openInNewTab(!0).class("read-more").make())}static fromInfo(e,t=!0){return new o(e.heading,e.body,e.created_at,t,t?`/article.html?id=${e.id}`:void 0)}}o.DEFAULT_PREVIEW_CUTOFF=50,t.default=o,customElements.define("smart-article",o,{extends:"article"})},193:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(23),s=r(n(934)),o=n(828),a=(0,i.getFirestore)(s.default);class c{getById(e){return new Promise((async(t,n)=>{c.getArticles({id:e}).then((e=>t(e.length>0?e[0]:void 0))).catch(n)}))}get(e=5,t){return c.getArticles({limit:e,sortByCreatedAt:"descending",...t})}getByCategory(e,t){return c.getArticles({category:e,...t})}getCount(e){return c.getArticles({...e},!0)}static getArticles(e,t=!1){const n=[];return e.limit&&n.push((0,i.limit)((0,o.clamp)(e.limit,0,20))),e.id&&n.push((0,i.where)((0,i.documentId)(),"==",e.id)),e.notId&&n.push((0,i.where)((0,i.documentId)(),"!=",e.notId)),e.sortByCreatedAt&&n.push((0,i.orderBy)("created_at","ascending"===e.sortByCreatedAt?"asc":"desc")),e.before&&n.push((0,i.where)("created_at","<",i.Timestamp.fromDate(e.before))),e.after&&n.push((0,i.where)("created_at",">",i.Timestamp.fromDate(e.after))),"string"==typeof e.category&&n.push((0,i.where)("category","==",e.category)),e.forHomepage&&n.push((0,i.where)("show_on_homepage","==",!0)),new Promise((async(e,r)=>{const s=(0,i.query)(c.COLLECTION,...n);try{if(t)e((await(0,i.getCountFromServer)(s)).data().count);else{const t=await(0,i.getDocs)(s),n=[];t.forEach((e=>n.push(e.data()))),e(n)}}catch(e){r(e)}}))}}c.COLLECTION=(0,i.collection)(a,"articles").withConverter({toFirestore:e=>({...e,created_at:i.Timestamp.fromDate(e.created_at)}),fromFirestore(e){const t=e.data();return{...t,id:e.id,created_at:t.created_at.toDate()}}}),t.default=class{constructor(){this.articles=new c}}},934:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(923),i={apiKey:"AIzaSyAr3flkC7_4DoGS1TOTlRRfQ4C64dSO4y4",authDomain:"test-78a52.firebaseapp.com",projectId:"test-78a52",storageBucket:"test-78a52.appspot.com",messagingSenderId:"766298434316",appId:"1:766298434316:web:0874153a0a10b5de12b729"};Object.freeze(i);const s=(0,r.initializeApp)(i);t.default=s},128:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextInputAssemblyLine=t.DateInputAssemblyLine=t.NumberInputAssemblyLine=t.RangedInputAssemblyLine=t.CheckableInputAssemblyLine=t.ButtonLikeInputAssemblyLine=t.InputAssemblyLine=t.AnchorElementAssemblyLine=void 0;class n{constructor(e){this.elementTypeSpecific={},this._classes=new Set,this._attributes={},this._children=[],this._styleProps={},this.tagName=e}id(e){return this._id=e,this}class(...e){for(const t of e)this._classes.add(t);return this}attr(e,t=""){return this._attributes[e]=t.toString(),this}attrs(e){for(const t in e)this._attributes[t]=e[t].toString();return this}text(e){return this._text=e,this}html(e){return this._html=e,this}children(...e){return e=e.filter((e=>null!==e)),this._children.push(...e.map((e=>e instanceof n?e.make():e))),this}style(e){for(const t in e)this._styleProps[t]=e[t];return this}make(){const e=document.createElement(this.tagName);void 0!==this._id&&(e.id=this._id),this._classes.size>0&&e.classList.add(...this._classes);for(const t in this._attributes)e.setAttribute(t,this._attributes[t]);this._html&&(e.innerHTML=this._html),void 0!==this._text&&(e.innerText=this._text),e.append(...this._children);for(const t in this._styleProps)e.style.setProperty(t,this._styleProps[t]);for(const t in this.elementTypeSpecific)e[t]=this.elementTypeSpecific[t];return e}static specific(e,t){const r=new n(e);for(const e of t)Reflect.defineProperty(r,e,{writable:!1,value:t=>(r.elementTypeSpecific[e]=t,r)});return r}}t.default=n,t.AnchorElementAssemblyLine=class extends n{constructor(){super("a"),this._openInNewTab=!1}href(e){return this._href=e,this}openInNewTab(e){return this._openInNewTab=e,this}make(){const e=super.make();return void 0!==this._href&&(e.href=this._href),this._openInNewTab&&(e.target="_blank"),e}};const r={button:"Button",checkbox:"Checkbox",color:"#000000",date:(new Date).toDateString(),"datetime-local":(new Date).toISOString(),email:"",file:"",hidden:"",image:"",month:"01-01",number:0,password:"",radio:"Radio",range:0,reset:"Reset",search:"",submit:"Submit",tel:"",text:"",time:"12:00",url:"",week:`${(new Date).getFullYear()}-W01`};class i extends n{constructor(e){super("input"),this.type=e,this._value=r[this.type]}value(e){return this._value=e,this}name(e){return this._name=e,this}disabled(e){return this._disabled=e,this}attr(e,t){return"value"===e||"onchange"===e?this:super.attr(e,t)}attrs(e){return delete e.value,delete e.onchange,super.attrs(e)}onValueChanged(e){return this._onValueChanged=e,this}make(){const e=super.make();if(e.type=this.type,e.value=this._value.toString(),e.prevValue=e.value,window.addEventListener("change",(t=>{t.target===e&&(e.prevValue=e.value)})),this._onValueChanged){const t=this._onValueChanged;e.addEventListener("change",(()=>t(e.value,e.prevValue)))}return void 0!==this._name&&(e.name=this._name),this._disabled&&(e.disabled=!0),e}}t.InputAssemblyLine=i,t.ButtonLikeInputAssemblyLine=class extends i{onClick(e){return this._onClick=e,this}make(){const e=super.make();if(this._onClick){const t=this._onClick;e.addEventListener("click",(()=>t(e.value)))}return e}},t.CheckableInputAssemblyLine=class extends i{constructor(e){super(e),this._checked=!1}checked(e){return this._checked=e,this}onCheckedChanged(e){return this._onCheckedChanged=e,this}make(){const e=super.make();if(e.checked=this._checked,e.wasChecked=e.checked,window.addEventListener("input",(t=>{t.target===e&&((e.wasChecked=e.checked)?e.setAttribute("was-checked",""):e.removeAttribute("was-checked"))})),this._onCheckedChanged){const t=this._onCheckedChanged;e.addEventListener("input",(()=>t(e.checked,e.wasChecked)))}return e}};class s extends i{constructor(e){super(e),this._min=this._value,this._max=this._value,this._step=1}min(e){return this._min=e,this}max(e){return this._min=e,this}step(e){return this._step=e,this}make(){const e=super.make();return e.min=this._min.toString(),e.max=this._max.toString(),e.step=this._step.toString(),e}}t.RangedInputAssemblyLine=s,t.NumberInputAssemblyLine=class extends s{make(){const e=super.make();return e.prevValueAsNumber=Number.parseFloat(e.prevValue),window.addEventListener("change",(t=>{t.target===e&&(e.prevValueAsNumber=Number.parseFloat(e.prevValue))})),e}},t.DateInputAssemblyLine=class extends s{make(){const e=super.make();return e.prevValueAsDate=new Date(e.prevValue),window.addEventListener("change",(t=>{t.target===e&&(e.prevValueAsDate=new Date(e.prevValue))})),e}},t.TextInputAssemblyLine=class extends i{constructor(e){super(e)}list(e){return this._list="string"==typeof e?e:e.id,this}minLength(e){return this._minLength=Math.floor(e),this}maxLength(e){return this._maxLength=Math.floor(e),this}placeholder(e){return this._placeholder=e,this}readonly(e){return this._readonly=e,this}size(e){return this._size=Math.floor(e),this}spellcheck(e){return this._spellcheck=e,this}make(){const e=super.make();return void 0!==this._list&&e.setAttribute("list",this._list),void 0!==this._minLength&&(e.minLength=this._minLength),void 0!==this._maxLength&&(e.maxLength=this._maxLength),this._placeholder&&(e.placeholder=this._placeholder),this._readonly&&(e.readOnly=this._readonly),void 0!==this._size&&(e.size=this._size),this._spellcheck&&(e.spellcheck=this._spellcheck),e}}},899:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(828),a=s(n(128));class c{static header(){return new a.default("header")}static footer(){return new a.default("footer")}static div(){return new a.default("div")}static heading(e,t){return this[`h${e=(0,o.clamp)(Math.floor(e),1,6)}`]()}static h1(e){const t=new a.default("h1");return e?t.text(e):t}static h2(e){const t=new a.default("h2");return e?t.text(e):t}static h3(e){const t=new a.default("h3");return e?t.text(e):t}static h4(e){const t=new a.default("h4");return e?t.text(e):t}static h5(e){const t=new a.default("h5");return e?t.text(e):t}static h6(e){const t=new a.default("h6");return e?t.text(e):t}static p(e){const t=new a.default("p");return e?t.text(e):t}static span(e){const t=new a.default("span");return e?t.text(e):t}static a(e,t){const n=new a.AnchorElementAssemblyLine;return e&&n.href(e),t?n.text(t):n}static img(e,t){const n=a.default.specific("img",["src","alt"]);return e&&n.src(e),t?n.alt(t):n}static option(){return a.default.specific("option",["value","selected"])}static optgroup(){return a.default.specific("optgroup",["label"])}static hr(){return new a.default("hr")}static br(){return new a.default("br")}}c.input={button(e,t){const n=new a.ButtonLikeInputAssemblyLine("button");return void 0!==e&&n.value(e),t?n.onClick(t):n},checkbox:()=>new a.CheckableInputAssemblyLine("checkbox"),color:()=>new a.InputAssemblyLine("color"),localDatetime:()=>new a.DateInputAssemblyLine("datetime-local"),email:()=>new a.TextInputAssemblyLine("email"),file:()=>new a.TextInputAssemblyLine("file"),image:()=>new a.InputAssemblyLine("image"),month:()=>new a.RangedInputAssemblyLine("month"),number:()=>new a.NumberInputAssemblyLine("number"),password:()=>new a.TextInputAssemblyLine("password"),radio:()=>new a.CheckableInputAssemblyLine("radio"),range:()=>new a.NumberInputAssemblyLine("range"),reset:()=>new a.ButtonLikeInputAssemblyLine("reset"),search:()=>new a.TextInputAssemblyLine("search"),submit:()=>new a.ButtonLikeInputAssemblyLine("submit"),tel:()=>new a.TextInputAssemblyLine("tel"),text:()=>new a.TextInputAssemblyLine("text"),time:()=>new a.RangedInputAssemblyLine("time"),url:()=>new a.TextInputAssemblyLine("url")},t.default=c},975:()=>{"use strict";const e=[];document.querySelectorAll("*[parallax-factor]").forEach((t=>{if(t instanceof HTMLElement){const n=Number.parseFloat(t.getAttribute("parallax-factor"));if(!isNaN(n)){const r=window.getComputedStyle(t);if(function(e){return e instanceof HTMLIFrameElement||e instanceof HTMLVideoElement||e instanceof HTMLEmbedElement||e instanceof HTMLImageElement}(t)){const i=r.objectPosition.split(" ");e.push([t,n,!0,[i[0]??"0px",i[1]??"0px"]])}else{const i=r.translate.split(" ");e.push([t,n,!0,[i[0]??"0px",i[1]??"0px"]])}}}})),document.addEventListener("scroll",(()=>{e.forEach((e=>{const t=window.scrollY*(e[1]-1);e[2]?e[0].style.objectPosition=`${e[3][0]} calc(${e[3][1]} + ${t}px)`:e[0].style.translate=`${e[3][0]} calc(${e[3][1]} + ${t}px)`}))}))},815:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(755));n(975),n(318);const s=r(n(193)),o=r(n(803)),a=n(828),c=(new s.default).articles;function u(e){const t=e.map((e=>e.created_at)).toSorted(((e,t)=>t.getTime()-e.getTime()));return[t[0],t.at(-1)]}window.addEventListener("DOMContentLoaded",(async()=>{const e=await c.getCount({forHomepage:!0}),t=document.getElementById("carousel-name");(0,i.default)(t).css({opacity:"0"}).animate({scale:"1",opacity:"1"},{duration:750,easing:"swing"});const n=document.getElementById("recent-messages"),r=document.getElementById("first-page"),s=document.getElementById("previous-page"),l=document.getElementById("next-page"),h=document.getElementById("last-page"),d=document.getElementById("page-indicator");r.addEventListener("click",(()=>g(m=0))),s.addEventListener("click",(()=>g(--m))),l.addEventListener("click",(()=>g(++m))),h.addEventListener("click",(()=>g(m=f-1)));const f=Math.ceil(e/5),p={};for(let t=0;t<f;t++)p[t]={pageNum:t,retrieved:!1,size:e%5==0||t<f-1?5:e%5,articles:[]};async function g(e){const t=await function(e){return e=(0,a.clamp)(Math.floor(e),0,f-1),new Promise((async(t,n)=>{p[e].retrieved?t(p[e]):0===e?(p[e].articles=await c.get(5,{forHomepage:!0,sortByCreatedAt:"descending"}),p[e].retrieved=!0,t(p[e])):e===f-1?(p[e].articles=await c.get(p[e].size,{forHomepage:!0,sortByCreatedAt:"ascending"}),p[e].articles.sort(((e,t)=>t.created_at.getTime()-e.created_at.getTime())),p[e].retrieved=!0,t(p[e])):p[e-1].retrieved?(p[e].articles=await c.get(p[e].size,{forHomepage:!0,sortByCreatedAt:"descending",before:u(p[e-1].articles)[1]}),p[e].retrieved=!0,t(p[e])):p[e+1].retrieved?(p[e].articles=await c.get(p[e].size,{forHomepage:!0,sortByCreatedAt:"descending",before:u(p[e+1].articles)[0]}),p[e].retrieved=!0,t(p[e])):n("can only retrieve one page at a time")}))}(e);(0,i.default)(n).children("article").remove(),n.prepend(...t.articles.map((e=>o.default.fromInfo(e,!0)))),r.disabled=0===m,s.disabled=0===m,l.disabled=m===f-1,h.disabled=m===f-1,d.innerText=`Pagina ${e+1} / ${f}`}let m=0;g(m)}))},424:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>m,openDB:()=>g,unwrap:()=>p,wrap:()=>f});const r=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),f(o.get(this))}:function(...e){return f(t.apply(p(this),e))}:function(e,...n){const r=t.call(p(this),e,...n);return c.set(r,e.sort?e.sort():[e]),f(r)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(f(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=d(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const p=e=>l.get(e);function g(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=f(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(f(o.result),e.oldVersion,e.newVersion,f(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function m(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),f(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=v.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return w.set(t,s),s}var _;_=h,h={..._,get:(e,t,n)=>b(e,t)||_.get(e,t,n),has:(e,t)=>!!b(e,t)||_.has(e,t)}},582:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>M,__assign:()=>s,__asyncDelegator:()=>T,__asyncGenerator:()=>I,__asyncValues:()=>S,__await:()=>E,__awaiter:()=>p,__classPrivateFieldGet:()=>N,__classPrivateFieldIn:()=>O,__classPrivateFieldSet:()=>L,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>R,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>g,__importDefault:()=>k,__importStar:()=>D,__makeTemplateObject:()=>C,__metadata:()=>f,__param:()=>c,__propKey:()=>h,__read:()=>w,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>b,__spreadArray:()=>x,__spreadArrays:()=>_,__values:()=>v,default:()=>F});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?r.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var m=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[u],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=o(m.get))&&(h.get=a),(a=o(m.set))&&(h.set=a),(a=o(m.init))&&i.unshift(a)}else(a=o(m))&&("field"===c?i.unshift(a):h[u]=a)}l&&Object.defineProperty(l,r.name,h),d=!0}function l(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function g(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var m=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function x(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof E?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function T(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:E(e[r](t)),done:!1}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function D(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return A(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function N(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function L(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function O(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function M(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var P="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function R(e){function t(t){e.error=e.hasError?new P(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:i,__assign:s,__rest:o,__decorate:a,__param:c,__metadata:f,__awaiter:p,__generator:g,__createBinding:m,__exportStar:y,__values:v,__read:w,__spread:b,__spreadArrays:_,__spreadArray:x,__await:E,__asyncGenerator:I,__asyncDelegator:T,__asyncValues:S,__makeTemplateObject:C,__importStar:D,__importDefault:k,__classPrivateFieldGet:N,__classPrivateFieldSet:L,__classPrivateFieldIn:O,__addDisposableResource:M,__disposeResources:R}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(815)})();